!function(n){var i={};function c(f){if(i[f])return i[f].exports;var h=i[f]={i:f,l:!1,exports:{}};return n[f].call(h.exports,h,h.exports,c),h.l=!0,h.exports}c.m=n,c.c=i,c.d=function(n,i,f){c.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:f})},c.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},c.t=function(n,i){if(1&i&&(n=c(n)),8&i)return n;if(4&i&&"object"==typeof n&&n&&n.__esModule)return n;var f=Object.create(null);if(c.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:n}),2&i&&"string"!=typeof n)for(var h in n)c.d(f,h,function(i){return n[i]}.bind(null,h));return f},c.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return c.d(i,"a",i),i},c.o=function(n,i){return Object.prototype.hasOwnProperty.call(n,i)},c.p="",c(c.s=73)}([function(n,i,c){(function(f){i.log=function(...n){return"object"==typeof console&&console.log&&console.log(...n)},i.formatArgs=function(i){if(i[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+i[0]+(this.useColors?"%c ":" ")+"+"+n.exports.humanize(this.diff),!this.useColors)return;const c="color: "+this.color;i.splice(1,0,c,"color: inherit");let f=0,h=0;i[0].replace(/%[a-zA-Z%]/g,n=>{"%%"!==n&&(f++,"%c"===n&&(h=f))}),i.splice(h,0,c)},i.save=function(n){try{n?i.storage.setItem("debug",n):i.storage.removeItem("debug")}catch(n){}},i.load=function(){let n;try{n=i.storage.getItem("debug")}catch(n){}!n&&void 0!==f&&"env"in f&&(n=f.env.DEBUG);return n},i.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},i.storage=function(){try{return localStorage}catch(n){}}(),i.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],n.exports=c(132)(i);const{formatters:h}=n.exports;h.j=function(n){try{return JSON.stringify(n)}catch(n){return"[UnexpectedJSONParseError]: "+n.message}}}).call(this,c(131))},function(n,i,c){"use strict";var f=c(67);n.exports={USER_AGENT:"".concat(f.title," ").concat(f.version),SIP:"sip",SIPS:"sips",causes:{CONNECTION_ERROR:"Connection Error",REQUEST_TIMEOUT:"Request Timeout",SIP_FAILURE_CODE:"SIP Failure Code",INTERNAL_ERROR:"Internal Error",BUSY:"Busy",REJECTED:"Rejected",REDIRECTED:"Redirected",UNAVAILABLE:"Unavailable",NOT_FOUND:"Not Found",ADDRESS_INCOMPLETE:"Address Incomplete",INCOMPATIBLE_SDP:"Incompatible SDP",MISSING_SDP:"Missing SDP",AUTHENTICATION_ERROR:"Authentication Error",BYE:"Terminated",WEBRTC_ERROR:"WebRTC Error",CANCELED:"Canceled",NO_ANSWER:"No Answer",EXPIRES:"Expires",NO_ACK:"No ACK",DIALOG_ERROR:"Dialog Error",USER_DENIED_MEDIA_ACCESS:"User Denied Media Access",BAD_MEDIA_DESCRIPTION:"Bad Media Description",RTP_TIMEOUT:"RTP Timeout"},SIP_ERROR_CAUSES:{REDIRECTED:[300,301,302,305,380],BUSY:[486,600],REJECTED:[403,603],NOT_FOUND:[404,604],UNAVAILABLE:[480,410,408,430],ADDRESS_INCOMPLETE:[484,424],INCOMPATIBLE_SDP:[488,606],AUTHENTICATION_ERROR:[401,407]},ACK:"ACK",BYE:"BYE",CANCEL:"CANCEL",INFO:"INFO",INVITE:"INVITE",MESSAGE:"MESSAGE",NOTIFY:"NOTIFY",OPTIONS:"OPTIONS",REGISTER:"REGISTER",REFER:"REFER",UPDATE:"UPDATE",SUBSCRIBE:"SUBSCRIBE",REASON_PHRASE:{100:"Trying",180:"Ringing",181:"Call Is Being Forwarded",182:"Queued",183:"Session Progress",199:"Early Dialog Terminated",200:"OK",202:"Accepted",204:"No Notification",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",305:"Use Proxy",380:"Alternative Service",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",410:"Gone",412:"Conditional Request Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Unsupported URI Scheme",417:"Unknown Resource-Priority",420:"Bad Extension",421:"Extension Required",422:"Session Interval Too Small",423:"Interval Too Brief",424:"Bad Location Information",428:"Use Identity Header",429:"Provide Referrer Identity",430:"Flow Failed",433:"Anonymity Disallowed",436:"Bad Identity-Info",437:"Unsupported Certificate",438:"Invalid Identity Header",439:"First Hop Lacks Outbound Support",440:"Max-Breadth Exceeded",469:"Bad Info Package",470:"Consent Needed",478:"Unresolvable Destination",480:"Temporarily Unavailable",481:"Call/Transaction Does Not Exist",482:"Loop Detected",483:"Too Many Hops",484:"Address Incomplete",485:"Ambiguous",486:"Busy Here",487:"Request Terminated",488:"Not Acceptable Here",489:"Bad Event",491:"Request Pending",493:"Undecipherable",494:"Security Agreement Required",500:"JsSIP Internal Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Server Time-out",505:"Version Not Supported",513:"Message Too Large",580:"Precondition Failure",600:"Busy Everywhere",603:"Decline",604:"Does Not Exist Anywhere",606:"Not Acceptable"},ALLOWED_METHODS:"INVITE,ACK,CANCEL,BYE,UPDATE,MESSAGE,OPTIONS,REFER,INFO",ACCEPTED_BODY_TYPES:"application/sdp, application/dtmf-relay",MAX_FORWARDS:69,SESSION_EXPIRES:90,MIN_SESSION_EXPIRES:60}},function(n,i,c){"use strict";function f(n){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}var h=c(1),a=c(18),o=c(6);i.str_utf8_length=function(n){return unescape(encodeURIComponent(n)).length};var d=i.isFunction=function(n){return void 0!==n&&"[object Function]"===Object.prototype.toString.call(n)};i.isString=function(n){return void 0!==n&&"[object String]"===Object.prototype.toString.call(n)},i.isDecimal=function(n){return!isNaN(n)&&parseFloat(n)===parseInt(n,10)},i.isEmpty=function(n){return null===n||""===n||void 0===n||Array.isArray(n)&&0===n.length||"number"==typeof n&&isNaN(n)},i.hasMethods=function(n){for(var i=arguments.length,c=new Array(i>1?i-1:0),f=1;f<i;f++)c[f-1]=arguments[f];for(var h=0;h<c.length;h++){var a=c[h];if(d(n[a]))return!1}return!0};var v=i.createRandomToken=function(n){var i,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,f="";for(i=0;i<n;i++)f+=(Math.random()*c|0).toString(c);return f};i.newTag=function(){return v(10)},i.newUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var i=16*Math.random()|0;return("x"===n?i:3&i|8).toString(16)})},i.hostType=function(n){if(n)return-1!==(n=o.parse(n,"host"))?n.host_type:void 0};var y=i.escapeUser=function(n){return encodeURIComponent(decodeURIComponent(n)).replace(/%3A/gi,":").replace(/%2B/gi,"+").replace(/%3F/gi,"?").replace(/%2F/gi,"/")};i.normalizeTarget=function(n,i){if(n){if(n instanceof a)return n;if("string"==typeof n){var c,f,o,d=n.split("@");switch(d.length){case 1:if(!i)return;c=n,f=i;break;case 2:c=d[0],f=d[1];break;default:c=d.slice(0,d.length-1).join("@"),f=d[d.length-1]}return c=c.replace(/^(sips?|tel):/i,""),/^[-.()]*\+?[0-9\-.()]+$/.test(c)&&(c=c.replace(/[-.()]/g,"")),n="".concat(h.SIP,":").concat(y(c),"@").concat(f),(o=a.parse(n))?o:void 0}}else;},i.headerize=function(n){var i,c={"Call-Id":"Call-ID",Cseq:"CSeq","Www-Authenticate":"WWW-Authenticate"},f=n.toLowerCase().replace(/_/g,"-").split("-"),h="",a=f.length;for(i=0;i<a;i++)0!==i&&(h+="-"),h+=f[i].charAt(0).toUpperCase()+f[i].substring(1);return c[h]&&(h=c[h]),h},i.sipErrorCause=function(n){for(var i in h.SIP_ERROR_CAUSES)if(-1!==h.SIP_ERROR_CAUSES[i].indexOf(n))return h.causes[i];return h.causes.SIP_FAILURE_CODE},i.getRandomTestNetIP=function(){return"192.0.2.".concat((n=1,i=254,Math.floor(Math.random()*(i-n+1)+n)));var n,i},i.calculateMD5=function(n){function i(n,i){return n<<i|n>>>32-i}function c(n,i){var c=2147483648&n,f=2147483648&i,h=1073741824&n,a=1073741824&i,o=(1073741823&n)+(1073741823&i);return h&a?2147483648^o^c^f:h|a?1073741824&o?3221225472^o^c^f:1073741824^o^c^f:o^c^f}function f(n,f,h,a,o,d,v){return n=c(n,c(c(function(n,i,c){return n&i|~n&c}(f,h,a),o),v)),c(i(n,d),f)}function h(n,f,h,a,o,d,v){return n=c(n,c(c(function(n,i,c){return n&c|i&~c}(f,h,a),o),v)),c(i(n,d),f)}function a(n,f,h,a,o,d,v){return n=c(n,c(c(function(n,i,c){return n^i^c}(f,h,a),o),v)),c(i(n,d),f)}function o(n,f,h,a,o,d,v){return n=c(n,c(c(function(n,i,c){return i^(n|~c)}(f,h,a),o),v)),c(i(n,d),f)}function d(n){var i,c="",f="";for(i=0;i<=3;i++)c+=(f="0".concat((n>>>8*i&255).toString(16))).substr(f.length-2,2);return c}var v,y,g,b,m,w,A,C,T,E;for(v=function(n){for(var i,c=n.length,f=c+8,h=16*((f-f%64)/64+1),a=new Array(h-1),o=0,d=0;d<c;)o=d%4*8,a[i=(d-d%4)/4]=a[i]|n.charCodeAt(d)<<o,d++;return o=d%4*8,a[i=(d-d%4)/4]=a[i]|128<<o,a[h-2]=c<<3,a[h-1]=c>>>29,a}(n=function(n){n=n.replace(/\r\n/g,"\n");for(var i="",c=0;c<n.length;c++){var f=n.charCodeAt(c);f<128?i+=String.fromCharCode(f):f>127&&f<2048?(i+=String.fromCharCode(f>>6|192),i+=String.fromCharCode(63&f|128)):(i+=String.fromCharCode(f>>12|224),i+=String.fromCharCode(f>>6&63|128),i+=String.fromCharCode(63&f|128))}return i}(n)),A=1732584193,C=4023233417,T=2562383102,E=271733878,y=0;y<v.length;y+=16)g=A,b=C,m=T,w=E,A=f(A,C,T,E,v[y+0],7,3614090360),E=f(E,A,C,T,v[y+1],12,3905402710),T=f(T,E,A,C,v[y+2],17,606105819),C=f(C,T,E,A,v[y+3],22,3250441966),A=f(A,C,T,E,v[y+4],7,4118548399),E=f(E,A,C,T,v[y+5],12,1200080426),T=f(T,E,A,C,v[y+6],17,2821735955),C=f(C,T,E,A,v[y+7],22,4249261313),A=f(A,C,T,E,v[y+8],7,1770035416),E=f(E,A,C,T,v[y+9],12,2336552879),T=f(T,E,A,C,v[y+10],17,4294925233),C=f(C,T,E,A,v[y+11],22,2304563134),A=f(A,C,T,E,v[y+12],7,1804603682),E=f(E,A,C,T,v[y+13],12,4254626195),T=f(T,E,A,C,v[y+14],17,2792965006),A=h(A,C=f(C,T,E,A,v[y+15],22,1236535329),T,E,v[y+1],5,4129170786),E=h(E,A,C,T,v[y+6],9,3225465664),T=h(T,E,A,C,v[y+11],14,643717713),C=h(C,T,E,A,v[y+0],20,3921069994),A=h(A,C,T,E,v[y+5],5,3593408605),E=h(E,A,C,T,v[y+10],9,38016083),T=h(T,E,A,C,v[y+15],14,3634488961),C=h(C,T,E,A,v[y+4],20,3889429448),A=h(A,C,T,E,v[y+9],5,568446438),E=h(E,A,C,T,v[y+14],9,3275163606),T=h(T,E,A,C,v[y+3],14,4107603335),C=h(C,T,E,A,v[y+8],20,1163531501),A=h(A,C,T,E,v[y+13],5,2850285829),E=h(E,A,C,T,v[y+2],9,4243563512),T=h(T,E,A,C,v[y+7],14,1735328473),A=a(A,C=h(C,T,E,A,v[y+12],20,2368359562),T,E,v[y+5],4,4294588738),E=a(E,A,C,T,v[y+8],11,2272392833),T=a(T,E,A,C,v[y+11],16,1839030562),C=a(C,T,E,A,v[y+14],23,4259657740),A=a(A,C,T,E,v[y+1],4,2763975236),E=a(E,A,C,T,v[y+4],11,1272893353),T=a(T,E,A,C,v[y+7],16,4139469664),C=a(C,T,E,A,v[y+10],23,3200236656),A=a(A,C,T,E,v[y+13],4,681279174),E=a(E,A,C,T,v[y+0],11,3936430074),T=a(T,E,A,C,v[y+3],16,3572445317),C=a(C,T,E,A,v[y+6],23,76029189),A=a(A,C,T,E,v[y+9],4,3654602809),E=a(E,A,C,T,v[y+12],11,3873151461),T=a(T,E,A,C,v[y+15],16,530742520),A=o(A,C=a(C,T,E,A,v[y+2],23,3299628645),T,E,v[y+0],6,4096336452),E=o(E,A,C,T,v[y+7],10,1126891415),T=o(T,E,A,C,v[y+14],15,2878612391),C=o(C,T,E,A,v[y+5],21,4237533241),A=o(A,C,T,E,v[y+12],6,1700485571),E=o(E,A,C,T,v[y+3],10,2399980690),T=o(T,E,A,C,v[y+10],15,4293915773),C=o(C,T,E,A,v[y+1],21,2240044497),A=o(A,C,T,E,v[y+8],6,1873313359),E=o(E,A,C,T,v[y+15],10,4264355552),T=o(T,E,A,C,v[y+6],15,2734768916),C=o(C,T,E,A,v[y+13],21,1309151649),A=o(A,C,T,E,v[y+4],6,4149444226),E=o(E,A,C,T,v[y+11],10,3174756917),T=o(T,E,A,C,v[y+2],15,718787259),C=o(C,T,E,A,v[y+9],21,3951481745),A=c(A,g),C=c(C,b),T=c(T,m),E=c(E,w);return(d(A)+d(C)+d(T)+d(E)).toLowerCase()},i.closeMediaStream=function(n){if(n)try{var i;if(n.getTracks){i=n.getTracks();var c=!0,h=!1,a=void 0;try{for(var o,d=i[Symbol.iterator]();!(c=(o=d.next()).done);c=!0){o.value.stop()}}catch(n){h=!0,a=n}finally{try{c||null==d.return||d.return()}finally{if(h)throw a}}}else{i=n.getAudioTracks();var v=!0,y=!1,g=void 0;try{for(var b,m=i[Symbol.iterator]();!(v=(b=m.next()).done);v=!0){b.value.stop()}}catch(n){y=!0,g=n}finally{try{v||null==m.return||m.return()}finally{if(y)throw g}}i=n.getVideoTracks();var w=!0,A=!1,C=void 0;try{for(var T,E=i[Symbol.iterator]();!(w=(T=E.next()).done);w=!0){T.value.stop()}}catch(n){A=!0,C=n}finally{try{w||null==E.return||E.return()}finally{if(A)throw C}}}}catch(i){"function"!=typeof n.stop&&"object"!==f(n.stop)||n.stop()}},i.cloneArray=function(n){return n&&n.slice()||[]}},function(n,i){var c=n.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=c)},function(n,i,c){var f=c(37)("wks"),h=c(27),a=c(3).Symbol,o="function"==typeof a;(n.exports=function(n){return f[n]||(f[n]=o&&a[n]||(o?a:h)("Symbol."+n))}).store=f},function(n,i){var c=n.exports={version:"2.6.1"};"number"==typeof __e&&(__e=c)},function(n,i,c){"use strict";n.exports=function(){function n(n){return'"'+n.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var i={parse:function(i,f){var h={CRLF:g,DIGIT:b,ALPHA:m,HEXDIG:w,WSP:A,OCTET:C,DQUOTE:T,SP:E,HTAB:k,alphanum:N,reserved:R,unreserved:x,mark:O,escaped:L,LWS:H,SWS:S,HCOLON:j,TEXT_UTF8_TRIM:B,TEXT_UTF8char:W,UTF8_NONASCII:V,UTF8_CONT:K,LHEX:function(){var n;null===(n=b())&&(/^[a-f]/.test(i.charAt(a))?(n=i.charAt(a),a++):(n=null,0===o&&y("[a-f]")));return n},token:Y,token_nodot:U,separators:function(){var n;40===i.charCodeAt(a)?(n="(",a++):(n=null,0===o&&y('"("'));null===n&&(41===i.charCodeAt(a)?(n=")",a++):(n=null,0===o&&y('")"')),null===n&&(60===i.charCodeAt(a)?(n="<",a++):(n=null,0===o&&y('"<"')),null===n&&(62===i.charCodeAt(a)?(n=">",a++):(n=null,0===o&&y('">"')),null===n&&(64===i.charCodeAt(a)?(n="@",a++):(n=null,0===o&&y('"@"')),null===n&&(44===i.charCodeAt(a)?(n=",",a++):(n=null,0===o&&y('","')),null===n&&(59===i.charCodeAt(a)?(n=";",a++):(n=null,0===o&&y('";"')),null===n&&(58===i.charCodeAt(a)?(n=":",a++):(n=null,0===o&&y('":"')),null===n&&(92===i.charCodeAt(a)?(n="\\",a++):(n=null,0===o&&y('"\\\\"')),null===n&&null===(n=T())&&(47===i.charCodeAt(a)?(n="/",a++):(n=null,0===o&&y('"/"')),null===n&&(91===i.charCodeAt(a)?(n="[",a++):(n=null,0===o&&y('"["')),null===n&&(93===i.charCodeAt(a)?(n="]",a++):(n=null,0===o&&y('"]"')),null===n&&(63===i.charCodeAt(a)?(n="?",a++):(n=null,0===o&&y('"?"')),null===n&&(61===i.charCodeAt(a)?(n="=",a++):(n=null,0===o&&y('"="')),null===n&&(123===i.charCodeAt(a)?(n="{",a++):(n=null,0===o&&y('"{"')),null===n&&(125===i.charCodeAt(a)?(n="}",a++):(n=null,0===o&&y('"}"')),null===n&&null===(n=E())&&(n=k()))))))))))))))));return n},word:z,STAR:X,SLASH:$,EQUAL:J,LPAREN:Z,RPAREN:D,RAQUOT:Q,LAQUOT:M,COMMA:P,SEMI:q,COLON:G,LDQUOT:F,RDQUOT:I,comment:function n(){var i,c,f;var h;h=a;i=Z();if(null!==i){for(c=[],null===(f=_())&&null===(f=l())&&(f=n());null!==f;)c.push(f),null===(f=_())&&null===(f=l())&&(f=n());null!==c&&null!==(f=D())?i=[i,c,f]:(i=null,a=h)}else i=null,a=h;return i},ctext:_,quoted_string:t,quoted_string_clean:p,qdtext:e,quoted_pair:l,SIP_URI_noparams:u,SIP_URI:r,uri_scheme:s,uri_scheme_sips:nn,uri_scheme_sip:cn,userinfo:fn,user:hn,user_unreserved:an,password:on,hostport:dn,host:vn,hostname:yn,domainlabel:gn,toplabel:bn,IPv6reference:mn,IPv6address:wn,h16:An,ls32:Cn,IPv4address:Tn,dec_octet:En,port:kn,uri_parameters:Nn,uri_parameter:Rn,transport_param:xn,user_param:On,method_param:Ln,ttl_param:Hn,maddr_param:Sn,lr_param:jn,other_param:Bn,pname:Wn,pvalue:Vn,paramchar:Kn,param_unreserved:Yn,headers:Un,header:zn,hname:Xn,hvalue:$n,hnv_unreserved:Jn,Request_Response:function(){var n;null===(n=mi())&&(n=Zn());return n},Request_Line:Zn,Request_URI:Dn,absoluteURI:Qn,hier_part:Mn,net_path:Pn,abs_path:qn,opaque_part:Gn,uric:Fn,uric_no_slash:In,path_segments:_n,segment:tn,param:pn,pchar:en,scheme:ln,authority:un,srvr:rn,reg_name:sn,query:ni,SIP_Version:ii,INVITEm:ci,ACKm:fi,OPTIONSm:hi,BYEm:ai,CANCELm:oi,REGISTERm:di,SUBSCRIBEm:vi,NOTIFYm:yi,REFERm:gi,Method:bi,Status_Line:mi,Status_Code:wi,extension_code:Ai,Reason_Phrase:Ci,Allow_Events:function(){var n,i,c,f,h,o;if(h=a,null!==(n=Qi())){for(i=[],o=a,null!==(c=P())&&null!==(f=Qi())?c=[c,f]:(c=null,a=o);null!==c;)i.push(c),o=a,null!==(c=P())&&null!==(f=Qi())?c=[c,f]:(c=null,a=o);null!==i?n=[n,i]:(n=null,a=h)}else n=null,a=h;return n},Call_ID:function(){var n,c,f,h,d,v;h=a,d=a,null!==(n=z())?(v=a,64===i.charCodeAt(a)?(c="@",a++):(c=null,0===o&&y('"@"')),null!==c&&null!==(f=z())?c=[c,f]:(c=null,a=v),null!==(c=null!==c?c:"")?n=[n,c]:(n=null,a=d)):(n=null,a=d);null!==n&&(g=h,n=void(Mc=i.substring(a,g)));var g;null===n&&(a=h);return n},Contact:function(){var n,i,c,f,h,o,d;if(h=a,null===(n=X()))if(o=a,null!==(n=Ti())){for(i=[],d=a,null!==(c=P())&&null!==(f=Ti())?c=[c,f]:(c=null,a=d);null!==c;)i.push(c),d=a,null!==(c=P())&&null!==(f=Ti())?c=[c,f]:(c=null,a=d);null!==i?n=[n,i]:(n=null,a=o)}else n=null,a=o;null!==n&&(n=function(n){var i,c;for(c=Mc.multi_header.length,i=0;i<c;i++)if(null===Mc.multi_header[i].parsed){Mc=null;break}Mc=null!==Mc?Mc.multi_header:-1}());null===n&&(a=h);return n},contact_param:Ti,name_addr:Ei,display_name:ki,contact_params:Ni,c_p_q:Ri,c_p_expires:xi,delta_seconds:Oi,qvalue:Li,generic_param:Hi,gen_value:Si,Content_Disposition:function(){var n,i,c,f,h,o;if(h=a,null!==(n=ji())){for(i=[],o=a,null!==(c=q())&&null!==(f=Bi())?c=[c,f]:(c=null,a=o);null!==c;)i.push(c),o=a,null!==(c=q())&&null!==(f=Bi())?c=[c,f]:(c=null,a=o);null!==i?n=[n,i]:(n=null,a=h)}else n=null,a=h;return n},disp_type:ji,disp_param:Bi,handling_param:Wi,Content_Encoding:function(){var n,i,c,f,h,o;if(h=a,null!==(n=Y())){for(i=[],o=a,null!==(c=P())&&null!==(f=Y())?c=[c,f]:(c=null,a=o);null!==c;)i.push(c),o=a,null!==(c=P())&&null!==(f=Y())?c=[c,f]:(c=null,a=o);null!==i?n=[n,i]:(n=null,a=h)}else n=null,a=h;return n},Content_Length:function(){var n,i,c;if(c=a,null!==(i=b()))for(n=[];null!==i;)n.push(i),i=b();else n=null;null!==n&&(n=void(Mc=parseInt(n.join(""))));null===n&&(a=c);return n},Content_Type:function(){var n,c;c=a,null!==(n=Vi())&&(f=c,n=void(Mc=i.substring(a,f)));var f;null===n&&(a=c);return n},media_type:Vi,m_type:Ki,discrete_type:Yi,composite_type:Ui,extension_token:zi,x_token:Xi,m_subtype:$i,m_parameter:Ji,m_value:Zi,CSeq:function(){var n,i,c,f;f=a,null!==(n=Di())&&null!==(i=H())&&null!==(c=bi())?n=[n,i,c]:(n=null,a=f);return n},CSeq_value:Di,Expires:function(){var n,i;i=a,null!==(n=Oi())&&(n=void(Mc=n));null===n&&(a=i);return n},Event:function(){var n,i,c,f,h,o,d;if(h=a,o=a,null!==(n=Qi())){for(i=[],d=a,null!==(c=q())&&null!==(f=Hi())?c=[c,f]:(c=null,a=d);null!==c;)i.push(c),d=a,null!==(c=q())&&null!==(f=Hi())?c=[c,f]:(c=null,a=d);null!==i?n=[n,i]:(n=null,a=o)}else n=null,a=o;null!==n&&(v=n[0],n=void(Mc.event=v.join("").toLowerCase()));var v;null===n&&(a=h);return n},event_type:Qi,From:function(){var n,i,c,f,h,o,d;h=a,o=a,null===(n=u())&&(n=Ei());if(null!==n){for(i=[],d=a,null!==(c=q())&&null!==(f=Mi())?c=[c,f]:(c=null,a=d);null!==c;)i.push(c),d=a,null!==(c=q())&&null!==(f=Mi())?c=[c,f]:(c=null,a=d);null!==i?n=[n,i]:(n=null,a=o)}else n=null,a=o;null!==n&&(n=function(n){var i=Mc.tag;try{Mc=new Qc(Mc.uri,Mc.display_name,Mc.params),i&&Mc.setParam("tag",i)}catch(n){Mc=-1}}());null===n&&(a=h);return n},from_param:Mi,tag_param:Pi,Max_Forwards:function(){var n,i,c;if(c=a,null!==(i=b()))for(n=[];null!==i;)n.push(i),i=b();else n=null;null!==n&&(n=void(Mc=parseInt(n.join(""))));null===n&&(a=c);return n},Min_Expires:function(){var n,i;i=a,null!==(n=Oi())&&(n=void(Mc=n));null===n&&(a=i);return n},Name_Addr_Header:function(){var n,i,c,f,h,o,d,v,y,g;v=a,y=a,n=[],i=ki();for(;null!==i;)n.push(i),i=ki();if(null!==n)if(null!==(i=M()))if(null!==(c=r()))if(null!==(f=Q())){for(h=[],g=a,null!==(o=q())&&null!==(d=Hi())?o=[o,d]:(o=null,a=g);null!==o;)h.push(o),g=a,null!==(o=q())&&null!==(d=Hi())?o=[o,d]:(o=null,a=g);null!==h?n=[n,i,c,f,h]:(n=null,a=y)}else n=null,a=y;else n=null,a=y;else n=null,a=y;else n=null,a=y;null!==n&&(n=function(n){try{Mc=new Qc(Mc.uri,Mc.display_name,Mc.params)}catch(n){Mc=-1}}());null===n&&(a=v);return n},Proxy_Authenticate:function(){return qi()},challenge:qi,other_challenge:Gi,auth_param:Fi,digest_cln:Ii,realm:_i,realm_value:ti,domain:pi,URI:ei,nonce:li,nonce_value:ui,opaque:ri,stale:si,algorithm:nc,qop_options:ic,qop_value:cc,Proxy_Require:function(){var n,i,c,f,h,o;if(h=a,null!==(n=Y())){for(i=[],o=a,null!==(c=P())&&null!==(f=Y())?c=[c,f]:(c=null,a=o);null!==c;)i.push(c),o=a,null!==(c=P())&&null!==(f=Y())?c=[c,f]:(c=null,a=o);null!==i?n=[n,i]:(n=null,a=h)}else n=null,a=h;return n},Record_Route:function(){var n,i,c,f,h,o,d;if(h=a,o=a,null!==(n=fc())){for(i=[],d=a,null!==(c=P())&&null!==(f=fc())?c=[c,f]:(c=null,a=d);null!==c;)i.push(c),d=a,null!==(c=P())&&null!==(f=fc())?c=[c,f]:(c=null,a=d);null!==i?n=[n,i]:(n=null,a=o)}else n=null,a=o;null!==n&&(n=function(n){var i,c;for(c=Mc.multi_header.length,i=0;i<c;i++)if(null===Mc.multi_header[i].parsed){Mc=null;break}Mc=null!==Mc?Mc.multi_header:-1}());null===n&&(a=h);return n},rec_route:fc,Reason:function(){var n,c,f,h,d,v,g;d=a,v=a,"sip"===i.substr(a,3).toLowerCase()?(n=i.substr(a,3),a+=3):(n=null,0===o&&y('"SIP"'));null===n&&(n=Y());if(null!==n){for(c=[],g=a,null!==(f=q())&&null!==(h=hc())?f=[f,h]:(f=null,a=g);null!==f;)c.push(f),g=a,null!==(f=q())&&null!==(h=hc())?f=[f,h]:(f=null,a=g);null!==c?n=[n,c]:(n=null,a=v)}else n=null,a=v;null!==n&&(n=function(n,i){if(Mc.protocol=i.toLowerCase(),Mc.params||(Mc.params={}),Mc.params.text&&'"'===Mc.params.text[0]){var c=Mc.params.text;Mc.text=c.substring(1,c.length-1),delete Mc.params.text}}(0,n[0]));null===n&&(a=d);return n},reason_param:hc,reason_cause:ac,Require:function(){var n,i,c,f,h,o;if(h=a,null!==(n=Y())){for(i=[],o=a,null!==(c=P())&&null!==(f=Y())?c=[c,f]:(c=null,a=o);null!==c;)i.push(c),o=a,null!==(c=P())&&null!==(f=Y())?c=[c,f]:(c=null,a=o);null!==i?n=[n,i]:(n=null,a=h)}else n=null,a=h;return n},Route:function(){var n,i,c,f,h,o;if(h=a,null!==(n=oc())){for(i=[],o=a,null!==(c=P())&&null!==(f=oc())?c=[c,f]:(c=null,a=o);null!==c;)i.push(c),o=a,null!==(c=P())&&null!==(f=oc())?c=[c,f]:(c=null,a=o);null!==i?n=[n,i]:(n=null,a=h)}else n=null,a=h;return n},route_param:oc,Subscription_State:function(){var n,i,c,f,h,o;if(h=a,null!==(n=dc())){for(i=[],o=a,null!==(c=q())&&null!==(f=vc())?c=[c,f]:(c=null,a=o);null!==c;)i.push(c),o=a,null!==(c=q())&&null!==(f=vc())?c=[c,f]:(c=null,a=o);null!==i?n=[n,i]:(n=null,a=h)}else n=null,a=h;return n},substate_value:dc,subexp_params:vc,event_reason_value:yc,Subject:function(){var n;return n=null!==(n=B())?n:""},Supported:function(){var n,i,c,f,h,o;if(h=a,null!==(n=Y())){for(i=[],o=a,null!==(c=P())&&null!==(f=Y())?c=[c,f]:(c=null,a=o);null!==c;)i.push(c),o=a,null!==(c=P())&&null!==(f=Y())?c=[c,f]:(c=null,a=o);null!==i?n=[n,i]:(n=null,a=h)}else n=null,a=h;return n=null!==n?n:""},To:function(){var n,i,c,f,h,o,d;h=a,o=a,null===(n=u())&&(n=Ei());if(null!==n){for(i=[],d=a,null!==(c=q())&&null!==(f=gc())?c=[c,f]:(c=null,a=d);null!==c;)i.push(c),d=a,null!==(c=q())&&null!==(f=gc())?c=[c,f]:(c=null,a=d);null!==i?n=[n,i]:(n=null,a=o)}else n=null,a=o;null!==n&&(n=function(n){var i=Mc.tag;try{Mc=new Qc(Mc.uri,Mc.display_name,Mc.params),i&&Mc.setParam("tag",i)}catch(n){Mc=-1}}());null===n&&(a=h);return n},to_param:gc,Via:function(){var n,i,c,f,h,o;if(h=a,null!==(n=bc())){for(i=[],o=a,null!==(c=P())&&null!==(f=bc())?c=[c,f]:(c=null,a=o);null!==c;)i.push(c),o=a,null!==(c=P())&&null!==(f=bc())?c=[c,f]:(c=null,a=o);null!==i?n=[n,i]:(n=null,a=h)}else n=null,a=h;return n},via_param:bc,via_params:mc,via_ttl:wc,via_maddr:Ac,via_received:Cc,via_branch:Tc,response_port:Ec,sent_protocol:kc,protocol_name:Nc,transport:Rc,sent_by:xc,via_host:Oc,via_port:Lc,ttl:Hc,WWW_Authenticate:function(){return qi()},Session_Expires:function(){var n,i,c,f,h,o;if(h=a,null!==(n=Sc())){for(i=[],o=a,null!==(c=q())&&null!==(f=jc())?c=[c,f]:(c=null,a=o);null!==c;)i.push(c),o=a,null!==(c=q())&&null!==(f=jc())?c=[c,f]:(c=null,a=o);null!==i?n=[n,i]:(n=null,a=h)}else n=null,a=h;return n},s_e_expires:Sc,s_e_params:jc,s_e_refresher:Bc,extension_header:function(){var n,i,c,f;f=a,null!==(n=Y())&&null!==(i=j())&&null!==(c=Wc())?n=[n,i,c]:(n=null,a=f);return n},header_value:Wc,message_body:function(){var n,i;n=[],i=C();for(;null!==i;)n.push(i),i=C();return n},uuid_URI:function(){var n,c,f;f=a,"uuid:"===i.substr(a,5)?(n="uuid:",a+=5):(n=null,0===o&&y('"uuid:"'));null!==n&&null!==(c=Vc())?n=[n,c]:(n=null,a=f);return n},uuid:Vc,hex4:Kc,hex8:Yc,hex12:Uc,Refer_To:function(){var n,i,c,f,h,o,d;h=a,o=a,null===(n=u())&&(n=Ei());if(null!==n){for(i=[],d=a,null!==(c=q())&&null!==(f=Hi())?c=[c,f]:(c=null,a=d);null!==c;)i.push(c),d=a,null!==(c=q())&&null!==(f=Hi())?c=[c,f]:(c=null,a=d);null!==i?n=[n,i]:(n=null,a=o)}else n=null,a=o;null!==n&&(n=function(n){try{Mc=new Qc(Mc.uri,Mc.display_name,Mc.params)}catch(n){Mc=-1}}());null===n&&(a=h);return n},Replaces:function(){var n,i,c,f,h,o;if(h=a,null!==(n=zc())){for(i=[],o=a,null!==(c=q())&&null!==(f=Xc())?c=[c,f]:(c=null,a=o);null!==c;)i.push(c),o=a,null!==(c=q())&&null!==(f=Xc())?c=[c,f]:(c=null,a=o);null!==i?n=[n,i]:(n=null,a=h)}else n=null,a=h;return n},call_id:zc,replaces_param:Xc,to_tag:$c,from_tag:Jc,early_flag:Zc};if(void 0!==f){if(void 0===h[f])throw new Error("Invalid rule name: "+n(f)+".")}else f="CRLF";var a=0,o=0,d=0,v=[];function y(n){a<d||(a>d&&(d=a,v=[]),v.push(n))}function g(){var n;return"\r\n"===i.substr(a,2)?(n="\r\n",a+=2):(n=null,0===o&&y('"\\r\\n"')),n}function b(){var n;return/^[0-9]/.test(i.charAt(a))?(n=i.charAt(a),a++):(n=null,0===o&&y("[0-9]")),n}function m(){var n;return/^[a-zA-Z]/.test(i.charAt(a))?(n=i.charAt(a),a++):(n=null,0===o&&y("[a-zA-Z]")),n}function w(){var n;return/^[0-9a-fA-F]/.test(i.charAt(a))?(n=i.charAt(a),a++):(n=null,0===o&&y("[0-9a-fA-F]")),n}function A(){var n;return null===(n=E())&&(n=k()),n}function C(){var n;return/^[\0-\xFF]/.test(i.charAt(a))?(n=i.charAt(a),a++):(n=null,0===o&&y("[\\0-\\xFF]")),n}function T(){var n;return/^["]/.test(i.charAt(a))?(n=i.charAt(a),a++):(n=null,0===o&&y('["]')),n}function E(){var n;return 32===i.charCodeAt(a)?(n=" ",a++):(n=null,0===o&&y('" "')),n}function k(){var n;return 9===i.charCodeAt(a)?(n="\t",a++):(n=null,0===o&&y('"\\t"')),n}function N(){var n;return/^[a-zA-Z0-9]/.test(i.charAt(a))?(n=i.charAt(a),a++):(n=null,0===o&&y("[a-zA-Z0-9]")),n}function R(){var n;return 59===i.charCodeAt(a)?(n=";",a++):(n=null,0===o&&y('";"')),null===n&&(47===i.charCodeAt(a)?(n="/",a++):(n=null,0===o&&y('"/"')),null===n&&(63===i.charCodeAt(a)?(n="?",a++):(n=null,0===o&&y('"?"')),null===n&&(58===i.charCodeAt(a)?(n=":",a++):(n=null,0===o&&y('":"')),null===n&&(64===i.charCodeAt(a)?(n="@",a++):(n=null,0===o&&y('"@"')),null===n&&(38===i.charCodeAt(a)?(n="&",a++):(n=null,0===o&&y('"&"')),null===n&&(61===i.charCodeAt(a)?(n="=",a++):(n=null,0===o&&y('"="')),null===n&&(43===i.charCodeAt(a)?(n="+",a++):(n=null,0===o&&y('"+"')),null===n&&(36===i.charCodeAt(a)?(n="$",a++):(n=null,0===o&&y('"$"')),null===n&&(44===i.charCodeAt(a)?(n=",",a++):(n=null,0===o&&y('","'))))))))))),n}function x(){var n;return null===(n=N())&&(n=O()),n}function O(){var n;return 45===i.charCodeAt(a)?(n="-",a++):(n=null,0===o&&y('"-"')),null===n&&(95===i.charCodeAt(a)?(n="_",a++):(n=null,0===o&&y('"_"')),null===n&&(46===i.charCodeAt(a)?(n=".",a++):(n=null,0===o&&y('"."')),null===n&&(33===i.charCodeAt(a)?(n="!",a++):(n=null,0===o&&y('"!"')),null===n&&(126===i.charCodeAt(a)?(n="~",a++):(n=null,0===o&&y('"~"')),null===n&&(42===i.charCodeAt(a)?(n="*",a++):(n=null,0===o&&y('"*"')),null===n&&(39===i.charCodeAt(a)?(n="'",a++):(n=null,0===o&&y('"\'"')),null===n&&(40===i.charCodeAt(a)?(n="(",a++):(n=null,0===o&&y('"("')),null===n&&(41===i.charCodeAt(a)?(n=")",a++):(n=null,0===o&&y('")"')))))))))),n}function L(){var n,c,f,h,d;return h=a,d=a,37===i.charCodeAt(a)?(n="%",a++):(n=null,0===o&&y('"%"')),null!==n&&null!==(c=w())&&null!==(f=w())?n=[n,c,f]:(n=null,a=d),null!==n&&(n=n.join("")),null===n&&(a=h),n}function H(){var n,i,c,f,h,o;for(f=a,h=a,o=a,n=[],i=A();null!==i;)n.push(i),i=A();if(null!==n&&null!==(i=g())?n=[n,i]:(n=null,a=o),null!==(n=null!==n?n:"")){if(null!==(c=A()))for(i=[];null!==c;)i.push(c),c=A();else i=null;null!==i?n=[n,i]:(n=null,a=h)}else n=null,a=h;return null!==n&&(n=" "),null===n&&(a=f),n}function S(){var n;return n=null!==(n=H())?n:""}function j(){var n,c,f,h,d;for(h=a,d=a,n=[],null===(c=E())&&(c=k());null!==c;)n.push(c),null===(c=E())&&(c=k());return null!==n?(58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null!==c&&null!==(f=S())?n=[n,c,f]:(n=null,a=d)):(n=null,a=d),null!==n&&(n=":"),null===n&&(a=h),n}function B(){var n,c,f,h,o,d,v,y;if(o=a,d=a,null!==(c=W()))for(n=[];null!==c;)n.push(c),c=W();else n=null;if(null!==n){for(c=[],v=a,f=[],h=H();null!==h;)f.push(h),h=H();for(null!==f&&null!==(h=W())?f=[f,h]:(f=null,a=v);null!==f;){for(c.push(f),v=a,f=[],h=H();null!==h;)f.push(h),h=H();null!==f&&null!==(h=W())?f=[f,h]:(f=null,a=v)}null!==c?n=[n,c]:(n=null,a=d)}else n=null,a=d;return null!==n&&(y=o,n=i.substring(a,y)),null===n&&(a=o),n}function W(){var n;return/^[!-~]/.test(i.charAt(a))?(n=i.charAt(a),a++):(n=null,0===o&&y("[!-~]")),null===n&&(n=V()),n}function V(){var n;return/^[\x80-\uFFFF]/.test(i.charAt(a))?(n=i.charAt(a),a++):(n=null,0===o&&y("[\\x80-\\uFFFF]")),n}function K(){var n;return/^[\x80-\xBF]/.test(i.charAt(a))?(n=i.charAt(a),a++):(n=null,0===o&&y("[\\x80-\\xBF]")),n}function Y(){var n,c,f,h;if(f=a,null===(c=N())&&(45===i.charCodeAt(a)?(c="-",a++):(c=null,0===o&&y('"-"')),null===c&&(46===i.charCodeAt(a)?(c=".",a++):(c=null,0===o&&y('"."')),null===c&&(33===i.charCodeAt(a)?(c="!",a++):(c=null,0===o&&y('"!"')),null===c&&(37===i.charCodeAt(a)?(c="%",a++):(c=null,0===o&&y('"%"')),null===c&&(42===i.charCodeAt(a)?(c="*",a++):(c=null,0===o&&y('"*"')),null===c&&(95===i.charCodeAt(a)?(c="_",a++):(c=null,0===o&&y('"_"')),null===c&&(43===i.charCodeAt(a)?(c="+",a++):(c=null,0===o&&y('"+"')),null===c&&(96===i.charCodeAt(a)?(c="`",a++):(c=null,0===o&&y('"`"')),null===c&&(39===i.charCodeAt(a)?(c="'",a++):(c=null,0===o&&y('"\'"')),null===c&&(126===i.charCodeAt(a)?(c="~",a++):(c=null,0===o&&y('"~"')))))))))))),null!==c)for(n=[];null!==c;)n.push(c),null===(c=N())&&(45===i.charCodeAt(a)?(c="-",a++):(c=null,0===o&&y('"-"')),null===c&&(46===i.charCodeAt(a)?(c=".",a++):(c=null,0===o&&y('"."')),null===c&&(33===i.charCodeAt(a)?(c="!",a++):(c=null,0===o&&y('"!"')),null===c&&(37===i.charCodeAt(a)?(c="%",a++):(c=null,0===o&&y('"%"')),null===c&&(42===i.charCodeAt(a)?(c="*",a++):(c=null,0===o&&y('"*"')),null===c&&(95===i.charCodeAt(a)?(c="_",a++):(c=null,0===o&&y('"_"')),null===c&&(43===i.charCodeAt(a)?(c="+",a++):(c=null,0===o&&y('"+"')),null===c&&(96===i.charCodeAt(a)?(c="`",a++):(c=null,0===o&&y('"`"')),null===c&&(39===i.charCodeAt(a)?(c="'",a++):(c=null,0===o&&y('"\'"')),null===c&&(126===i.charCodeAt(a)?(c="~",a++):(c=null,0===o&&y('"~"'))))))))))));else n=null;return null!==n&&(h=f,n=i.substring(a,h)),null===n&&(a=f),n}function U(){var n,c,f,h;if(f=a,null===(c=N())&&(45===i.charCodeAt(a)?(c="-",a++):(c=null,0===o&&y('"-"')),null===c&&(33===i.charCodeAt(a)?(c="!",a++):(c=null,0===o&&y('"!"')),null===c&&(37===i.charCodeAt(a)?(c="%",a++):(c=null,0===o&&y('"%"')),null===c&&(42===i.charCodeAt(a)?(c="*",a++):(c=null,0===o&&y('"*"')),null===c&&(95===i.charCodeAt(a)?(c="_",a++):(c=null,0===o&&y('"_"')),null===c&&(43===i.charCodeAt(a)?(c="+",a++):(c=null,0===o&&y('"+"')),null===c&&(96===i.charCodeAt(a)?(c="`",a++):(c=null,0===o&&y('"`"')),null===c&&(39===i.charCodeAt(a)?(c="'",a++):(c=null,0===o&&y('"\'"')),null===c&&(126===i.charCodeAt(a)?(c="~",a++):(c=null,0===o&&y('"~"'))))))))))),null!==c)for(n=[];null!==c;)n.push(c),null===(c=N())&&(45===i.charCodeAt(a)?(c="-",a++):(c=null,0===o&&y('"-"')),null===c&&(33===i.charCodeAt(a)?(c="!",a++):(c=null,0===o&&y('"!"')),null===c&&(37===i.charCodeAt(a)?(c="%",a++):(c=null,0===o&&y('"%"')),null===c&&(42===i.charCodeAt(a)?(c="*",a++):(c=null,0===o&&y('"*"')),null===c&&(95===i.charCodeAt(a)?(c="_",a++):(c=null,0===o&&y('"_"')),null===c&&(43===i.charCodeAt(a)?(c="+",a++):(c=null,0===o&&y('"+"')),null===c&&(96===i.charCodeAt(a)?(c="`",a++):(c=null,0===o&&y('"`"')),null===c&&(39===i.charCodeAt(a)?(c="'",a++):(c=null,0===o&&y('"\'"')),null===c&&(126===i.charCodeAt(a)?(c="~",a++):(c=null,0===o&&y('"~"')))))))))));else n=null;return null!==n&&(h=f,n=i.substring(a,h)),null===n&&(a=f),n}function z(){var n,c,f,h;if(f=a,null===(c=N())&&(45===i.charCodeAt(a)?(c="-",a++):(c=null,0===o&&y('"-"')),null===c&&(46===i.charCodeAt(a)?(c=".",a++):(c=null,0===o&&y('"."')),null===c&&(33===i.charCodeAt(a)?(c="!",a++):(c=null,0===o&&y('"!"')),null===c&&(37===i.charCodeAt(a)?(c="%",a++):(c=null,0===o&&y('"%"')),null===c&&(42===i.charCodeAt(a)?(c="*",a++):(c=null,0===o&&y('"*"')),null===c&&(95===i.charCodeAt(a)?(c="_",a++):(c=null,0===o&&y('"_"')),null===c&&(43===i.charCodeAt(a)?(c="+",a++):(c=null,0===o&&y('"+"')),null===c&&(96===i.charCodeAt(a)?(c="`",a++):(c=null,0===o&&y('"`"')),null===c&&(39===i.charCodeAt(a)?(c="'",a++):(c=null,0===o&&y('"\'"')),null===c&&(126===i.charCodeAt(a)?(c="~",a++):(c=null,0===o&&y('"~"')),null===c&&(40===i.charCodeAt(a)?(c="(",a++):(c=null,0===o&&y('"("')),null===c&&(41===i.charCodeAt(a)?(c=")",a++):(c=null,0===o&&y('")"')),null===c&&(60===i.charCodeAt(a)?(c="<",a++):(c=null,0===o&&y('"<"')),null===c&&(62===i.charCodeAt(a)?(c=">",a++):(c=null,0===o&&y('">"')),null===c&&(58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null===c&&(92===i.charCodeAt(a)?(c="\\",a++):(c=null,0===o&&y('"\\\\"')),null===c&&null===(c=T())&&(47===i.charCodeAt(a)?(c="/",a++):(c=null,0===o&&y('"/"')),null===c&&(91===i.charCodeAt(a)?(c="[",a++):(c=null,0===o&&y('"["')),null===c&&(93===i.charCodeAt(a)?(c="]",a++):(c=null,0===o&&y('"]"')),null===c&&(63===i.charCodeAt(a)?(c="?",a++):(c=null,0===o&&y('"?"')),null===c&&(123===i.charCodeAt(a)?(c="{",a++):(c=null,0===o&&y('"{"')),null===c&&(125===i.charCodeAt(a)?(c="}",a++):(c=null,0===o&&y('"}"')))))))))))))))))))))))),null!==c)for(n=[];null!==c;)n.push(c),null===(c=N())&&(45===i.charCodeAt(a)?(c="-",a++):(c=null,0===o&&y('"-"')),null===c&&(46===i.charCodeAt(a)?(c=".",a++):(c=null,0===o&&y('"."')),null===c&&(33===i.charCodeAt(a)?(c="!",a++):(c=null,0===o&&y('"!"')),null===c&&(37===i.charCodeAt(a)?(c="%",a++):(c=null,0===o&&y('"%"')),null===c&&(42===i.charCodeAt(a)?(c="*",a++):(c=null,0===o&&y('"*"')),null===c&&(95===i.charCodeAt(a)?(c="_",a++):(c=null,0===o&&y('"_"')),null===c&&(43===i.charCodeAt(a)?(c="+",a++):(c=null,0===o&&y('"+"')),null===c&&(96===i.charCodeAt(a)?(c="`",a++):(c=null,0===o&&y('"`"')),null===c&&(39===i.charCodeAt(a)?(c="'",a++):(c=null,0===o&&y('"\'"')),null===c&&(126===i.charCodeAt(a)?(c="~",a++):(c=null,0===o&&y('"~"')),null===c&&(40===i.charCodeAt(a)?(c="(",a++):(c=null,0===o&&y('"("')),null===c&&(41===i.charCodeAt(a)?(c=")",a++):(c=null,0===o&&y('")"')),null===c&&(60===i.charCodeAt(a)?(c="<",a++):(c=null,0===o&&y('"<"')),null===c&&(62===i.charCodeAt(a)?(c=">",a++):(c=null,0===o&&y('">"')),null===c&&(58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null===c&&(92===i.charCodeAt(a)?(c="\\",a++):(c=null,0===o&&y('"\\\\"')),null===c&&null===(c=T())&&(47===i.charCodeAt(a)?(c="/",a++):(c=null,0===o&&y('"/"')),null===c&&(91===i.charCodeAt(a)?(c="[",a++):(c=null,0===o&&y('"["')),null===c&&(93===i.charCodeAt(a)?(c="]",a++):(c=null,0===o&&y('"]"')),null===c&&(63===i.charCodeAt(a)?(c="?",a++):(c=null,0===o&&y('"?"')),null===c&&(123===i.charCodeAt(a)?(c="{",a++):(c=null,0===o&&y('"{"')),null===c&&(125===i.charCodeAt(a)?(c="}",a++):(c=null,0===o&&y('"}"'))))))))))))))))))))))));else n=null;return null!==n&&(h=f,n=i.substring(a,h)),null===n&&(a=f),n}function X(){var n,c,f,h,d;return h=a,d=a,null!==(n=S())?(42===i.charCodeAt(a)?(c="*",a++):(c=null,0===o&&y('"*"')),null!==c&&null!==(f=S())?n=[n,c,f]:(n=null,a=d)):(n=null,a=d),null!==n&&(n="*"),null===n&&(a=h),n}function $(){var n,c,f,h,d;return h=a,d=a,null!==(n=S())?(47===i.charCodeAt(a)?(c="/",a++):(c=null,0===o&&y('"/"')),null!==c&&null!==(f=S())?n=[n,c,f]:(n=null,a=d)):(n=null,a=d),null!==n&&(n="/"),null===n&&(a=h),n}function J(){var n,c,f,h,d;return h=a,d=a,null!==(n=S())?(61===i.charCodeAt(a)?(c="=",a++):(c=null,0===o&&y('"="')),null!==c&&null!==(f=S())?n=[n,c,f]:(n=null,a=d)):(n=null,a=d),null!==n&&(n="="),null===n&&(a=h),n}function Z(){var n,c,f,h,d;return h=a,d=a,null!==(n=S())?(40===i.charCodeAt(a)?(c="(",a++):(c=null,0===o&&y('"("')),null!==c&&null!==(f=S())?n=[n,c,f]:(n=null,a=d)):(n=null,a=d),null!==n&&(n="("),null===n&&(a=h),n}function D(){var n,c,f,h,d;return h=a,d=a,null!==(n=S())?(41===i.charCodeAt(a)?(c=")",a++):(c=null,0===o&&y('")"')),null!==c&&null!==(f=S())?n=[n,c,f]:(n=null,a=d)):(n=null,a=d),null!==n&&(n=")"),null===n&&(a=h),n}function Q(){var n,c,f,h;return f=a,h=a,62===i.charCodeAt(a)?(n=">",a++):(n=null,0===o&&y('">"')),null!==n&&null!==(c=S())?n=[n,c]:(n=null,a=h),null!==n&&(n=">"),null===n&&(a=f),n}function M(){var n,c,f,h;return f=a,h=a,null!==(n=S())?(60===i.charCodeAt(a)?(c="<",a++):(c=null,0===o&&y('"<"')),null!==c?n=[n,c]:(n=null,a=h)):(n=null,a=h),null!==n&&(n="<"),null===n&&(a=f),n}function P(){var n,c,f,h,d;return h=a,d=a,null!==(n=S())?(44===i.charCodeAt(a)?(c=",",a++):(c=null,0===o&&y('","')),null!==c&&null!==(f=S())?n=[n,c,f]:(n=null,a=d)):(n=null,a=d),null!==n&&(n=","),null===n&&(a=h),n}function q(){var n,c,f,h,d;return h=a,d=a,null!==(n=S())?(59===i.charCodeAt(a)?(c=";",a++):(c=null,0===o&&y('";"')),null!==c&&null!==(f=S())?n=[n,c,f]:(n=null,a=d)):(n=null,a=d),null!==n&&(n=";"),null===n&&(a=h),n}function G(){var n,c,f,h,d;return h=a,d=a,null!==(n=S())?(58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null!==c&&null!==(f=S())?n=[n,c,f]:(n=null,a=d)):(n=null,a=d),null!==n&&(n=":"),null===n&&(a=h),n}function F(){var n,i,c,f;return c=a,f=a,null!==(n=S())&&null!==(i=T())?n=[n,i]:(n=null,a=f),null!==n&&(n='"'),null===n&&(a=c),n}function I(){var n,i,c,f;return c=a,f=a,null!==(n=T())&&null!==(i=S())?n=[n,i]:(n=null,a=f),null!==n&&(n='"'),null===n&&(a=c),n}function _(){var n;return/^[!-']/.test(i.charAt(a))?(n=i.charAt(a),a++):(n=null,0===o&&y("[!-']")),null===n&&(/^[*-[]/.test(i.charAt(a))?(n=i.charAt(a),a++):(n=null,0===o&&y("[*-[]")),null===n&&(/^[\]-~]/.test(i.charAt(a))?(n=i.charAt(a),a++):(n=null,0===o&&y("[\\]-~]")),null===n&&null===(n=V())&&(n=H()))),n}function t(){var n,c,f,h,o,d,v;if(o=a,d=a,null!==(n=S()))if(null!==(c=T())){for(f=[],null===(h=e())&&(h=l());null!==h;)f.push(h),null===(h=e())&&(h=l());null!==f&&null!==(h=T())?n=[n,c,f,h]:(n=null,a=d)}else n=null,a=d;else n=null,a=d;return null!==n&&(v=o,n=i.substring(a,v)),null===n&&(a=o),n}function p(){var n,c,f,h,o,d,v;if(o=a,d=a,null!==(n=S()))if(null!==(c=T())){for(f=[],null===(h=e())&&(h=l());null!==h;)f.push(h),null===(h=e())&&(h=l());null!==f&&null!==(h=T())?n=[n,c,f,h]:(n=null,a=d)}else n=null,a=d;else n=null,a=d;return null!==n&&(v=o,n=i.substring(a-1,v+1)),null===n&&(a=o),n}function e(){var n;return null===(n=H())&&(33===i.charCodeAt(a)?(n="!",a++):(n=null,0===o&&y('"!"')),null===n&&(/^[#-[]/.test(i.charAt(a))?(n=i.charAt(a),a++):(n=null,0===o&&y("[#-[]")),null===n&&(/^[\]-~]/.test(i.charAt(a))?(n=i.charAt(a),a++):(n=null,0===o&&y("[\\]-~]")),null===n&&(n=V())))),n}function l(){var n,c,f;return f=a,92===i.charCodeAt(a)?(n="\\",a++):(n=null,0===o&&y('"\\\\"')),null!==n?(/^[\0-\t]/.test(i.charAt(a))?(c=i.charAt(a),a++):(c=null,0===o&&y("[\\0-\\t]")),null===c&&(/^[\x0B-\f]/.test(i.charAt(a))?(c=i.charAt(a),a++):(c=null,0===o&&y("[\\x0B-\\f]")),null===c&&(/^[\x0E-]/.test(i.charAt(a))?(c=i.charAt(a),a++):(c=null,0===o&&y("[\\x0E-]")))),null!==c?n=[n,c]:(n=null,a=f)):(n=null,a=f),n}function u(){var n,c,f,h,d,v;return d=a,v=a,null!==(n=s())?(58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null!==c&&null!==(f=null!==(f=fn())?f:"")&&null!==(h=dn())?n=[n,c,f,h]:(n=null,a=v)):(n=null,a=v),null!==n&&(n=function(n){try{Mc.uri=new Dc(Mc.scheme,Mc.user,Mc.host,Mc.port),delete Mc.scheme,delete Mc.user,delete Mc.host,delete Mc.host_type,delete Mc.port}catch(n){Mc=-1}}()),null===n&&(a=d),n}function r(){var n,c,h,d,v,g,b,m;return b=a,m=a,null!==(n=s())?(58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null!==c&&null!==(h=null!==(h=fn())?h:"")&&null!==(d=dn())&&null!==(v=Nn())&&null!==(g=null!==(g=Un())?g:"")?n=[n,c,h,d,v,g]:(n=null,a=m)):(n=null,a=m),null!==n&&(n=function(n){try{Mc.uri=new Dc(Mc.scheme,Mc.user,Mc.host,Mc.port,Mc.uri_params,Mc.uri_headers),delete Mc.scheme,delete Mc.user,delete Mc.host,delete Mc.host_type,delete Mc.port,delete Mc.uri_params,"SIP_URI"===f&&(Mc=Mc.uri)}catch(n){Mc=-1}}()),null===n&&(a=b),n}function s(){var n;return null===(n=nn())&&(n=cn()),n}function nn(){var n,c,f;return c=a,"sips"===i.substr(a,4).toLowerCase()?(n=i.substr(a,4),a+=4):(n=null,0===o&&y('"sips"')),null!==n&&(f=n,n=void(Mc.scheme=f.toLowerCase())),null===n&&(a=c),n}function cn(){var n,c,f;return c=a,"sip"===i.substr(a,3).toLowerCase()?(n=i.substr(a,3),a+=3):(n=null,0===o&&y('"sip"')),null!==n&&(f=n,n=void(Mc.scheme=f.toLowerCase())),null===n&&(a=c),n}function fn(){var n,c,f,h,d,v,g;return h=a,d=a,null!==(n=hn())?(v=a,58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null!==c&&null!==(f=on())?c=[c,f]:(c=null,a=v),null!==(c=null!==c?c:"")?(64===i.charCodeAt(a)?(f="@",a++):(f=null,0===o&&y('"@"')),null!==f?n=[n,c,f]:(n=null,a=d)):(n=null,a=d)):(n=null,a=d),null!==n&&(g=h,n=void(Mc.user=decodeURIComponent(i.substring(a-1,g)))),null===n&&(a=h),n}function hn(){var n,i;if(null===(i=x())&&null===(i=L())&&(i=an()),null!==i)for(n=[];null!==i;)n.push(i),null===(i=x())&&null===(i=L())&&(i=an());else n=null;return n}function an(){var n;return 38===i.charCodeAt(a)?(n="&",a++):(n=null,0===o&&y('"&"')),null===n&&(61===i.charCodeAt(a)?(n="=",a++):(n=null,0===o&&y('"="')),null===n&&(43===i.charCodeAt(a)?(n="+",a++):(n=null,0===o&&y('"+"')),null===n&&(36===i.charCodeAt(a)?(n="$",a++):(n=null,0===o&&y('"$"')),null===n&&(44===i.charCodeAt(a)?(n=",",a++):(n=null,0===o&&y('","')),null===n&&(59===i.charCodeAt(a)?(n=";",a++):(n=null,0===o&&y('";"')),null===n&&(63===i.charCodeAt(a)?(n="?",a++):(n=null,0===o&&y('"?"')),null===n&&(47===i.charCodeAt(a)?(n="/",a++):(n=null,0===o&&y('"/"'))))))))),n}function on(){var n,c,f,h;for(f=a,n=[],null===(c=x())&&null===(c=L())&&(38===i.charCodeAt(a)?(c="&",a++):(c=null,0===o&&y('"&"')),null===c&&(61===i.charCodeAt(a)?(c="=",a++):(c=null,0===o&&y('"="')),null===c&&(43===i.charCodeAt(a)?(c="+",a++):(c=null,0===o&&y('"+"')),null===c&&(36===i.charCodeAt(a)?(c="$",a++):(c=null,0===o&&y('"$"')),null===c&&(44===i.charCodeAt(a)?(c=",",a++):(c=null,0===o&&y('","')))))));null!==c;)n.push(c),null===(c=x())&&null===(c=L())&&(38===i.charCodeAt(a)?(c="&",a++):(c=null,0===o&&y('"&"')),null===c&&(61===i.charCodeAt(a)?(c="=",a++):(c=null,0===o&&y('"="')),null===c&&(43===i.charCodeAt(a)?(c="+",a++):(c=null,0===o&&y('"+"')),null===c&&(36===i.charCodeAt(a)?(c="$",a++):(c=null,0===o&&y('"$"')),null===c&&(44===i.charCodeAt(a)?(c=",",a++):(c=null,0===o&&y('","')))))));return null!==n&&(h=f,n=void(Mc.password=i.substring(a,h))),null===n&&(a=f),n}function dn(){var n,c,f,h,d;return h=a,null!==(n=vn())?(d=a,58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null!==c&&null!==(f=kn())?c=[c,f]:(c=null,a=d),null!==(c=null!==c?c:"")?n=[n,c]:(n=null,a=h)):(n=null,a=h),n}function vn(){var n,c,f;return c=a,null===(n=yn())&&null===(n=Tn())&&(n=mn()),null!==n&&(f=c,Mc.host=i.substring(a,f).toLowerCase(),n=Mc.host),null===n&&(a=c),n}function yn(){var n,c,f,h,d,v,g;for(h=a,d=a,n=[],v=a,null!==(c=gn())?(46===i.charCodeAt(a)?(f=".",a++):(f=null,0===o&&y('"."')),null!==f?c=[c,f]:(c=null,a=v)):(c=null,a=v);null!==c;)n.push(c),v=a,null!==(c=gn())?(46===i.charCodeAt(a)?(f=".",a++):(f=null,0===o&&y('"."')),null!==f?c=[c,f]:(c=null,a=v)):(c=null,a=v);return null!==n&&null!==(c=bn())?(46===i.charCodeAt(a)?(f=".",a++):(f=null,0===o&&y('"."')),null!==(f=null!==f?f:"")?n=[n,c,f]:(n=null,a=d)):(n=null,a=d),null!==n&&(g=h,Mc.host_type="domain",n=i.substring(a,g)),null===n&&(a=h),n}function gn(){var n,c,f,h;if(h=a,null!==(n=N())){for(c=[],null===(f=N())&&(45===i.charCodeAt(a)?(f="-",a++):(f=null,0===o&&y('"-"')),null===f&&(95===i.charCodeAt(a)?(f="_",a++):(f=null,0===o&&y('"_"'))));null!==f;)c.push(f),null===(f=N())&&(45===i.charCodeAt(a)?(f="-",a++):(f=null,0===o&&y('"-"')),null===f&&(95===i.charCodeAt(a)?(f="_",a++):(f=null,0===o&&y('"_"'))));null!==c?n=[n,c]:(n=null,a=h)}else n=null,a=h;return n}function bn(){var n,c,f,h;if(h=a,null!==(n=m())){for(c=[],null===(f=N())&&(45===i.charCodeAt(a)?(f="-",a++):(f=null,0===o&&y('"-"')),null===f&&(95===i.charCodeAt(a)?(f="_",a++):(f=null,0===o&&y('"_"'))));null!==f;)c.push(f),null===(f=N())&&(45===i.charCodeAt(a)?(f="-",a++):(f=null,0===o&&y('"-"')),null===f&&(95===i.charCodeAt(a)?(f="_",a++):(f=null,0===o&&y('"_"'))));null!==c?n=[n,c]:(n=null,a=h)}else n=null,a=h;return n}function mn(){var n,c,f,h,d,v;return h=a,d=a,91===i.charCodeAt(a)?(n="[",a++):(n=null,0===o&&y('"["')),null!==n&&null!==(c=wn())?(93===i.charCodeAt(a)?(f="]",a++):(f=null,0===o&&y('"]"')),null!==f?n=[n,c,f]:(n=null,a=d)):(n=null,a=d),null!==n&&(v=h,Mc.host_type="IPv6",n=i.substring(a,v)),null===n&&(a=h),n}function wn(){var n,c,f,h,d,v,g,b,m,w,A,C,T,E,k,N,R;return E=a,k=a,null!==(n=An())?(58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null!==c&&null!==(f=An())?(58===i.charCodeAt(a)?(h=":",a++):(h=null,0===o&&y('":"')),null!==h&&null!==(d=An())?(58===i.charCodeAt(a)?(v=":",a++):(v=null,0===o&&y('":"')),null!==v&&null!==(g=An())?(58===i.charCodeAt(a)?(b=":",a++):(b=null,0===o&&y('":"')),null!==b&&null!==(m=An())?(58===i.charCodeAt(a)?(w=":",a++):(w=null,0===o&&y('":"')),null!==w&&null!==(A=An())?(58===i.charCodeAt(a)?(C=":",a++):(C=null,0===o&&y('":"')),null!==C&&null!==(T=Cn())?n=[n,c,f,h,d,v,g,b,m,w,A,C,T]:(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k),null===n&&(k=a,"::"===i.substr(a,2)?(n="::",a+=2):(n=null,0===o&&y('"::"')),null!==n&&null!==(c=An())?(58===i.charCodeAt(a)?(f=":",a++):(f=null,0===o&&y('":"')),null!==f&&null!==(h=An())?(58===i.charCodeAt(a)?(d=":",a++):(d=null,0===o&&y('":"')),null!==d&&null!==(v=An())?(58===i.charCodeAt(a)?(g=":",a++):(g=null,0===o&&y('":"')),null!==g&&null!==(b=An())?(58===i.charCodeAt(a)?(m=":",a++):(m=null,0===o&&y('":"')),null!==m&&null!==(w=An())?(58===i.charCodeAt(a)?(A=":",a++):(A=null,0===o&&y('":"')),null!==A&&null!==(C=Cn())?n=[n,c,f,h,d,v,g,b,m,w,A,C]:(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k),null===n&&(k=a,"::"===i.substr(a,2)?(n="::",a+=2):(n=null,0===o&&y('"::"')),null!==n&&null!==(c=An())?(58===i.charCodeAt(a)?(f=":",a++):(f=null,0===o&&y('":"')),null!==f&&null!==(h=An())?(58===i.charCodeAt(a)?(d=":",a++):(d=null,0===o&&y('":"')),null!==d&&null!==(v=An())?(58===i.charCodeAt(a)?(g=":",a++):(g=null,0===o&&y('":"')),null!==g&&null!==(b=An())?(58===i.charCodeAt(a)?(m=":",a++):(m=null,0===o&&y('":"')),null!==m&&null!==(w=Cn())?n=[n,c,f,h,d,v,g,b,m,w]:(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k),null===n&&(k=a,"::"===i.substr(a,2)?(n="::",a+=2):(n=null,0===o&&y('"::"')),null!==n&&null!==(c=An())?(58===i.charCodeAt(a)?(f=":",a++):(f=null,0===o&&y('":"')),null!==f&&null!==(h=An())?(58===i.charCodeAt(a)?(d=":",a++):(d=null,0===o&&y('":"')),null!==d&&null!==(v=An())?(58===i.charCodeAt(a)?(g=":",a++):(g=null,0===o&&y('":"')),null!==g&&null!==(b=Cn())?n=[n,c,f,h,d,v,g,b]:(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k),null===n&&(k=a,"::"===i.substr(a,2)?(n="::",a+=2):(n=null,0===o&&y('"::"')),null!==n&&null!==(c=An())?(58===i.charCodeAt(a)?(f=":",a++):(f=null,0===o&&y('":"')),null!==f&&null!==(h=An())?(58===i.charCodeAt(a)?(d=":",a++):(d=null,0===o&&y('":"')),null!==d&&null!==(v=Cn())?n=[n,c,f,h,d,v]:(n=null,a=k)):(n=null,a=k)):(n=null,a=k),null===n&&(k=a,"::"===i.substr(a,2)?(n="::",a+=2):(n=null,0===o&&y('"::"')),null!==n&&null!==(c=An())?(58===i.charCodeAt(a)?(f=":",a++):(f=null,0===o&&y('":"')),null!==f&&null!==(h=Cn())?n=[n,c,f,h]:(n=null,a=k)):(n=null,a=k),null===n&&(k=a,"::"===i.substr(a,2)?(n="::",a+=2):(n=null,0===o&&y('"::"')),null!==n&&null!==(c=Cn())?n=[n,c]:(n=null,a=k),null===n&&(k=a,"::"===i.substr(a,2)?(n="::",a+=2):(n=null,0===o&&y('"::"')),null!==n&&null!==(c=An())?n=[n,c]:(n=null,a=k),null===n&&(k=a,null!==(n=An())?("::"===i.substr(a,2)?(c="::",a+=2):(c=null,0===o&&y('"::"')),null!==c&&null!==(f=An())?(58===i.charCodeAt(a)?(h=":",a++):(h=null,0===o&&y('":"')),null!==h&&null!==(d=An())?(58===i.charCodeAt(a)?(v=":",a++):(v=null,0===o&&y('":"')),null!==v&&null!==(g=An())?(58===i.charCodeAt(a)?(b=":",a++):(b=null,0===o&&y('":"')),null!==b&&null!==(m=An())?(58===i.charCodeAt(a)?(w=":",a++):(w=null,0===o&&y('":"')),null!==w&&null!==(A=Cn())?n=[n,c,f,h,d,v,g,b,m,w,A]:(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k),null===n&&(k=a,null!==(n=An())?(N=a,58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null!==c&&null!==(f=An())?c=[c,f]:(c=null,a=N),null!==(c=null!==c?c:"")?("::"===i.substr(a,2)?(f="::",a+=2):(f=null,0===o&&y('"::"')),null!==f&&null!==(h=An())?(58===i.charCodeAt(a)?(d=":",a++):(d=null,0===o&&y('":"')),null!==d&&null!==(v=An())?(58===i.charCodeAt(a)?(g=":",a++):(g=null,0===o&&y('":"')),null!==g&&null!==(b=An())?(58===i.charCodeAt(a)?(m=":",a++):(m=null,0===o&&y('":"')),null!==m&&null!==(w=Cn())?n=[n,c,f,h,d,v,g,b,m,w]:(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k),null===n&&(k=a,null!==(n=An())?(N=a,58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null!==c&&null!==(f=An())?c=[c,f]:(c=null,a=N),null!==(c=null!==c?c:"")?(N=a,58===i.charCodeAt(a)?(f=":",a++):(f=null,0===o&&y('":"')),null!==f&&null!==(h=An())?f=[f,h]:(f=null,a=N),null!==(f=null!==f?f:"")?("::"===i.substr(a,2)?(h="::",a+=2):(h=null,0===o&&y('"::"')),null!==h&&null!==(d=An())?(58===i.charCodeAt(a)?(v=":",a++):(v=null,0===o&&y('":"')),null!==v&&null!==(g=An())?(58===i.charCodeAt(a)?(b=":",a++):(b=null,0===o&&y('":"')),null!==b&&null!==(m=Cn())?n=[n,c,f,h,d,v,g,b,m]:(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k),null===n&&(k=a,null!==(n=An())?(N=a,58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null!==c&&null!==(f=An())?c=[c,f]:(c=null,a=N),null!==(c=null!==c?c:"")?(N=a,58===i.charCodeAt(a)?(f=":",a++):(f=null,0===o&&y('":"')),null!==f&&null!==(h=An())?f=[f,h]:(f=null,a=N),null!==(f=null!==f?f:"")?(N=a,58===i.charCodeAt(a)?(h=":",a++):(h=null,0===o&&y('":"')),null!==h&&null!==(d=An())?h=[h,d]:(h=null,a=N),null!==(h=null!==h?h:"")?("::"===i.substr(a,2)?(d="::",a+=2):(d=null,0===o&&y('"::"')),null!==d&&null!==(v=An())?(58===i.charCodeAt(a)?(g=":",a++):(g=null,0===o&&y('":"')),null!==g&&null!==(b=Cn())?n=[n,c,f,h,d,v,g,b]:(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k),null===n&&(k=a,null!==(n=An())?(N=a,58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null!==c&&null!==(f=An())?c=[c,f]:(c=null,a=N),null!==(c=null!==c?c:"")?(N=a,58===i.charCodeAt(a)?(f=":",a++):(f=null,0===o&&y('":"')),null!==f&&null!==(h=An())?f=[f,h]:(f=null,a=N),null!==(f=null!==f?f:"")?(N=a,58===i.charCodeAt(a)?(h=":",a++):(h=null,0===o&&y('":"')),null!==h&&null!==(d=An())?h=[h,d]:(h=null,a=N),null!==(h=null!==h?h:"")?(N=a,58===i.charCodeAt(a)?(d=":",a++):(d=null,0===o&&y('":"')),null!==d&&null!==(v=An())?d=[d,v]:(d=null,a=N),null!==(d=null!==d?d:"")?("::"===i.substr(a,2)?(v="::",a+=2):(v=null,0===o&&y('"::"')),null!==v&&null!==(g=Cn())?n=[n,c,f,h,d,v,g]:(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k),null===n&&(k=a,null!==(n=An())?(N=a,58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null!==c&&null!==(f=An())?c=[c,f]:(c=null,a=N),null!==(c=null!==c?c:"")?(N=a,58===i.charCodeAt(a)?(f=":",a++):(f=null,0===o&&y('":"')),null!==f&&null!==(h=An())?f=[f,h]:(f=null,a=N),null!==(f=null!==f?f:"")?(N=a,58===i.charCodeAt(a)?(h=":",a++):(h=null,0===o&&y('":"')),null!==h&&null!==(d=An())?h=[h,d]:(h=null,a=N),null!==(h=null!==h?h:"")?(N=a,58===i.charCodeAt(a)?(d=":",a++):(d=null,0===o&&y('":"')),null!==d&&null!==(v=An())?d=[d,v]:(d=null,a=N),null!==(d=null!==d?d:"")?(N=a,58===i.charCodeAt(a)?(v=":",a++):(v=null,0===o&&y('":"')),null!==v&&null!==(g=An())?v=[v,g]:(v=null,a=N),null!==(v=null!==v?v:"")?("::"===i.substr(a,2)?(g="::",a+=2):(g=null,0===o&&y('"::"')),null!==g&&null!==(b=An())?n=[n,c,f,h,d,v,g,b]:(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k),null===n&&(k=a,null!==(n=An())?(N=a,58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null!==c&&null!==(f=An())?c=[c,f]:(c=null,a=N),null!==(c=null!==c?c:"")?(N=a,58===i.charCodeAt(a)?(f=":",a++):(f=null,0===o&&y('":"')),null!==f&&null!==(h=An())?f=[f,h]:(f=null,a=N),null!==(f=null!==f?f:"")?(N=a,58===i.charCodeAt(a)?(h=":",a++):(h=null,0===o&&y('":"')),null!==h&&null!==(d=An())?h=[h,d]:(h=null,a=N),null!==(h=null!==h?h:"")?(N=a,58===i.charCodeAt(a)?(d=":",a++):(d=null,0===o&&y('":"')),null!==d&&null!==(v=An())?d=[d,v]:(d=null,a=N),null!==(d=null!==d?d:"")?(N=a,58===i.charCodeAt(a)?(v=":",a++):(v=null,0===o&&y('":"')),null!==v&&null!==(g=An())?v=[v,g]:(v=null,a=N),null!==(v=null!==v?v:"")?(N=a,58===i.charCodeAt(a)?(g=":",a++):(g=null,0===o&&y('":"')),null!==g&&null!==(b=An())?g=[g,b]:(g=null,a=N),null!==(g=null!==g?g:"")?("::"===i.substr(a,2)?(b="::",a+=2):(b=null,0===o&&y('"::"')),null!==b?n=[n,c,f,h,d,v,g,b]:(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k)):(n=null,a=k))))))))))))))),null!==n&&(R=E,Mc.host_type="IPv6",n=i.substring(a,R)),null===n&&(a=E),n}function An(){var n,i,c,f,h;return h=a,null!==(n=w())&&null!==(i=null!==(i=w())?i:"")&&null!==(c=null!==(c=w())?c:"")&&null!==(f=null!==(f=w())?f:"")?n=[n,i,c,f]:(n=null,a=h),n}function Cn(){var n,c,f,h;return h=a,null!==(n=An())?(58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null!==c&&null!==(f=An())?n=[n,c,f]:(n=null,a=h)):(n=null,a=h),null===n&&(n=Tn()),n}function Tn(){var n,c,f,h,d,v,g,b,m,w;return b=a,m=a,null!==(n=En())?(46===i.charCodeAt(a)?(c=".",a++):(c=null,0===o&&y('"."')),null!==c&&null!==(f=En())?(46===i.charCodeAt(a)?(h=".",a++):(h=null,0===o&&y('"."')),null!==h&&null!==(d=En())?(46===i.charCodeAt(a)?(v=".",a++):(v=null,0===o&&y('"."')),null!==v&&null!==(g=En())?n=[n,c,f,h,d,v,g]:(n=null,a=m)):(n=null,a=m)):(n=null,a=m)):(n=null,a=m),null!==n&&(w=b,Mc.host_type="IPv4",n=i.substring(a,w)),null===n&&(a=b),n}function En(){var n,c,f,h;return h=a,"25"===i.substr(a,2)?(n="25",a+=2):(n=null,0===o&&y('"25"')),null!==n?(/^[0-5]/.test(i.charAt(a))?(c=i.charAt(a),a++):(c=null,0===o&&y("[0-5]")),null!==c?n=[n,c]:(n=null,a=h)):(n=null,a=h),null===n&&(h=a,50===i.charCodeAt(a)?(n="2",a++):(n=null,0===o&&y('"2"')),null!==n?(/^[0-4]/.test(i.charAt(a))?(c=i.charAt(a),a++):(c=null,0===o&&y("[0-4]")),null!==c&&null!==(f=b())?n=[n,c,f]:(n=null,a=h)):(n=null,a=h),null===n&&(h=a,49===i.charCodeAt(a)?(n="1",a++):(n=null,0===o&&y('"1"')),null!==n&&null!==(c=b())&&null!==(f=b())?n=[n,c,f]:(n=null,a=h),null===n&&(h=a,/^[1-9]/.test(i.charAt(a))?(n=i.charAt(a),a++):(n=null,0===o&&y("[1-9]")),null!==n&&null!==(c=b())?n=[n,c]:(n=null,a=h),null===n&&(n=b())))),n}function kn(){var n,i,c,f,h,o,d,v;return o=a,d=a,null!==(n=null!==(n=b())?n:"")&&null!==(i=null!==(i=b())?i:"")&&null!==(c=null!==(c=b())?c:"")&&null!==(f=null!==(f=b())?f:"")&&null!==(h=null!==(h=b())?h:"")?n=[n,i,c,f,h]:(n=null,a=d),null!==n&&(v=n,v=parseInt(v.join("")),Mc.port=v,n=v),null===n&&(a=o),n}function Nn(){var n,c,f,h;for(n=[],h=a,59===i.charCodeAt(a)?(c=";",a++):(c=null,0===o&&y('";"')),null!==c&&null!==(f=Rn())?c=[c,f]:(c=null,a=h);null!==c;)n.push(c),h=a,59===i.charCodeAt(a)?(c=";",a++):(c=null,0===o&&y('";"')),null!==c&&null!==(f=Rn())?c=[c,f]:(c=null,a=h);return n}function Rn(){var n;return null===(n=xn())&&null===(n=On())&&null===(n=Ln())&&null===(n=Hn())&&null===(n=Sn())&&null===(n=jn())&&(n=Bn()),n}function xn(){var n,c,f,h,d;return f=a,h=a,"transport="===i.substr(a,10).toLowerCase()?(n=i.substr(a,10),a+=10):(n=null,0===o&&y('"transport="')),null!==n?("udp"===i.substr(a,3).toLowerCase()?(c=i.substr(a,3),a+=3):(c=null,0===o&&y('"udp"')),null===c&&("tcp"===i.substr(a,3).toLowerCase()?(c=i.substr(a,3),a+=3):(c=null,0===o&&y('"tcp"')),null===c&&("sctp"===i.substr(a,4).toLowerCase()?(c=i.substr(a,4),a+=4):(c=null,0===o&&y('"sctp"')),null===c&&("tls"===i.substr(a,3).toLowerCase()?(c=i.substr(a,3),a+=3):(c=null,0===o&&y('"tls"')),null===c&&(c=Y())))),null!==c?n=[n,c]:(n=null,a=h)):(n=null,a=h),null!==n&&(d=n[1],Mc.uri_params||(Mc.uri_params={}),n=void(Mc.uri_params.transport=d.toLowerCase())),null===n&&(a=f),n}function On(){var n,c,f,h,d;return f=a,h=a,"user="===i.substr(a,5).toLowerCase()?(n=i.substr(a,5),a+=5):(n=null,0===o&&y('"user="')),null!==n?("phone"===i.substr(a,5).toLowerCase()?(c=i.substr(a,5),a+=5):(c=null,0===o&&y('"phone"')),null===c&&("ip"===i.substr(a,2).toLowerCase()?(c=i.substr(a,2),a+=2):(c=null,0===o&&y('"ip"')),null===c&&(c=Y())),null!==c?n=[n,c]:(n=null,a=h)):(n=null,a=h),null!==n&&(d=n[1],Mc.uri_params||(Mc.uri_params={}),n=void(Mc.uri_params.user=d.toLowerCase())),null===n&&(a=f),n}function Ln(){var n,c,f,h,d;return f=a,h=a,"method="===i.substr(a,7).toLowerCase()?(n=i.substr(a,7),a+=7):(n=null,0===o&&y('"method="')),null!==n&&null!==(c=bi())?n=[n,c]:(n=null,a=h),null!==n&&(d=n[1],Mc.uri_params||(Mc.uri_params={}),n=void(Mc.uri_params.method=d)),null===n&&(a=f),n}function Hn(){var n,c,f,h,d;return f=a,h=a,"ttl="===i.substr(a,4).toLowerCase()?(n=i.substr(a,4),a+=4):(n=null,0===o&&y('"ttl="')),null!==n&&null!==(c=Hc())?n=[n,c]:(n=null,a=h),null!==n&&(d=n[1],Mc.params||(Mc.params={}),n=void(Mc.params.ttl=d)),null===n&&(a=f),n}function Sn(){var n,c,f,h,d;return f=a,h=a,"maddr="===i.substr(a,6).toLowerCase()?(n=i.substr(a,6),a+=6):(n=null,0===o&&y('"maddr="')),null!==n&&null!==(c=vn())?n=[n,c]:(n=null,a=h),null!==n&&(d=n[1],Mc.uri_params||(Mc.uri_params={}),n=void(Mc.uri_params.maddr=d)),null===n&&(a=f),n}function jn(){var n,c,f,h,d,v;return h=a,d=a,"lr"===i.substr(a,2).toLowerCase()?(n=i.substr(a,2),a+=2):(n=null,0===o&&y('"lr"')),null!==n?(v=a,61===i.charCodeAt(a)?(c="=",a++):(c=null,0===o&&y('"="')),null!==c&&null!==(f=Y())?c=[c,f]:(c=null,a=v),null!==(c=null!==c?c:"")?n=[n,c]:(n=null,a=d)):(n=null,a=d),null!==n&&(Mc.uri_params||(Mc.uri_params={}),n=void(Mc.uri_params.lr=void 0)),null===n&&(a=h),n}function Bn(){var n,c,f,h,d,v,g,b;return h=a,d=a,null!==(n=Wn())?(v=a,61===i.charCodeAt(a)?(c="=",a++):(c=null,0===o&&y('"="')),null!==c&&null!==(f=Vn())?c=[c,f]:(c=null,a=v),null!==(c=null!==c?c:"")?n=[n,c]:(n=null,a=d)):(n=null,a=d),null!==n&&(g=n[0],b=n[1],Mc.uri_params||(Mc.uri_params={}),b=void 0===b?void 0:b[1],n=void(Mc.uri_params[g.toLowerCase()]=b)),null===n&&(a=h),n}function Wn(){var n,i,c;if(c=a,null!==(i=Kn()))for(n=[];null!==i;)n.push(i),i=Kn();else n=null;return null!==n&&(n=n.join("")),null===n&&(a=c),n}function Vn(){var n,i,c;if(c=a,null!==(i=Kn()))for(n=[];null!==i;)n.push(i),i=Kn();else n=null;return null!==n&&(n=n.join("")),null===n&&(a=c),n}function Kn(){var n;return null===(n=Yn())&&null===(n=x())&&(n=L()),n}function Yn(){var n;return 91===i.charCodeAt(a)?(n="[",a++):(n=null,0===o&&y('"["')),null===n&&(93===i.charCodeAt(a)?(n="]",a++):(n=null,0===o&&y('"]"')),null===n&&(47===i.charCodeAt(a)?(n="/",a++):(n=null,0===o&&y('"/"')),null===n&&(58===i.charCodeAt(a)?(n=":",a++):(n=null,0===o&&y('":"')),null===n&&(38===i.charCodeAt(a)?(n="&",a++):(n=null,0===o&&y('"&"')),null===n&&(43===i.charCodeAt(a)?(n="+",a++):(n=null,0===o&&y('"+"')),null===n&&(36===i.charCodeAt(a)?(n="$",a++):(n=null,0===o&&y('"$"')))))))),n}function Un(){var n,c,f,h,d,v,g;if(v=a,63===i.charCodeAt(a)?(n="?",a++):(n=null,0===o&&y('"?"')),null!==n)if(null!==(c=zn())){for(f=[],g=a,38===i.charCodeAt(a)?(h="&",a++):(h=null,0===o&&y('"&"')),null!==h&&null!==(d=zn())?h=[h,d]:(h=null,a=g);null!==h;)f.push(h),g=a,38===i.charCodeAt(a)?(h="&",a++):(h=null,0===o&&y('"&"')),null!==h&&null!==(d=zn())?h=[h,d]:(h=null,a=g);null!==f?n=[n,c,f]:(n=null,a=v)}else n=null,a=v;else n=null,a=v;return n}function zn(){var n,c,f,h,d,v,g;return h=a,d=a,null!==(n=Xn())?(61===i.charCodeAt(a)?(c="=",a++):(c=null,0===o&&y('"="')),null!==c&&null!==(f=$n())?n=[n,c,f]:(n=null,a=d)):(n=null,a=d),null!==n&&(v=n[0],g=n[2],v=v.join("").toLowerCase(),g=g.join(""),Mc.uri_headers||(Mc.uri_headers={}),n=void(Mc.uri_headers[v]?Mc.uri_headers[v].push(g):Mc.uri_headers[v]=[g])),null===n&&(a=h),n}function Xn(){var n,i;if(null===(i=Jn())&&null===(i=x())&&(i=L()),null!==i)for(n=[];null!==i;)n.push(i),null===(i=Jn())&&null===(i=x())&&(i=L());else n=null;return n}function $n(){var n,i;for(n=[],null===(i=Jn())&&null===(i=x())&&(i=L());null!==i;)n.push(i),null===(i=Jn())&&null===(i=x())&&(i=L());return n}function Jn(){var n;return 91===i.charCodeAt(a)?(n="[",a++):(n=null,0===o&&y('"["')),null===n&&(93===i.charCodeAt(a)?(n="]",a++):(n=null,0===o&&y('"]"')),null===n&&(47===i.charCodeAt(a)?(n="/",a++):(n=null,0===o&&y('"/"')),null===n&&(63===i.charCodeAt(a)?(n="?",a++):(n=null,0===o&&y('"?"')),null===n&&(58===i.charCodeAt(a)?(n=":",a++):(n=null,0===o&&y('":"')),null===n&&(43===i.charCodeAt(a)?(n="+",a++):(n=null,0===o&&y('"+"')),null===n&&(36===i.charCodeAt(a)?(n="$",a++):(n=null,0===o&&y('"$"')))))))),n}function Zn(){var n,i,c,f,h,o;return o=a,null!==(n=bi())&&null!==(i=E())&&null!==(c=Dn())&&null!==(f=E())&&null!==(h=ii())?n=[n,i,c,f,h]:(n=null,a=o),n}function Dn(){var n;return null===(n=r())&&(n=Qn()),n}function Qn(){var n,c,f,h;return h=a,null!==(n=ln())?(58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null!==c?(null===(f=Mn())&&(f=Gn()),null!==f?n=[n,c,f]:(n=null,a=h)):(n=null,a=h)):(n=null,a=h),n}function Mn(){var n,c,f,h,d;return h=a,null===(n=Pn())&&(n=qn()),null!==n?(d=a,63===i.charCodeAt(a)?(c="?",a++):(c=null,0===o&&y('"?"')),null!==c&&null!==(f=ni())?c=[c,f]:(c=null,a=d),null!==(c=null!==c?c:"")?n=[n,c]:(n=null,a=h)):(n=null,a=h),n}function Pn(){var n,c,f,h;return h=a,"//"===i.substr(a,2)?(n="//",a+=2):(n=null,0===o&&y('"//"')),null!==n&&null!==(c=un())&&null!==(f=null!==(f=qn())?f:"")?n=[n,c,f]:(n=null,a=h),n}function qn(){var n,c,f;return f=a,47===i.charCodeAt(a)?(n="/",a++):(n=null,0===o&&y('"/"')),null!==n&&null!==(c=_n())?n=[n,c]:(n=null,a=f),n}function Gn(){var n,i,c,f;if(f=a,null!==(n=In())){for(i=[],c=Fn();null!==c;)i.push(c),c=Fn();null!==i?n=[n,i]:(n=null,a=f)}else n=null,a=f;return n}function Fn(){var n;return null===(n=R())&&null===(n=x())&&(n=L()),n}function In(){var n;return null===(n=x())&&null===(n=L())&&(59===i.charCodeAt(a)?(n=";",a++):(n=null,0===o&&y('";"')),null===n&&(63===i.charCodeAt(a)?(n="?",a++):(n=null,0===o&&y('"?"')),null===n&&(58===i.charCodeAt(a)?(n=":",a++):(n=null,0===o&&y('":"')),null===n&&(64===i.charCodeAt(a)?(n="@",a++):(n=null,0===o&&y('"@"')),null===n&&(38===i.charCodeAt(a)?(n="&",a++):(n=null,0===o&&y('"&"')),null===n&&(61===i.charCodeAt(a)?(n="=",a++):(n=null,0===o&&y('"="')),null===n&&(43===i.charCodeAt(a)?(n="+",a++):(n=null,0===o&&y('"+"')),null===n&&(36===i.charCodeAt(a)?(n="$",a++):(n=null,0===o&&y('"$"')),null===n&&(44===i.charCodeAt(a)?(n=",",a++):(n=null,0===o&&y('","'))))))))))),n}function _n(){var n,c,f,h,d,v;if(d=a,null!==(n=tn())){for(c=[],v=a,47===i.charCodeAt(a)?(f="/",a++):(f=null,0===o&&y('"/"')),null!==f&&null!==(h=tn())?f=[f,h]:(f=null,a=v);null!==f;)c.push(f),v=a,47===i.charCodeAt(a)?(f="/",a++):(f=null,0===o&&y('"/"')),null!==f&&null!==(h=tn())?f=[f,h]:(f=null,a=v);null!==c?n=[n,c]:(n=null,a=d)}else n=null,a=d;return n}function tn(){var n,c,f,h,d,v;for(d=a,n=[],c=en();null!==c;)n.push(c),c=en();if(null!==n){for(c=[],v=a,59===i.charCodeAt(a)?(f=";",a++):(f=null,0===o&&y('";"')),null!==f&&null!==(h=pn())?f=[f,h]:(f=null,a=v);null!==f;)c.push(f),v=a,59===i.charCodeAt(a)?(f=";",a++):(f=null,0===o&&y('";"')),null!==f&&null!==(h=pn())?f=[f,h]:(f=null,a=v);null!==c?n=[n,c]:(n=null,a=d)}else n=null,a=d;return n}function pn(){var n,i;for(n=[],i=en();null!==i;)n.push(i),i=en();return n}function en(){var n;return null===(n=x())&&null===(n=L())&&(58===i.charCodeAt(a)?(n=":",a++):(n=null,0===o&&y('":"')),null===n&&(64===i.charCodeAt(a)?(n="@",a++):(n=null,0===o&&y('"@"')),null===n&&(38===i.charCodeAt(a)?(n="&",a++):(n=null,0===o&&y('"&"')),null===n&&(61===i.charCodeAt(a)?(n="=",a++):(n=null,0===o&&y('"="')),null===n&&(43===i.charCodeAt(a)?(n="+",a++):(n=null,0===o&&y('"+"')),null===n&&(36===i.charCodeAt(a)?(n="$",a++):(n=null,0===o&&y('"$"')),null===n&&(44===i.charCodeAt(a)?(n=",",a++):(n=null,0===o&&y('","'))))))))),n}function ln(){var n,c,f,h,d,v;if(h=a,d=a,null!==(n=m())){for(c=[],null===(f=m())&&null===(f=b())&&(43===i.charCodeAt(a)?(f="+",a++):(f=null,0===o&&y('"+"')),null===f&&(45===i.charCodeAt(a)?(f="-",a++):(f=null,0===o&&y('"-"')),null===f&&(46===i.charCodeAt(a)?(f=".",a++):(f=null,0===o&&y('"."')))));null!==f;)c.push(f),null===(f=m())&&null===(f=b())&&(43===i.charCodeAt(a)?(f="+",a++):(f=null,0===o&&y('"+"')),null===f&&(45===i.charCodeAt(a)?(f="-",a++):(f=null,0===o&&y('"-"')),null===f&&(46===i.charCodeAt(a)?(f=".",a++):(f=null,0===o&&y('"."')))));null!==c?n=[n,c]:(n=null,a=d)}else n=null,a=d;return null!==n&&(v=h,n=void(Mc.scheme=i.substring(a,v))),null===n&&(a=h),n}function un(){var n;return null===(n=rn())&&(n=sn()),n}function rn(){var n,c,f,h;return f=a,h=a,null!==(n=fn())?(64===i.charCodeAt(a)?(c="@",a++):(c=null,0===o&&y('"@"')),null!==c?n=[n,c]:(n=null,a=h)):(n=null,a=h),null!==(n=null!==n?n:"")&&null!==(c=dn())?n=[n,c]:(n=null,a=f),n=null!==n?n:""}function sn(){var n,c;if(null===(c=x())&&null===(c=L())&&(36===i.charCodeAt(a)?(c="$",a++):(c=null,0===o&&y('"$"')),null===c&&(44===i.charCodeAt(a)?(c=",",a++):(c=null,0===o&&y('","')),null===c&&(59===i.charCodeAt(a)?(c=";",a++):(c=null,0===o&&y('";"')),null===c&&(58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null===c&&(64===i.charCodeAt(a)?(c="@",a++):(c=null,0===o&&y('"@"')),null===c&&(38===i.charCodeAt(a)?(c="&",a++):(c=null,0===o&&y('"&"')),null===c&&(61===i.charCodeAt(a)?(c="=",a++):(c=null,0===o&&y('"="')),null===c&&(43===i.charCodeAt(a)?(c="+",a++):(c=null,0===o&&y('"+"')))))))))),null!==c)for(n=[];null!==c;)n.push(c),null===(c=x())&&null===(c=L())&&(36===i.charCodeAt(a)?(c="$",a++):(c=null,0===o&&y('"$"')),null===c&&(44===i.charCodeAt(a)?(c=",",a++):(c=null,0===o&&y('","')),null===c&&(59===i.charCodeAt(a)?(c=";",a++):(c=null,0===o&&y('";"')),null===c&&(58===i.charCodeAt(a)?(c=":",a++):(c=null,0===o&&y('":"')),null===c&&(64===i.charCodeAt(a)?(c="@",a++):(c=null,0===o&&y('"@"')),null===c&&(38===i.charCodeAt(a)?(c="&",a++):(c=null,0===o&&y('"&"')),null===c&&(61===i.charCodeAt(a)?(c="=",a++):(c=null,0===o&&y('"="')),null===c&&(43===i.charCodeAt(a)?(c="+",a++):(c=null,0===o&&y('"+"'))))))))));else n=null;return n}function ni(){var n,i;for(n=[],i=Fn();null!==i;)n.push(i),i=Fn();return n}function ii(){var n,c,f,h,d,v,g,m,w;if(g=a,m=a,"sip"===i.substr(a,3).toLowerCase()?(n=i.substr(a,3),a+=3):(n=null,0===o&&y('"SIP"')),null!==n)if(47===i.charCodeAt(a)?(c="/",a++):(c=null,0===o&&y('"/"')),null!==c){if(null!==(h=b()))for(f=[];null!==h;)f.push(h),h=b();else f=null;if(null!==f)if(46===i.charCodeAt(a)?(h=".",a++):(h=null,0===o&&y('"."')),null!==h){if(null!==(v=b()))for(d=[];null!==v;)d.push(v),v=b();else d=null;null!==d?n=[n,c,f,h,d]:(n=null,a=m)}else n=null,a=m;else n=null,a=m}else n=null,a=m;else n=null,a=m;return null!==n&&(w=g,n=void(Mc.sip_version=i.substring(a,w))),null===n&&(a=g),n}function ci(){var n;return"INVITE"===i.substr(a,6)?(n="INVITE",a+=6):(n=null,0===o&&y('"INVITE"')),n}function fi(){var n;return"ACK"===i.substr(a,3)?(n="ACK",a+=3):(n=null,0===o&&y('"ACK"')),n}function hi(){var n;return"OPTIONS"===i.substr(a,7)?(n="OPTIONS",a+=7):(n=null,0===o&&y('"OPTIONS"')),n}function ai(){var n;return"BYE"===i.substr(a,3)?(n="BYE",a+=3):(n=null,0===o&&y('"BYE"')),n}function oi(){var n;return"CANCEL"===i.substr(a,6)?(n="CANCEL",a+=6):(n=null,0===o&&y('"CANCEL"')),n}function di(){var n;return"REGISTER"===i.substr(a,8)?(n="REGISTER",a+=8):(n=null,0===o&&y('"REGISTER"')),n}function vi(){var n;return"SUBSCRIBE"===i.substr(a,9)?(n="SUBSCRIBE",a+=9):(n=null,0===o&&y('"SUBSCRIBE"')),n}function yi(){var n;return"NOTIFY"===i.substr(a,6)?(n="NOTIFY",a+=6):(n=null,0===o&&y('"NOTIFY"')),n}function gi(){var n;return"REFER"===i.substr(a,5)?(n="REFER",a+=5):(n=null,0===o&&y('"REFER"')),n}function bi(){var n,c,f;return c=a,null===(n=ci())&&null===(n=fi())&&null===(n=hi())&&null===(n=ai())&&null===(n=oi())&&null===(n=di())&&null===(n=vi())&&null===(n=yi())&&null===(n=gi())&&(n=Y()),null!==n&&(f=c,Mc.method=i.substring(a,f),n=Mc.method),null===n&&(a=c),n}function mi(){var n,i,c,f,h,o;return o=a,null!==(n=ii())&&null!==(i=E())&&null!==(c=wi())&&null!==(f=E())&&null!==(h=Ci())?n=[n,i,c,f,h]:(n=null,a=o),n}function wi(){var n,i,c;return i=a,null!==(n=Ai())&&(c=n,n=void(Mc.status_code=parseInt(c.join("")))),null===n&&(a=i),n}function Ai(){var n,i,c,f;return f=a,null!==(n=b())&&null!==(i=b())&&null!==(c=b())?n=[n,i,c]:(n=null,a=f),n}function Ci(){var n,c,f,h;for(f=a,n=[],null===(c=R())&&null===(c=x())&&null===(c=L())&&null===(c=V())&&null===(c=K())&&null===(c=E())&&(c=k());null!==c;)n.push(c),null===(c=R())&&null===(c=x())&&null===(c=L())&&null===(c=V())&&null===(c=K())&&null===(c=E())&&(c=k());return null!==n&&(h=f,n=void(Mc.reason_phrase=i.substring(a,h))),null===n&&(a=f),n}function Ti(){var n,i,c,f,h,o,d;if(h=a,o=a,null===(n=u())&&(n=Ei()),null!==n){for(i=[],d=a,null!==(c=q())&&null!==(f=Ni())?c=[c,f]:(c=null,a=d);null!==c;)i.push(c),d=a,null!==(c=q())&&null!==(f=Ni())?c=[c,f]:(c=null,a=d);null!==i?n=[n,i]:(n=null,a=o)}else n=null,a=o;return null!==n&&(n=function(n){var i;Mc.multi_header||(Mc.multi_header=[]);try{i=new Qc(Mc.uri,Mc.display_name,Mc.params),delete Mc.uri,delete Mc.display_name,delete Mc.params}catch(n){i=null}Mc.multi_header.push({possition:a,offset:n,parsed:i})}(h)),null===n&&(a=h),n}function Ei(){var n,i,c,f,h;return h=a,null!==(n=null!==(n=ki())?n:"")&&null!==(i=M())&&null!==(c=r())&&null!==(f=Q())?n=[n,i,c,f]:(n=null,a=h),n}function ki(){var n,c,f,h,o,d,v,y,g;if(o=a,d=a,null!==(n=Y())){for(c=[],v=a,null!==(f=H())&&null!==(h=Y())?f=[f,h]:(f=null,a=v);null!==f;)c.push(f),v=a,null!==(f=H())&&null!==(h=Y())?f=[f,h]:(f=null,a=v);null!==c?n=[n,c]:(n=null,a=d)}else n=null,a=d;return null===n&&(n=t()),null!==n&&(y=o,g=n,'"'===(g=i.substring(a,y).trim())[0]&&(g=g.substring(1,g.length-1)),n=void(Mc.display_name=g)),null===n&&(a=o),n}function Ni(){var n;return null===(n=Ri())&&null===(n=xi())&&(n=Hi()),n}function Ri(){var n,c,f,h,d,v;return h=a,d=a,"q"===i.substr(a,1).toLowerCase()?(n=i.substr(a,1),a++):(n=null,0===o&&y('"q"')),null!==n&&null!==(c=J())&&null!==(f=Li())?n=[n,c,f]:(n=null,a=d),null!==n&&(v=n[2],Mc.params||(Mc.params={}),n=void(Mc.params.q=v)),null===n&&(a=h),n}function xi(){var n,c,f,h,d,v;return h=a,d=a,"expires"===i.substr(a,7).toLowerCase()?(n=i.substr(a,7),a+=7):(n=null,0===o&&y('"expires"')),null!==n&&null!==(c=J())&&null!==(f=Oi())?n=[n,c,f]:(n=null,a=d),null!==n&&(v=n[2],Mc.params||(Mc.params={}),n=void(Mc.params.expires=v)),null===n&&(a=h),n}function Oi(){var n,i,c;if(c=a,null!==(i=b()))for(n=[];null!==i;)n.push(i),i=b();else n=null;return null!==n&&(n=parseInt(n.join(""))),null===n&&(a=c),n}function Li(){var n,c,f,h,d,v,g,m,w;return v=a,g=a,48===i.charCodeAt(a)?(n="0",a++):(n=null,0===o&&y('"0"')),null!==n?(m=a,46===i.charCodeAt(a)?(c=".",a++):(c=null,0===o&&y('"."')),null!==c&&null!==(f=null!==(f=b())?f:"")&&null!==(h=null!==(h=b())?h:"")&&null!==(d=null!==(d=b())?d:"")?c=[c,f,h,d]:(c=null,a=m),null!==(c=null!==c?c:"")?n=[n,c]:(n=null,a=g)):(n=null,a=g),null!==n&&(w=v,n=parseFloat(i.substring(a,w))),null===n&&(a=v),n}function Hi(){var n,i,c,f,h,o,d,v;return f=a,h=a,null!==(n=Y())?(o=a,null!==(i=J())&&null!==(c=Si())?i=[i,c]:(i=null,a=o),null!==(i=null!==i?i:"")?n=[n,i]:(n=null,a=h)):(n=null,a=h),null!==n&&(d=n[0],v=n[1],Mc.params||(Mc.params={}),v=void 0===v?void 0:v[1],n=void(Mc.params[d.toLowerCase()]=v)),null===n&&(a=f),n}function Si(){var n;return null===(n=Y())&&null===(n=vn())&&(n=t()),n}function ji(){var n;return"render"===i.substr(a,6).toLowerCase()?(n=i.substr(a,6),a+=6):(n=null,0===o&&y('"render"')),null===n&&("session"===i.substr(a,7).toLowerCase()?(n=i.substr(a,7),a+=7):(n=null,0===o&&y('"session"')),null===n&&("icon"===i.substr(a,4).toLowerCase()?(n=i.substr(a,4),a+=4):(n=null,0===o&&y('"icon"')),null===n&&("alert"===i.substr(a,5).toLowerCase()?(n=i.substr(a,5),a+=5):(n=null,0===o&&y('"alert"')),null===n&&(n=Y())))),n}function Bi(){var n;return null===(n=Wi())&&(n=Hi()),n}function Wi(){var n,c,f,h;return h=a,"handling"===i.substr(a,8).toLowerCase()?(n=i.substr(a,8),a+=8):(n=null,0===o&&y('"handling"')),null!==n&&null!==(c=J())?("optional"===i.substr(a,8).toLowerCase()?(f=i.substr(a,8),a+=8):(f=null,0===o&&y('"optional"')),null===f&&("required"===i.substr(a,8).toLowerCase()?(f=i.substr(a,8),a+=8):(f=null,0===o&&y('"required"')),null===f&&(f=Y())),null!==f?n=[n,c,f]:(n=null,a=h)):(n=null,a=h),n}function Vi(){var n,i,c,f,h,o,d,v;if(d=a,null!==(n=Ki()))if(null!==(i=$()))if(null!==(c=$i())){for(f=[],v=a,null!==(h=q())&&null!==(o=Ji())?h=[h,o]:(h=null,a=v);null!==h;)f.push(h),v=a,null!==(h=q())&&null!==(o=Ji())?h=[h,o]:(h=null,a=v);null!==f?n=[n,i,c,f]:(n=null,a=d)}else n=null,a=d;else n=null,a=d;else n=null,a=d;return n}function Ki(){var n;return null===(n=Yi())&&(n=Ui()),n}function Yi(){var n;return"text"===i.substr(a,4).toLowerCase()?(n=i.substr(a,4),a+=4):(n=null,0===o&&y('"text"')),null===n&&("image"===i.substr(a,5).toLowerCase()?(n=i.substr(a,5),a+=5):(n=null,0===o&&y('"image"')),null===n&&("audio"===i.substr(a,5).toLowerCase()?(n=i.substr(a,5),a+=5):(n=null,0===o&&y('"audio"')),null===n&&("video"===i.substr(a,5).toLowerCase()?(n=i.substr(a,5),a+=5):(n=null,0===o&&y('"video"')),null===n&&("application"===i.substr(a,11).toLowerCase()?(n=i.substr(a,11),a+=11):(n=null,0===o&&y('"application"')),null===n&&(n=zi()))))),n}function Ui(){var n;return"message"===i.substr(a,7).toLowerCase()?(n=i.substr(a,7),a+=7):(n=null,0===o&&y('"message"')),null===n&&("multipart"===i.substr(a,9).toLowerCase()?(n=i.substr(a,9),a+=9):(n=null,0===o&&y('"multipart"')),null===n&&(n=zi())),n}function zi(){var n;return null===(n=Y())&&(n=Xi()),n}function Xi(){var n,c,f;return f=a,"x-"===i.substr(a,2).toLowerCase()?(n=i.substr(a,2),a+=2):(n=null,0===o&&y('"x-"')),null!==n&&null!==(c=Y())?n=[n,c]:(n=null,a=f),n}function $i(){var n;return null===(n=zi())&&(n=Y()),n}function Ji(){var n,i,c,f;return f=a,null!==(n=Y())&&null!==(i=J())&&null!==(c=Zi())?n=[n,i,c]:(n=null,a=f),n}function Zi(){var n;return null===(n=Y())&&(n=t()),n}function Di(){var n,i,c,f;if(c=a,null!==(i=b()))for(n=[];null!==i;)n.push(i),i=b();else n=null;return null!==n&&(f=n,n=void(Mc.value=parseInt(f.join("")))),null===n&&(a=c),n}function Qi(){var n,c,f,h,d,v;if(d=a,null!==(n=U())){for(c=[],v=a,46===i.charCodeAt(a)?(f=".",a++):(f=null,0===o&&y('"."')),null!==f&&null!==(h=U())?f=[f,h]:(f=null,a=v);null!==f;)c.push(f),v=a,46===i.charCodeAt(a)?(f=".",a++):(f=null,0===o&&y('"."')),null!==f&&null!==(h=U())?f=[f,h]:(f=null,a=v);null!==c?n=[n,c]:(n=null,a=d)}else n=null,a=d;return n}function Mi(){var n;return null===(n=Pi())&&(n=Hi()),n}function Pi(){var n,c,f,h,d,v;return h=a,d=a,"tag"===i.substr(a,3).toLowerCase()?(n=i.substr(a,3),a+=3):(n=null,0===o&&y('"tag"')),null!==n&&null!==(c=J())&&null!==(f=Y())?n=[n,c,f]:(n=null,a=d),null!==n&&(v=n[2],n=void(Mc.tag=v)),null===n&&(a=h),n}function qi(){var n,c,f,h,d,v,g,b;if(g=a,"digest"===i.substr(a,6).toLowerCase()?(n=i.substr(a,6),a+=6):(n=null,0===o&&y('"Digest"')),null!==n)if(null!==(c=H()))if(null!==(f=Ii())){for(h=[],b=a,null!==(d=P())&&null!==(v=Ii())?d=[d,v]:(d=null,a=b);null!==d;)h.push(d),b=a,null!==(d=P())&&null!==(v=Ii())?d=[d,v]:(d=null,a=b);null!==h?n=[n,c,f,h]:(n=null,a=g)}else n=null,a=g;else n=null,a=g;else n=null,a=g;return null===n&&(n=Gi()),n}function Gi(){var n,i,c,f,h,o,d,v;if(d=a,null!==(n=Y()))if(null!==(i=H()))if(null!==(c=Fi())){for(f=[],v=a,null!==(h=P())&&null!==(o=Fi())?h=[h,o]:(h=null,a=v);null!==h;)f.push(h),v=a,null!==(h=P())&&null!==(o=Fi())?h=[h,o]:(h=null,a=v);null!==f?n=[n,i,c,f]:(n=null,a=d)}else n=null,a=d;else n=null,a=d;else n=null,a=d;return n}function Fi(){var n,i,c,f;return f=a,null!==(n=Y())&&null!==(i=J())?(null===(c=Y())&&(c=t()),null!==c?n=[n,i,c]:(n=null,a=f)):(n=null,a=f),n}function Ii(){var n;return null===(n=_i())&&null===(n=pi())&&null===(n=li())&&null===(n=ri())&&null===(n=si())&&null===(n=nc())&&null===(n=ic())&&(n=Fi()),n}function _i(){var n,c,f,h;return h=a,"realm"===i.substr(a,5).toLowerCase()?(n=i.substr(a,5),a+=5):(n=null,0===o&&y('"realm"')),null!==n&&null!==(c=J())&&null!==(f=ti())?n=[n,c,f]:(n=null,a=h),n}function ti(){var n,i,c;return i=a,null!==(n=p())&&(c=n,n=void(Mc.realm=c)),null===n&&(a=i),n}function pi(){var n,c,f,h,d,v,g,b,m;if(b=a,"domain"===i.substr(a,6).toLowerCase()?(n=i.substr(a,6),a+=6):(n=null,0===o&&y('"domain"')),null!==n)if(null!==(c=J()))if(null!==(f=F()))if(null!==(h=ei())){if(d=[],m=a,null!==(g=E()))for(v=[];null!==g;)v.push(g),g=E();else v=null;for(null!==v&&null!==(g=ei())?v=[v,g]:(v=null,a=m);null!==v;){if(d.push(v),m=a,null!==(g=E()))for(v=[];null!==g;)v.push(g),g=E();else v=null;null!==v&&null!==(g=ei())?v=[v,g]:(v=null,a=m)}null!==d&&null!==(v=I())?n=[n,c,f,h,d,v]:(n=null,a=b)}else n=null,a=b;else n=null,a=b;else n=null,a=b;else n=null,a=b;return n}function ei(){var n;return null===(n=Qn())&&(n=qn()),n}function li(){var n,c,f,h;return h=a,"nonce"===i.substr(a,5).toLowerCase()?(n=i.substr(a,5),a+=5):(n=null,0===o&&y('"nonce"')),null!==n&&null!==(c=J())&&null!==(f=ui())?n=[n,c,f]:(n=null,a=h),n}function ui(){var n,i,c;return i=a,null!==(n=p())&&(c=n,n=void(Mc.nonce=c)),null===n&&(a=i),n}function ri(){var n,c,f,h,d,v;return h=a,d=a,"opaque"===i.substr(a,6).toLowerCase()?(n=i.substr(a,6),a+=6):(n=null,0===o&&y('"opaque"')),null!==n&&null!==(c=J())&&null!==(f=p())?n=[n,c,f]:(n=null,a=d),null!==n&&(v=n[2],n=void(Mc.opaque=v)),null===n&&(a=h),n}function si(){var n,c,f,h,d;return h=a,"stale"===i.substr(a,5).toLowerCase()?(n=i.substr(a,5),a+=5):(n=null,0===o&&y('"stale"')),null!==n&&null!==(c=J())?(d=a,"true"===i.substr(a,4).toLowerCase()?(f=i.substr(a,4),a+=4):(f=null,0===o&&y('"true"')),null!==f&&(f=void(Mc.stale=!0)),null===f&&(a=d),null===f&&(d=a,"false"===i.substr(a,5).toLowerCase()?(f=i.substr(a,5),a+=5):(f=null,0===o&&y('"false"')),null!==f&&(f=void(Mc.stale=!1)),null===f&&(a=d)),null!==f?n=[n,c,f]:(n=null,a=h)):(n=null,a=h),n}function nc(){var n,c,f,h,d,v;return h=a,d=a,"algorithm"===i.substr(a,9).toLowerCase()?(n=i.substr(a,9),a+=9):(n=null,0===o&&y('"algorithm"')),null!==n&&null!==(c=J())?("md5"===i.substr(a,3).toLowerCase()?(f=i.substr(a,3),a+=3):(f=null,0===o&&y('"MD5"')),null===f&&("md5-sess"===i.substr(a,8).toLowerCase()?(f=i.substr(a,8),a+=8):(f=null,0===o&&y('"MD5-sess"')),null===f&&(f=Y())),null!==f?n=[n,c,f]:(n=null,a=d)):(n=null,a=d),null!==n&&(v=n[2],n=void(Mc.algorithm=v.toUpperCase())),null===n&&(a=h),n}function ic(){var n,c,f,h,d,v,g,b,m,w;if(b=a,"qop"===i.substr(a,3).toLowerCase()?(n=i.substr(a,3),a+=3):(n=null,0===o&&y('"qop"')),null!==n)if(null!==(c=J()))if(null!==(f=F())){if(m=a,null!==(h=cc())){for(d=[],w=a,44===i.charCodeAt(a)?(v=",",a++):(v=null,0===o&&y('","')),null!==v&&null!==(g=cc())?v=[v,g]:(v=null,a=w);null!==v;)d.push(v),w=a,44===i.charCodeAt(a)?(v=",",a++):(v=null,0===o&&y('","')),null!==v&&null!==(g=cc())?v=[v,g]:(v=null,a=w);null!==d?h=[h,d]:(h=null,a=m)}else h=null,a=m;null!==h&&null!==(d=I())?n=[n,c,f,h,d]:(n=null,a=b)}else n=null,a=b;else n=null,a=b;else n=null,a=b;return n}function cc(){var n,c,f;return c=a,"auth-int"===i.substr(a,8).toLowerCase()?(n=i.substr(a,8),a+=8):(n=null,0===o&&y('"auth-int"')),null===n&&("auth"===i.substr(a,4).toLowerCase()?(n=i.substr(a,4),a+=4):(n=null,0===o&&y('"auth"')),null===n&&(n=Y())),null!==n&&(f=n,Mc.qop||(Mc.qop=[]),n=void Mc.qop.push(f.toLowerCase())),null===n&&(a=c),n}function fc(){var n,i,c,f,h,o,d;if(h=a,o=a,null!==(n=Ei())){for(i=[],d=a,null!==(c=q())&&null!==(f=Hi())?c=[c,f]:(c=null,a=d);null!==c;)i.push(c),d=a,null!==(c=q())&&null!==(f=Hi())?c=[c,f]:(c=null,a=d);null!==i?n=[n,i]:(n=null,a=o)}else n=null,a=o;return null!==n&&(n=function(n){var i;Mc.multi_header||(Mc.multi_header=[]);try{i=new Qc(Mc.uri,Mc.display_name,Mc.params),delete Mc.uri,delete Mc.display_name,delete Mc.params}catch(n){i=null}Mc.multi_header.push({possition:a,offset:n,parsed:i})}(h)),null===n&&(a=h),n}function hc(){var n;return null===(n=ac())&&(n=Hi()),n}function ac(){var n,c,f,h,d,v,g;if(d=a,v=a,"cause"===i.substr(a,5).toLowerCase()?(n=i.substr(a,5),a+=5):(n=null,0===o&&y('"cause"')),null!==n)if(null!==(c=J())){if(null!==(h=b()))for(f=[];null!==h;)f.push(h),h=b();else f=null;null!==f?n=[n,c,f]:(n=null,a=v)}else n=null,a=v;else n=null,a=v;return null!==n&&(g=n[2],n=void(Mc.cause=parseInt(g.join("")))),null===n&&(a=d),n}function oc(){var n,i,c,f,h,o;if(h=a,null!==(n=Ei())){for(i=[],o=a,null!==(c=q())&&null!==(f=Hi())?c=[c,f]:(c=null,a=o);null!==c;)i.push(c),o=a,null!==(c=q())&&null!==(f=Hi())?c=[c,f]:(c=null,a=o);null!==i?n=[n,i]:(n=null,a=h)}else n=null,a=h;return n}function dc(){var n,c,f;return c=a,"active"===i.substr(a,6).toLowerCase()?(n=i.substr(a,6),a+=6):(n=null,0===o&&y('"active"')),null===n&&("pending"===i.substr(a,7).toLowerCase()?(n=i.substr(a,7),a+=7):(n=null,0===o&&y('"pending"')),null===n&&("terminated"===i.substr(a,10).toLowerCase()?(n=i.substr(a,10),a+=10):(n=null,0===o&&y('"terminated"')),null===n&&(n=Y()))),null!==n&&(f=c,n=void(Mc.state=i.substring(a,f))),null===n&&(a=c),n}function vc(){var n,c,f,h,d,v,g,b;return h=a,d=a,"reason"===i.substr(a,6).toLowerCase()?(n=i.substr(a,6),a+=6):(n=null,0===o&&y('"reason"')),null!==n&&null!==(c=J())&&null!==(f=yc())?n=[n,c,f]:(n=null,a=d),null!==n&&(n=void(void 0!==(v=n[2])&&(Mc.reason=v))),null===n&&(a=h),null===n&&(h=a,d=a,"expires"===i.substr(a,7).toLowerCase()?(n=i.substr(a,7),a+=7):(n=null,0===o&&y('"expires"')),null!==n&&null!==(c=J())&&null!==(f=Oi())?n=[n,c,f]:(n=null,a=d),null!==n&&(n=void(void 0!==(b=n[2])&&(Mc.expires=b))),null===n&&(a=h),null===n&&(h=a,d=a,"retry_after"===i.substr(a,11).toLowerCase()?(n=i.substr(a,11),a+=11):(n=null,0===o&&y('"retry_after"')),null!==n&&null!==(c=J())&&null!==(f=Oi())?n=[n,c,f]:(n=null,a=d),null!==n&&(n=void(void 0!==(g=n[2])&&(Mc.retry_after=g))),null===n&&(a=h),null===n&&(n=Hi()))),n}function yc(){var n;return"deactivated"===i.substr(a,11).toLowerCase()?(n=i.substr(a,11),a+=11):(n=null,0===o&&y('"deactivated"')),null===n&&("probation"===i.substr(a,9).toLowerCase()?(n=i.substr(a,9),a+=9):(n=null,0===o&&y('"probation"')),null===n&&("rejected"===i.substr(a,8).toLowerCase()?(n=i.substr(a,8),a+=8):(n=null,0===o&&y('"rejected"')),null===n&&("timeout"===i.substr(a,7).toLowerCase()?(n=i.substr(a,7),a+=7):(n=null,0===o&&y('"timeout"')),null===n&&("giveup"===i.substr(a,6).toLowerCase()?(n=i.substr(a,6),a+=6):(n=null,0===o&&y('"giveup"')),null===n&&("noresource"===i.substr(a,10).toLowerCase()?(n=i.substr(a,10),a+=10):(n=null,0===o&&y('"noresource"')),null===n&&("invariant"===i.substr(a,9).toLowerCase()?(n=i.substr(a,9),a+=9):(n=null,0===o&&y('"invariant"')),null===n&&(n=Y()))))))),n}function gc(){var n;return null===(n=Pi())&&(n=Hi()),n}function bc(){var n,i,c,f,h,o,d,v;if(d=a,null!==(n=kc()))if(null!==(i=H()))if(null!==(c=xc())){for(f=[],v=a,null!==(h=q())&&null!==(o=mc())?h=[h,o]:(h=null,a=v);null!==h;)f.push(h),v=a,null!==(h=q())&&null!==(o=mc())?h=[h,o]:(h=null,a=v);null!==f?n=[n,i,c,f]:(n=null,a=d)}else n=null,a=d;else n=null,a=d;else n=null,a=d;return n}function mc(){var n;return null===(n=wc())&&null===(n=Ac())&&null===(n=Cc())&&null===(n=Tc())&&null===(n=Ec())&&(n=Hi()),n}function wc(){var n,c,f,h,d,v;return h=a,d=a,"ttl"===i.substr(a,3).toLowerCase()?(n=i.substr(a,3),a+=3):(n=null,0===o&&y('"ttl"')),null!==n&&null!==(c=J())&&null!==(f=Hc())?n=[n,c,f]:(n=null,a=d),null!==n&&(v=n[2],n=void(Mc.ttl=v)),null===n&&(a=h),n}function Ac(){var n,c,f,h,d,v;return h=a,d=a,"maddr"===i.substr(a,5).toLowerCase()?(n=i.substr(a,5),a+=5):(n=null,0===o&&y('"maddr"')),null!==n&&null!==(c=J())&&null!==(f=vn())?n=[n,c,f]:(n=null,a=d),null!==n&&(v=n[2],n=void(Mc.maddr=v)),null===n&&(a=h),n}function Cc(){var n,c,f,h,d,v;return h=a,d=a,"received"===i.substr(a,8).toLowerCase()?(n=i.substr(a,8),a+=8):(n=null,0===o&&y('"received"')),null!==n&&null!==(c=J())?(null===(f=Tn())&&(f=wn()),null!==f?n=[n,c,f]:(n=null,a=d)):(n=null,a=d),null!==n&&(v=n[2],n=void(Mc.received=v)),null===n&&(a=h),n}function Tc(){var n,c,f,h,d,v;return h=a,d=a,"branch"===i.substr(a,6).toLowerCase()?(n=i.substr(a,6),a+=6):(n=null,0===o&&y('"branch"')),null!==n&&null!==(c=J())&&null!==(f=Y())?n=[n,c,f]:(n=null,a=d),null!==n&&(v=n[2],n=void(Mc.branch=v)),null===n&&(a=h),n}function Ec(){var n,c,f,h,d,v,g;if(d=a,v=a,"rport"===i.substr(a,5).toLowerCase()?(n=i.substr(a,5),a+=5):(n=null,0===o&&y('"rport"')),null!==n){if(g=a,null!==(c=J())){for(f=[],h=b();null!==h;)f.push(h),h=b();null!==f?c=[c,f]:(c=null,a=g)}else c=null,a=g;null!==(c=null!==c?c:"")?n=[n,c]:(n=null,a=v)}else n=null,a=v;return null!==n&&(n=void("undefined"!=typeof response_port&&(Mc.rport=response_port.join("")))),null===n&&(a=d),n}function kc(){var n,i,c,f,h,o;return o=a,null!==(n=Nc())&&null!==(i=$())&&null!==(c=Y())&&null!==(f=$())&&null!==(h=Rc())?n=[n,i,c,f,h]:(n=null,a=o),n}function Nc(){var n,c,f;return c=a,"sip"===i.substr(a,3).toLowerCase()?(n=i.substr(a,3),a+=3):(n=null,0===o&&y('"SIP"')),null===n&&(n=Y()),null!==n&&(f=n,n=void(Mc.protocol=f)),null===n&&(a=c),n}function Rc(){var n,c,f;return c=a,"udp"===i.substr(a,3).toLowerCase()?(n=i.substr(a,3),a+=3):(n=null,0===o&&y('"UDP"')),null===n&&("tcp"===i.substr(a,3).toLowerCase()?(n=i.substr(a,3),a+=3):(n=null,0===o&&y('"TCP"')),null===n&&("tls"===i.substr(a,3).toLowerCase()?(n=i.substr(a,3),a+=3):(n=null,0===o&&y('"TLS"')),null===n&&("sctp"===i.substr(a,4).toLowerCase()?(n=i.substr(a,4),a+=4):(n=null,0===o&&y('"SCTP"')),null===n&&(n=Y())))),null!==n&&(f=n,n=void(Mc.transport=f)),null===n&&(a=c),n}function xc(){var n,i,c,f,h;return f=a,null!==(n=Oc())?(h=a,null!==(i=G())&&null!==(c=Lc())?i=[i,c]:(i=null,a=h),null!==(i=null!==i?i:"")?n=[n,i]:(n=null,a=f)):(n=null,a=f),n}function Oc(){var n,c,f;return c=a,null===(n=Tn())&&null===(n=mn())&&(n=yn()),null!==n&&(f=c,n=void(Mc.host=i.substring(a,f))),null===n&&(a=c),n}function Lc(){var n,i,c,f,h,o,d,v;return o=a,d=a,null!==(n=null!==(n=b())?n:"")&&null!==(i=null!==(i=b())?i:"")&&null!==(c=null!==(c=b())?c:"")&&null!==(f=null!==(f=b())?f:"")&&null!==(h=null!==(h=b())?h:"")?n=[n,i,c,f,h]:(n=null,a=d),null!==n&&(v=n,n=void(Mc.port=parseInt(v.join("")))),null===n&&(a=o),n}function Hc(){var n,i,c,f,h;return f=a,h=a,null!==(n=b())&&null!==(i=null!==(i=b())?i:"")&&null!==(c=null!==(c=b())?c:"")?n=[n,i,c]:(n=null,a=h),null!==n&&(n=parseInt(n.join(""))),null===n&&(a=f),n}function Sc(){var n,i,c;return i=a,null!==(n=Oi())&&(c=n,n=void(Mc.expires=c)),null===n&&(a=i),n}function jc(){var n;return null===(n=Bc())&&(n=Hi()),n}function Bc(){var n,c,f,h,d,v;return h=a,d=a,"refresher"===i.substr(a,9).toLowerCase()?(n=i.substr(a,9),a+=9):(n=null,0===o&&y('"refresher"')),null!==n&&null!==(c=J())?("uac"===i.substr(a,3).toLowerCase()?(f=i.substr(a,3),a+=3):(f=null,0===o&&y('"uac"')),null===f&&("uas"===i.substr(a,3).toLowerCase()?(f=i.substr(a,3),a+=3):(f=null,0===o&&y('"uas"'))),null!==f?n=[n,c,f]:(n=null,a=d)):(n=null,a=d),null!==n&&(v=n[2],n=void(Mc.refresher=v.toLowerCase())),null===n&&(a=h),n}function Wc(){var n,i;for(n=[],null===(i=W())&&null===(i=K())&&(i=H());null!==i;)n.push(i),null===(i=W())&&null===(i=K())&&(i=H());return n}function Vc(){var n,c,f,h,d,v,g,b,m,w,A,C;return w=a,A=a,null!==(n=Yc())?(45===i.charCodeAt(a)?(c="-",a++):(c=null,0===o&&y('"-"')),null!==c&&null!==(f=Kc())?(45===i.charCodeAt(a)?(h="-",a++):(h=null,0===o&&y('"-"')),null!==h&&null!==(d=Kc())?(45===i.charCodeAt(a)?(v="-",a++):(v=null,0===o&&y('"-"')),null!==v&&null!==(g=Kc())?(45===i.charCodeAt(a)?(b="-",a++):(b=null,0===o&&y('"-"')),null!==b&&null!==(m=Uc())?n=[n,c,f,h,d,v,g,b,m]:(n=null,a=A)):(n=null,a=A)):(n=null,a=A)):(n=null,a=A)):(n=null,a=A),null!==n&&(C=w,n[0],n=void(Mc=i.substring(a+5,C))),null===n&&(a=w),n}function Kc(){var n,i,c,f,h;return h=a,null!==(n=w())&&null!==(i=w())&&null!==(c=w())&&null!==(f=w())?n=[n,i,c,f]:(n=null,a=h),n}function Yc(){var n,i,c;return c=a,null!==(n=Kc())&&null!==(i=Kc())?n=[n,i]:(n=null,a=c),n}function Uc(){var n,i,c,f;return f=a,null!==(n=Kc())&&null!==(i=Kc())&&null!==(c=Kc())?n=[n,i,c]:(n=null,a=f),n}function zc(){var n,c,f,h,d,v,g;return h=a,d=a,null!==(n=z())?(v=a,64===i.charCodeAt(a)?(c="@",a++):(c=null,0===o&&y('"@"')),null!==c&&null!==(f=z())?c=[c,f]:(c=null,a=v),null!==(c=null!==c?c:"")?n=[n,c]:(n=null,a=d)):(n=null,a=d),null!==n&&(g=h,n=void(Mc.call_id=i.substring(a,g))),null===n&&(a=h),n}function Xc(){var n;return null===(n=$c())&&null===(n=Jc())&&null===(n=Zc())&&(n=Hi()),n}function $c(){var n,c,f,h,d,v;return h=a,d=a,"to-tag"===i.substr(a,6)?(n="to-tag",a+=6):(n=null,0===o&&y('"to-tag"')),null!==n&&null!==(c=J())&&null!==(f=Y())?n=[n,c,f]:(n=null,a=d),null!==n&&(v=n[2],n=void(Mc.to_tag=v)),null===n&&(a=h),n}function Jc(){var n,c,f,h,d,v;return h=a,d=a,"from-tag"===i.substr(a,8)?(n="from-tag",a+=8):(n=null,0===o&&y('"from-tag"')),null!==n&&null!==(c=J())&&null!==(f=Y())?n=[n,c,f]:(n=null,a=d),null!==n&&(v=n[2],n=void(Mc.from_tag=v)),null===n&&(a=h),n}function Zc(){var n,c;return c=a,"early-only"===i.substr(a,10)?(n="early-only",a+=10):(n=null,0===o&&y('"early-only"')),null!==n&&(n=void(Mc.early_only=!0)),null===n&&(a=c),n}var Dc=c(18),Qc=c(43),Mc={};if(null===h[f]()||a!==i.length){var Pc=Math.max(a,d),qc=Pc<i.length?i.charAt(Pc):null,Gc=function(){for(var n=1,c=1,f=!1,h=0;h<Math.max(a,d);h++){var o=i.charAt(h);"\n"===o?(f||n++,c=1,f=!1):"\r"===o||"\u2028"===o||"\u2029"===o?(n++,c=1,f=!0):(c++,f=!1)}return{line:n,column:c}}();return new this.SyntaxError(function(n){n.sort();for(var i=null,c=[],f=0;f<n.length;f++)n[f]!==i&&(c.push(n[f]),i=n[f]);return c}(v),qc,Pc,Gc.line,Gc.column),-1}return Mc},toSource:function(){return this._source},SyntaxError:function(i,c,f,h,a){this.name="SyntaxError",this.expected=i,this.found=c,this.message=function(i,c){var f;switch(i.length){case 0:f="end of input";break;case 1:f=i[0];break;default:f=i.slice(0,i.length-1).join(", ")+" or "+i[i.length-1]}return"Expected "+f+" but "+(c?n(c):"end of input")+" found."}(i,c),this.offset=f,this.line=h,this.column=a}};return i.SyntaxError.prototype=Error.prototype,i}()},function(n,i,c){var f=c(10);n.exports=function(n){if(!f(n))throw TypeError(n+" is not an object!");return n}},function(n,i,c){var f=c(3),h=c(5),a=c(20),o=c(14),d=c(15),v=function(n,i,c){var y,g,b,m=n&v.F,w=n&v.G,A=n&v.S,C=n&v.P,T=n&v.B,E=n&v.W,k=w?h:h[i]||(h[i]={}),N=k.prototype,R=w?f:A?f[i]:(f[i]||{}).prototype;for(y in w&&(c=i),c)(g=!m&&R&&void 0!==R[y])&&d(k,y)||(b=g?R[y]:c[y],k[y]=w&&"function"!=typeof R[y]?c[y]:T&&g?a(b,f):E&&R[y]==b?function(n){var i=function(i,c,f){if(this instanceof n){switch(arguments.length){case 0:return new n;case 1:return new n(i);case 2:return new n(i,c)}return new n(i,c,f)}return n.apply(this,arguments)};return i.prototype=n.prototype,i}(b):C&&"function"==typeof b?a(Function.call,b):b,C&&((k.virtual||(k.virtual={}))[y]=b,n&v.R&&N&&!N[y]&&o(N,y,b)))};v.F=1,v.G=2,v.S=4,v.P=8,v.B=16,v.W=32,v.U=64,v.R=128,n.exports=v},function(n,i,c){var f=c(7),h=c(50),a=c(33),o=Object.defineProperty;i.f=c(11)?Object.defineProperty:function(n,i,c){if(f(n),i=a(i,!0),f(c),h)try{return o(n,i,c)}catch(n){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");return"value"in c&&(n[i]=c.value),n}},function(n,i){n.exports=function(n){return"object"==typeof n?null!==n:"function"==typeof n}},function(n,i,c){n.exports=!c(25)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(n,i){function c(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function f(n){return"function"==typeof n}function h(n){return"object"==typeof n&&null!==n}function a(n){return void 0===n}n.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0,c.defaultMaxListeners=10,c.prototype.setMaxListeners=function(n){if("number"!=typeof n||n<0||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this},c.prototype.emit=function(n){var i,c,o,d,v,y;if(this._events||(this._events={}),"error"===n&&(!this._events.error||h(this._events.error)&&!this._events.error.length)){if((i=arguments[1])instanceof Error)throw i;var g=new Error('Uncaught, unspecified "error" event. ('+i+")");throw g.context=i,g}if(a(c=this._events[n]))return!1;if(f(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:d=Array.prototype.slice.call(arguments,1),c.apply(this,d)}else if(h(c))for(d=Array.prototype.slice.call(arguments,1),o=(y=c.slice()).length,v=0;v<o;v++)y[v].apply(this,d);return!0},c.prototype.addListener=function(n,i){var o;if(!f(i))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",n,f(i.listener)?i.listener:i),this._events[n]?h(this._events[n])?this._events[n].push(i):this._events[n]=[this._events[n],i]:this._events[n]=i,h(this._events[n])&&!this._events[n].warned&&(o=a(this._maxListeners)?c.defaultMaxListeners:this._maxListeners)&&o>0&&this._events[n].length>o&&(this._events[n].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[n].length),"function"==typeof console.trace&&console.trace()),this},c.prototype.on=c.prototype.addListener,c.prototype.once=function(n,i){if(!f(i))throw TypeError("listener must be a function");var c=!1;function h(){this.removeListener(n,h),c||(c=!0,i.apply(this,arguments))}return h.listener=i,this.on(n,h),this},c.prototype.removeListener=function(n,i){var c,a,o,d;if(!f(i))throw TypeError("listener must be a function");if(!this._events||!this._events[n])return this;if(o=(c=this._events[n]).length,a=-1,c===i||f(c.listener)&&c.listener===i)delete this._events[n],this._events.removeListener&&this.emit("removeListener",n,i);else if(h(c)){for(d=o;d-- >0;)if(c[d]===i||c[d].listener&&c[d].listener===i){a=d;break}if(a<0)return this;1===c.length?(c.length=0,delete this._events[n]):c.splice(a,1),this._events.removeListener&&this.emit("removeListener",n,i)}return this},c.prototype.removeAllListeners=function(n){var i,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[n]&&delete this._events[n],this;if(0===arguments.length){for(i in this._events)"removeListener"!==i&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events={},this}if(f(c=this._events[n]))this.removeListener(n,c);else if(c)for(;c.length;)this.removeListener(n,c[c.length-1]);return delete this._events[n],this},c.prototype.listeners=function(n){return this._events&&this._events[n]?f(this._events[n])?[this._events[n]]:this._events[n].slice():[]},c.prototype.listenerCount=function(n){if(this._events){var i=this._events[n];if(f(i))return 1;if(i)return i.length}return 0},c.listenerCount=function(n,i){return n.listenerCount(i)}},function(n,i,c){"use strict";function f(n){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function h(n,i){return!i||"object"!==f(i)&&"function"!=typeof i?function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n):i}function a(n){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function o(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(i&&i.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),i&&d(n,i)}function d(n,i){return(d=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n})(n,i)}function v(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}function y(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}function g(n,i,c){return i&&y(n.prototype,i),c&&y(n,c),n}var b=c(68),m=c(1),w=c(2),A=c(43),C=c(6),T=c(0)("JsSIP:SIPMessage"),E=function(){function n(i,c,f,h,a,o){if(v(this,n),!i||!c||!f)return null;h=h||{},this.ua=f,this.headers={},this.method=i,this.ruri=c,this.body=o,this.extraHeaders=w.cloneArray(a),h.route_set?this.setHeader("route",h.route_set):f.configuration.use_preloaded_route&&this.setHeader("route","<".concat(f.transport.sip_uri,";lr>")),this.setHeader("via",""),this.setHeader("max-forwards",m.MAX_FORWARDS);var d,y=h.to_display_name||0===h.to_display_name?'"'.concat(h.to_display_name,'" '):"";y+="<".concat(h.to_uri||c,">"),y+=h.to_tag?";tag=".concat(h.to_tag):"",this.to=A.parse(y),this.setHeader("to",y),d=h.from_display_name||0===h.from_display_name?'"'.concat(h.from_display_name,'" '):f.configuration.display_name?'"'.concat(f.configuration.display_name,'" '):"",d+="<".concat(h.from_uri||f.configuration.uri,">;tag="),d+=h.from_tag||w.newTag(),this.from=A.parse(d),this.setHeader("from",d);var g=h.call_id||f.configuration.jssip_id+w.createRandomToken(15);this.call_id=g,this.setHeader("call-id",g);var b=h.cseq||Math.floor(1e4*Math.random());this.cseq=b,this.setHeader("cseq","".concat(b," ").concat(i))}return g(n,[{key:"setHeader",value:function(n,i){for(var c=new RegExp("^\\s*".concat(n,"\\s*:"),"i"),f=0;f<this.extraHeaders.length;f++)c.test(this.extraHeaders[f])&&this.extraHeaders.splice(f,1);this.headers[w.headerize(n)]=Array.isArray(i)?i:[i]}},{key:"getHeader",value:function(n){var i=this.headers[w.headerize(n)];if(i){if(i[0])return i[0]}else{var c=new RegExp("^\\s*".concat(n,"\\s*:"),"i"),f=!0,h=!1,a=void 0;try{for(var o,d=this.extraHeaders[Symbol.iterator]();!(f=(o=d.next()).done);f=!0){var v=o.value;if(c.test(v))return v.substring(v.indexOf(":")+1).trim()}}catch(n){h=!0,a=n}finally{try{f||null==d.return||d.return()}finally{if(h)throw a}}}}},{key:"getHeaders",value:function(n){var i=this.headers[w.headerize(n)],c=[];if(i){var f=!0,h=!1,a=void 0;try{for(var o,d=i[Symbol.iterator]();!(f=(o=d.next()).done);f=!0){var v=o.value;c.push(v)}}catch(n){h=!0,a=n}finally{try{f||null==d.return||d.return()}finally{if(h)throw a}}return c}var y=new RegExp("^\\s*".concat(n,"\\s*:"),"i"),g=!0,b=!1,m=void 0;try{for(var A,C=this.extraHeaders[Symbol.iterator]();!(g=(A=C.next()).done);g=!0){var T=A.value;y.test(T)&&c.push(T.substring(T.indexOf(":")+1).trim())}}catch(n){b=!0,m=n}finally{try{g||null==C.return||C.return()}finally{if(b)throw m}}return c}},{key:"hasHeader",value:function(n){if(this.headers[w.headerize(n)])return!0;var i=new RegExp("^\\s*".concat(n,"\\s*:"),"i"),c=!0,f=!1,h=void 0;try{for(var a,o=this.extraHeaders[Symbol.iterator]();!(c=(a=o.next()).done);c=!0){var d=a.value;if(i.test(d))return!0}}catch(n){f=!0,h=n}finally{try{c||null==o.return||o.return()}finally{if(f)throw h}}return!1}},{key:"parseSDP",value:function(n){return!n&&this.sdp?this.sdp:(this.sdp=b.parse(this.body||""),this.sdp)}},{key:"toString",value:function(){var n="".concat(this.method," ").concat(this.ruri," SIP/2.0\r\n");for(var i in this.headers)if(Object.prototype.hasOwnProperty.call(this.headers,i)){var c=!0,f=!1,h=void 0;try{for(var a,o=this.headers[i][Symbol.iterator]();!(c=(a=o.next()).done);c=!0){var d=a.value;n+="".concat(i,": ").concat(d,"\r\n")}}catch(n){f=!0,h=n}finally{try{c||null==o.return||o.return()}finally{if(f)throw h}}}var v=!0,y=!1,g=void 0;try{for(var b,A=this.extraHeaders[Symbol.iterator]();!(v=(b=A.next()).done);v=!0){var C=b.value;n+="".concat(C.trim(),"\r\n")}}catch(n){y=!0,g=n}finally{try{v||null==A.return||A.return()}finally{if(y)throw g}}var T=[];switch(this.method){case m.REGISTER:T.push("path","gruu");break;case m.INVITE:this.ua.configuration.session_timers&&T.push("timer"),(this.ua.contact.pub_gruu||this.ua.contact.temp_gruu)&&T.push("gruu"),T.push("ice","replaces");break;case m.UPDATE:this.ua.configuration.session_timers&&T.push("timer"),T.push("ice")}T.push("outbound");var E=this.ua.configuration.user_agent||m.USER_AGENT;if(n+="Allow: ".concat(m.ALLOWED_METHODS,"\r\n"),n+="Supported: ".concat(T,"\r\n"),n+="User-Agent: ".concat(E,"\r\n"),this.body){var k=w.str_utf8_length(this.body);n+="Content-Length: ".concat(k,"\r\n\r\n"),n+=this.body}else n+="Content-Length: 0\r\n\r\n";return n}},{key:"clone",value:function(){var i=new n(this.method,this.ruri,this.ua);return Object.keys(this.headers).forEach(function(n){i.headers[n]=this.headers[n].slice()},this),i.body=this.body,i.extraHeaders=w.cloneArray(this.extraHeaders),i.to=this.to,i.from=this.from,i.call_id=this.call_id,i.cseq=this.cseq,i}}]),n}(),k=function(n){function i(n,c,f,o,d){var y;return v(this,i),(y=h(this,a(i).call(this,m.INVITE,n,c,f,o,d))).transaction=null,y}return o(i,E),g(i,[{key:"cancel",value:function(n){this.transaction.cancel(n)}},{key:"clone",value:function(){var n=new i(this.ruri,this.ua);return Object.keys(this.headers).forEach(function(i){n.headers[i]=this.headers[i].slice()},this),n.body=this.body,n.extraHeaders=w.cloneArray(this.extraHeaders),n.to=this.to,n.from=this.from,n.call_id=this.call_id,n.cseq=this.cseq,n.transaction=this.transaction,n}}]),i}(),N=function(){function n(){v(this,n),this.data=null,this.headers=null,this.method=null,this.via=null,this.via_branch=null,this.call_id=null,this.cseq=null,this.from=null,this.from_tag=null,this.to=null,this.to_tag=null,this.body=null,this.sdp=null}return g(n,[{key:"addHeader",value:function(n,i){var c={raw:i};n=w.headerize(n),this.headers[n]?this.headers[n].push(c):this.headers[n]=[c]}},{key:"getHeader",value:function(n){var i=this.headers[w.headerize(n)];if(i)return i[0]?i[0].raw:void 0}},{key:"getHeaders",value:function(n){var i=this.headers[w.headerize(n)],c=[];if(!i)return[];var f=!0,h=!1,a=void 0;try{for(var o,d=i[Symbol.iterator]();!(f=(o=d.next()).done);f=!0){var v=o.value;c.push(v.raw)}}catch(n){h=!0,a=n}finally{try{f||null==d.return||d.return()}finally{if(h)throw a}}return c}},{key:"hasHeader",value:function(n){return!!this.headers[w.headerize(n)]}},{key:"parseHeader",value:function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(n=w.headerize(n),this.headers[n]){if(!(i>=this.headers[n].length)){var c=this.headers[n][i],f=c.raw;if(c.parsed)return c.parsed;var h=C.parse(f,n.replace(/-/g,"_"));return-1===h?(this.headers[n].splice(i,1),void T('error parsing "'.concat(n,'" header field with value "').concat(f,'"'))):(c.parsed=h,h)}T('not so many "'.concat(n,'" headers present'))}else T('header "'.concat(n,'" not present'))}},{key:"s",value:function(n,i){return this.parseHeader(n,i)}},{key:"setHeader",value:function(n,i){var c={raw:i};this.headers[w.headerize(n)]=[c]}},{key:"parseSDP",value:function(n){return!n&&this.sdp?this.sdp:(this.sdp=b.parse(this.body||""),this.sdp)}},{key:"toString",value:function(){return this.data}}]),n}(),R=function(n){function i(n){var c;return v(this,i),(c=h(this,a(i).call(this))).ua=n,c.headers={},c.ruri=null,c.transport=null,c.server_transaction=null,c}return o(i,N),g(i,[{key:"reply",value:function(n,i,c,f,h,a){var o=[],d=this.getHeader("To");if(i=i||null,!(n=n||null)||n<100||n>699)throw new TypeError("Invalid status_code: ".concat(n));if(i&&"string"!=typeof i&&!(i instanceof String))throw new TypeError("Invalid reason_phrase: ".concat(i));i=i||m.REASON_PHRASE[n]||"",c=w.cloneArray(c);var v="SIP/2.0 ".concat(n," ").concat(i,"\r\n");if(this.method===m.INVITE&&n>100&&n<=200){var y=this.getHeaders("record-route"),g=!0,b=!1,A=void 0;try{for(var C,T=y[Symbol.iterator]();!(g=(C=T.next()).done);g=!0){var E=C.value;v+="Record-Route: ".concat(E,"\r\n")}}catch(n){b=!0,A=n}finally{try{g||null==T.return||T.return()}finally{if(b)throw A}}}var k=this.getHeaders("via"),N=!0,R=!1,x=void 0;try{for(var O,L=k[Symbol.iterator]();!(N=(O=L.next()).done);N=!0){var H=O.value;v+="Via: ".concat(H,"\r\n")}}catch(n){R=!0,x=n}finally{try{N||null==L.return||L.return()}finally{if(R)throw x}}!this.to_tag&&n>100?d+=";tag=".concat(w.newTag()):this.to_tag&&!this.s("to").hasParam("tag")&&(d+=";tag=".concat(this.to_tag)),v+="To: ".concat(d,"\r\n"),v+="From: ".concat(this.getHeader("From"),"\r\n"),v+="Call-ID: ".concat(this.call_id,"\r\n"),v+="CSeq: ".concat(this.cseq," ").concat(this.method,"\r\n");var S=!0,j=!1,B=void 0;try{for(var W,V=c[Symbol.iterator]();!(S=(W=V.next()).done);S=!0){var K=W.value;v+="".concat(K.trim(),"\r\n")}}catch(n){j=!0,B=n}finally{try{S||null==V.return||V.return()}finally{if(j)throw B}}switch(this.method){case m.INVITE:this.ua.configuration.session_timers&&o.push("timer"),(this.ua.contact.pub_gruu||this.ua.contact.temp_gruu)&&o.push("gruu"),o.push("ice","replaces");break;case m.UPDATE:this.ua.configuration.session_timers&&o.push("timer"),f&&o.push("ice"),o.push("replaces")}if(o.push("outbound"),this.method===m.OPTIONS?(v+="Allow: ".concat(m.ALLOWED_METHODS,"\r\n"),v+="Accept: ".concat(m.ACCEPTED_BODY_TYPES,"\r\n")):405===n?v+="Allow: ".concat(m.ALLOWED_METHODS,"\r\n"):415===n&&(v+="Accept: ".concat(m.ACCEPTED_BODY_TYPES,"\r\n")),v+="Supported: ".concat(o,"\r\n"),f){var Y=w.str_utf8_length(f);v+="Content-Type: application/sdp\r\n",v+="Content-Length: ".concat(Y,"\r\n\r\n"),v+=f}else v+="Content-Length: ".concat(0,"\r\n\r\n");this.server_transaction.receiveResponse(n,v,h,a)}},{key:"reply_sl",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=this.getHeaders("via");if(!n||n<100||n>699)throw new TypeError("Invalid status_code: ".concat(n));if(i&&"string"!=typeof i&&!(i instanceof String))throw new TypeError("Invalid reason_phrase: ".concat(i));i=i||m.REASON_PHRASE[n]||"";var f="SIP/2.0 ".concat(n," ").concat(i,"\r\n"),h=!0,a=!1,o=void 0;try{for(var d,v=c[Symbol.iterator]();!(h=(d=v.next()).done);h=!0){var y=d.value;f+="Via: ".concat(y,"\r\n")}}catch(n){a=!0,o=n}finally{try{h||null==v.return||v.return()}finally{if(a)throw o}}var g=this.getHeader("To");!this.to_tag&&n>100?g+=";tag=".concat(w.newTag()):this.to_tag&&!this.s("to").hasParam("tag")&&(g+=";tag=".concat(this.to_tag)),f+="To: ".concat(g,"\r\n"),f+="From: ".concat(this.getHeader("From"),"\r\n"),f+="Call-ID: ".concat(this.call_id,"\r\n"),f+="CSeq: ".concat(this.cseq," ").concat(this.method,"\r\n"),f+="Content-Length: ".concat(0,"\r\n\r\n"),this.transport.send(f)}}]),i}(),x=function(n){function i(){var n;return v(this,i),(n=h(this,a(i).call(this))).headers={},n.status_code=null,n.reason_phrase=null,n}return o(i,N),i}();n.exports={OutgoingRequest:E,InitialOutgoingInviteRequest:k,IncomingRequest:R,IncomingResponse:x}},function(n,i,c){var f=c(9),h=c(26);n.exports=c(11)?function(n,i,c){return f.f(n,i,h(1,c))}:function(n,i,c){return n[i]=c,n}},function(n,i){var c={}.hasOwnProperty;n.exports=function(n,i){return c.call(n,i)}},function(n,i,c){"use strict";function f(n){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function h(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}function a(n,i){return!i||"object"!==f(i)&&"function"!=typeof i?function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n):i}function o(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(i&&i.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),i&&y(n,i)}function d(n){var i="function"==typeof Map?new Map:void 0;return(d=function(n){if(null===n||(c=n,-1===Function.toString.call(c).indexOf("[native code]")))return n;var c;if("function"!=typeof n)throw new TypeError("Super expression must either be null or a function");if(void 0!==i){if(i.has(n))return i.get(n);i.set(n,f)}function f(){return v(n,arguments,g(this).constructor)}return f.prototype=Object.create(n.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),y(f,n)})(n)}function v(n,i,c){return(v=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}()?Reflect.construct:function(n,i,c){var f=[null];f.push.apply(f,i);var h=new(Function.bind.apply(n,f));return c&&y(h,c.prototype),h}).apply(null,arguments)}function y(n,i){return(y=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n})(n,i)}function g(n){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}var b=function(n){function i(n,c){var f;return h(this,i),(f=a(this,g(i).call(this))).code=1,f.name="CONFIGURATION_ERROR",f.parameter=n,f.value=c,f.message=f.value?"Invalid value ".concat(JSON.stringify(f.value),' for parameter "').concat(f.parameter,'"'):"Missing parameter: ".concat(f.parameter),f}return o(i,d(Error)),i}(),m=function(n){function i(n){var c;return h(this,i),(c=a(this,g(i).call(this))).code=2,c.name="INVALID_STATE_ERROR",c.status=n,c.message="Invalid status: ".concat(n),c}return o(i,d(Error)),i}(),w=function(n){function i(n){var c;return h(this,i),(c=a(this,g(i).call(this))).code=3,c.name="NOT_SUPPORTED_ERROR",c.message=n,c}return o(i,d(Error)),i}(),A=function(n){function i(n){var c;return h(this,i),(c=a(this,g(i).call(this))).code=4,c.name="NOT_READY_ERROR",c.message=n,c}return o(i,d(Error)),i}();n.exports={ConfigurationError:b,InvalidStateError:m,NotSupportedError:w,NotReadyError:A}},function(n,i,c){var f=c(81),h=c(31);n.exports=function(n){return f(h(n))}},function(n,i,c){"use strict";function f(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}function h(n,i,c){return i&&f(n.prototype,i),c&&f(n,c),n}var a=c(1),o=c(2),d=c(6);n.exports=function(){function n(i,c,f,h){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};if(function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}(this,n),!f)throw new TypeError('missing or invalid "host" parameter');for(var v in this._parameters={},this._headers={},this._scheme=i||a.SIP,this._user=c,this._host=f,this._port=h,o)Object.prototype.hasOwnProperty.call(o,v)&&this.setParam(v,o[v]);for(var y in d)Object.prototype.hasOwnProperty.call(d,y)&&this.setHeader(y,d[y])}return h(n,null,[{key:"parse",value:function(n){return-1!==(n=d.parse(n,"SIP_URI"))?n:void 0}}]),h(n,[{key:"setParam",value:function(n,i){n&&(this._parameters[n.toLowerCase()]=null==i?null:i.toString())}},{key:"getParam",value:function(n){if(n)return this._parameters[n.toLowerCase()]}},{key:"hasParam",value:function(n){if(n)return!!this._parameters.hasOwnProperty(n.toLowerCase())}},{key:"deleteParam",value:function(n){if(n=n.toLowerCase(),this._parameters.hasOwnProperty(n)){var i=this._parameters[n];return delete this._parameters[n],i}}},{key:"clearParams",value:function(){this._parameters={}}},{key:"setHeader",value:function(n,i){this._headers[o.headerize(n)]=Array.isArray(i)?i:[i]}},{key:"getHeader",value:function(n){if(n)return this._headers[o.headerize(n)]}},{key:"hasHeader",value:function(n){if(n)return!!this._headers.hasOwnProperty(o.headerize(n))}},{key:"deleteHeader",value:function(n){if(n=o.headerize(n),this._headers.hasOwnProperty(n)){var i=this._headers[n];return delete this._headers[n],i}}},{key:"clearHeaders",value:function(){this._headers={}}},{key:"clone",value:function(){return new n(this._scheme,this._user,this._host,this._port,JSON.parse(JSON.stringify(this._parameters)),JSON.parse(JSON.stringify(this._headers)))}},{key:"toString",value:function(){var n=[],i="".concat(this._scheme,":");for(var c in this._user&&(i+="".concat(o.escapeUser(this._user),"@")),i+=this._host,(this._port||0===this._port)&&(i+=":".concat(this._port)),this._parameters)Object.prototype.hasOwnProperty.call(this._parameters,c)&&(i+=";".concat(c),null!==this._parameters[c]&&(i+="=".concat(this._parameters[c])));for(var f in this._headers)if(Object.prototype.hasOwnProperty.call(this._headers,f)){var h=!0,a=!1,d=void 0;try{for(var v,y=this._headers[f][Symbol.iterator]();!(h=(v=y.next()).done);h=!0){var g=v.value;n.push("".concat(f,"=").concat(g))}}catch(n){a=!0,d=n}finally{try{h||null==y.return||y.return()}finally{if(a)throw d}}}return n.length>0&&(i+="?".concat(n.join("&"))),i}},{key:"toAor",value:function(n){var i="".concat(this._scheme,":");return this._user&&(i+="".concat(o.escapeUser(this._user),"@")),i+=this._host,n&&(this._port||0===this._port)&&(i+=":".concat(this._port)),i}},{key:"scheme",get:function(){return this._scheme},set:function(n){this._scheme=n.toLowerCase()}},{key:"user",get:function(){return this._user},set:function(n){this._user=n}},{key:"host",get:function(){return this._host},set:function(n){this._host=n.toLowerCase()}},{key:"port",get:function(){return this._port},set:function(n){this._port=0===n?n:parseInt(n,10)||null}}]),n}()},function(n,i){n.exports=!0},function(n,i,c){var f=c(24);n.exports=function(n,i,c){if(f(n),void 0===i)return n;switch(c){case 1:return function(c){return n.call(i,c)};case 2:return function(c,f){return n.call(i,c,f)};case 3:return function(c,f,h){return n.call(i,c,f,h)}}return function(){return n.apply(i,arguments)}}},function(n,i){n.exports={}},function(n,i){var c={}.toString;n.exports=function(n){return c.call(n).slice(8,-1)}},function(n,i,c){"use strict";function f(n){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function h(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}function a(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}function o(n,i,c){return i&&a(n.prototype,i),c&&a(n,c),n}function d(n,i){return!i||"object"!==f(i)&&"function"!=typeof i?b(n):i}function v(n){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function y(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(i&&i.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),i&&g(n,i)}function g(n,i){return(g=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n})(n,i)}function b(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}var m=c(12).EventEmitter,w=c(1),A=c(13),C=c(70),T=c(0)("JsSIP:NonInviteClientTransaction"),E=c(0)("JsSIP:InviteClientTransaction"),k=c(0)("JsSIP:AckClientTransaction"),N=c(0)("JsSIP:NonInviteServerTransaction"),R=c(0)("JsSIP:InviteServerTransaction"),x={STATUS_TRYING:1,STATUS_PROCEEDING:2,STATUS_CALLING:3,STATUS_ACCEPTED:4,STATUS_COMPLETED:5,STATUS_TERMINATED:6,STATUS_CONFIRMED:7,NON_INVITE_CLIENT:"nict",NON_INVITE_SERVER:"nist",INVITE_CLIENT:"ict",INVITE_SERVER:"ist"},O=function(n){function i(n,c,f,a){var o;h(this,i),(o=d(this,v(i).call(this))).type=x.NON_INVITE_CLIENT,o.id="z9hG4bK".concat(Math.floor(1e7*Math.random())),o.ua=n,o.transport=c,o.request=f,o.eventHandlers=a;var y="SIP/2.0/".concat(c.via_transport);return y+=" ".concat(n.configuration.via_host,";branch=").concat(o.id),o.request.setHeader("via",y),o.ua.newTransaction(b(b(o))),o}return y(i,m),o(i,[{key:"stateChanged",value:function(n){this.state=n,this.emit("stateChanged")}},{key:"send",value:function(){var n=this;this.stateChanged(x.STATUS_TRYING),this.F=setTimeout(function(){n.timer_F()},C.TIMER_F),this.transport.send(this.request)||this.onTransportError()}},{key:"onTransportError",value:function(){T("transport error occurred, deleting transaction ".concat(this.id)),clearTimeout(this.F),clearTimeout(this.K),this.stateChanged(x.STATUS_TERMINATED),this.ua.destroyTransaction(this),this.eventHandlers.onTransportError()}},{key:"timer_F",value:function(){T("Timer F expired for transaction ".concat(this.id)),this.stateChanged(x.STATUS_TERMINATED),this.ua.destroyTransaction(this),this.eventHandlers.onRequestTimeout()}},{key:"timer_K",value:function(){this.stateChanged(x.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"receiveResponse",value:function(n){var i=this,c=n.status_code;if(c<200)switch(this.state){case x.STATUS_TRYING:case x.STATUS_PROCEEDING:this.stateChanged(x.STATUS_PROCEEDING),this.eventHandlers.onReceiveResponse(n)}else switch(this.state){case x.STATUS_TRYING:case x.STATUS_PROCEEDING:this.stateChanged(x.STATUS_COMPLETED),clearTimeout(this.F),408===c?this.eventHandlers.onRequestTimeout():this.eventHandlers.onReceiveResponse(n),this.K=setTimeout(function(){i.timer_K()},C.TIMER_K);break;case x.STATUS_COMPLETED:}}},{key:"C",get:function(){return x}}]),i}(),L=function(n){function i(n,c,f,a){var o;h(this,i),(o=d(this,v(i).call(this))).type=x.INVITE_CLIENT,o.id="z9hG4bK".concat(Math.floor(1e7*Math.random())),o.ua=n,o.transport=c,o.request=f,o.eventHandlers=a,f.transaction=b(b(o));var y="SIP/2.0/".concat(c.via_transport);return y+=" ".concat(n.configuration.via_host,";branch=").concat(o.id),o.request.setHeader("via",y),o.ua.newTransaction(b(b(o))),o}return y(i,m),o(i,[{key:"stateChanged",value:function(n){this.state=n,this.emit("stateChanged")}},{key:"send",value:function(){var n=this;this.stateChanged(x.STATUS_CALLING),this.B=setTimeout(function(){n.timer_B()},C.TIMER_B),this.transport.send(this.request)||this.onTransportError()}},{key:"onTransportError",value:function(){clearTimeout(this.B),clearTimeout(this.D),clearTimeout(this.M),this.state!==x.STATUS_ACCEPTED&&(E("transport error occurred, deleting transaction ".concat(this.id)),this.eventHandlers.onTransportError()),this.stateChanged(x.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"timer_M",value:function(){E("Timer M expired for transaction ".concat(this.id)),this.state===x.STATUS_ACCEPTED&&(clearTimeout(this.B),this.stateChanged(x.STATUS_TERMINATED),this.ua.destroyTransaction(this))}},{key:"timer_B",value:function(){E("Timer B expired for transaction ".concat(this.id)),this.state===x.STATUS_CALLING&&(this.stateChanged(x.STATUS_TERMINATED),this.ua.destroyTransaction(this),this.eventHandlers.onRequestTimeout())}},{key:"timer_D",value:function(){E("Timer D expired for transaction ".concat(this.id)),clearTimeout(this.B),this.stateChanged(x.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"sendACK",value:function(n){var i=this,c=new A.OutgoingRequest(w.ACK,this.request.ruri,this.ua,{route_set:this.request.getHeaders("route"),call_id:this.request.getHeader("call-id"),cseq:this.request.cseq});c.setHeader("from",this.request.getHeader("from")),c.setHeader("via",this.request.getHeader("via")),c.setHeader("to",n.getHeader("to")),this.D=setTimeout(function(){i.timer_D()},C.TIMER_D),this.transport.send(c)}},{key:"cancel",value:function(n){if(this.state===x.STATUS_PROCEEDING){var i=new A.OutgoingRequest(w.CANCEL,this.request.ruri,this.ua,{route_set:this.request.getHeaders("route"),call_id:this.request.getHeader("call-id"),cseq:this.request.cseq});i.setHeader("from",this.request.getHeader("from")),i.setHeader("via",this.request.getHeader("via")),i.setHeader("to",this.request.getHeader("to")),n&&i.setHeader("reason",n),this.transport.send(i)}}},{key:"receiveResponse",value:function(n){var i=this,c=n.status_code;if(c>=100&&c<=199)switch(this.state){case x.STATUS_CALLING:this.stateChanged(x.STATUS_PROCEEDING),this.eventHandlers.onReceiveResponse(n);break;case x.STATUS_PROCEEDING:this.eventHandlers.onReceiveResponse(n)}else if(c>=200&&c<=299)switch(this.state){case x.STATUS_CALLING:case x.STATUS_PROCEEDING:this.stateChanged(x.STATUS_ACCEPTED),this.M=setTimeout(function(){i.timer_M()},C.TIMER_M),this.eventHandlers.onReceiveResponse(n);break;case x.STATUS_ACCEPTED:this.eventHandlers.onReceiveResponse(n)}else if(c>=300&&c<=699)switch(this.state){case x.STATUS_CALLING:case x.STATUS_PROCEEDING:this.stateChanged(x.STATUS_COMPLETED),this.sendACK(n),this.eventHandlers.onReceiveResponse(n);break;case x.STATUS_COMPLETED:this.sendACK(n)}}},{key:"C",get:function(){return x}}]),i}(),H=function(n){function i(n,c,f,a){var o;h(this,i),(o=d(this,v(i).call(this))).id="z9hG4bK".concat(Math.floor(1e7*Math.random())),o.transport=c,o.request=f,o.eventHandlers=a;var y="SIP/2.0/".concat(c.via_transport);return y+=" ".concat(n.configuration.via_host,";branch=").concat(o.id),o.request.setHeader("via",y),o}return y(i,m),o(i,[{key:"send",value:function(){this.transport.send(this.request)||this.onTransportError()}},{key:"onTransportError",value:function(){k("transport error occurred for transaction ".concat(this.id)),this.eventHandlers.onTransportError()}},{key:"C",get:function(){return x}}]),i}(),S=function(n){function i(n,c,f){var a;return h(this,i),(a=d(this,v(i).call(this))).type=x.NON_INVITE_SERVER,a.id=f.via_branch,a.ua=n,a.transport=c,a.request=f,a.last_response="",f.server_transaction=b(b(a)),a.state=x.STATUS_TRYING,n.newTransaction(b(b(a))),a}return y(i,m),o(i,[{key:"stateChanged",value:function(n){this.state=n,this.emit("stateChanged")}},{key:"timer_J",value:function(){N("Timer J expired for transaction ".concat(this.id)),this.stateChanged(x.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"onTransportError",value:function(){this.transportError||(this.transportError=!0,N("transport error occurred, deleting transaction ".concat(this.id)),clearTimeout(this.J),this.stateChanged(x.STATUS_TERMINATED),this.ua.destroyTransaction(this))}},{key:"receiveResponse",value:function(n,i,c,f){var h=this;if(100===n)switch(this.state){case x.STATUS_TRYING:this.stateChanged(x.STATUS_PROCEEDING),this.transport.send(i)||this.onTransportError();break;case x.STATUS_PROCEEDING:this.last_response=i,this.transport.send(i)?c&&c():(this.onTransportError(),f&&f())}else if(n>=200&&n<=699)switch(this.state){case x.STATUS_TRYING:case x.STATUS_PROCEEDING:this.stateChanged(x.STATUS_COMPLETED),this.last_response=i,this.J=setTimeout(function(){h.timer_J()},C.TIMER_J),this.transport.send(i)?c&&c():(this.onTransportError(),f&&f());break;case x.STATUS_COMPLETED:}}},{key:"C",get:function(){return x}}]),i}(),j=function(n){function i(n,c,f){var a;return h(this,i),(a=d(this,v(i).call(this))).type=x.INVITE_SERVER,a.id=f.via_branch,a.ua=n,a.transport=c,a.request=f,a.last_response="",f.server_transaction=b(b(a)),a.state=x.STATUS_PROCEEDING,n.newTransaction(b(b(a))),a.resendProvisionalTimer=null,f.reply(100),a}return y(i,m),o(i,[{key:"stateChanged",value:function(n){this.state=n,this.emit("stateChanged")}},{key:"timer_H",value:function(){R("Timer H expired for transaction ".concat(this.id)),this.state===x.STATUS_COMPLETED&&R("ACK not received, dialog will be terminated"),this.stateChanged(x.STATUS_TERMINATED),this.ua.destroyTransaction(this)}},{key:"timer_I",value:function(){this.stateChanged(x.STATUS_TERMINATED)}},{key:"timer_L",value:function(){R("Timer L expired for transaction ".concat(this.id)),this.state===x.STATUS_ACCEPTED&&(this.stateChanged(x.STATUS_TERMINATED),this.ua.destroyTransaction(this))}},{key:"onTransportError",value:function(){this.transportError||(this.transportError=!0,R("transport error occurred, deleting transaction ".concat(this.id)),null!==this.resendProvisionalTimer&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null),clearTimeout(this.L),clearTimeout(this.H),clearTimeout(this.I),this.stateChanged(x.STATUS_TERMINATED),this.ua.destroyTransaction(this))}},{key:"resend_provisional",value:function(){this.transport.send(this.last_response)||this.onTransportError()}},{key:"receiveResponse",value:function(n,i,c,f){var h=this;if(n>=100&&n<=199)switch(this.state){case x.STATUS_PROCEEDING:this.transport.send(i)||this.onTransportError(),this.last_response=i}if(n>100&&n<=199&&this.state===x.STATUS_PROCEEDING)null===this.resendProvisionalTimer&&(this.resendProvisionalTimer=setInterval(function(){h.resend_provisional()},C.PROVISIONAL_RESPONSE_INTERVAL));else if(n>=200&&n<=299)switch(this.state){case x.STATUS_PROCEEDING:this.stateChanged(x.STATUS_ACCEPTED),this.last_response=i,this.L=setTimeout(function(){h.timer_L()},C.TIMER_L),null!==this.resendProvisionalTimer&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null);case x.STATUS_ACCEPTED:this.transport.send(i)?c&&c():(this.onTransportError(),f&&f())}else if(n>=300&&n<=699)switch(this.state){case x.STATUS_PROCEEDING:null!==this.resendProvisionalTimer&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null),this.transport.send(i)?(this.stateChanged(x.STATUS_COMPLETED),this.H=setTimeout(function(){h.timer_H()},C.TIMER_H),c&&c()):(this.onTransportError(),f&&f())}}},{key:"C",get:function(){return x}}]),i}();n.exports={C:x,NonInviteClientTransaction:O,InviteClientTransaction:L,AckClientTransaction:H,NonInviteServerTransaction:S,InviteServerTransaction:j,checkTransaction:function(n,i){var c,f=n._transactions;switch(i.method){case w.INVITE:if(c=f.ist[i.via_branch]){switch(c.state){case x.STATUS_PROCEEDING:c.transport.send(c.last_response);break;case x.STATUS_ACCEPTED:}return!0}break;case w.ACK:if(!(c=f.ist[i.via_branch]))return!1;if(c.state===x.STATUS_ACCEPTED)return!1;if(c.state===x.STATUS_COMPLETED)return c.state=x.STATUS_CONFIRMED,c.I=setTimeout(function(){c.timer_I()},C.TIMER_I),!0;break;case w.CANCEL:return(c=f.ist[i.via_branch])?(i.reply_sl(200),c.state!==x.STATUS_PROCEEDING):(i.reply_sl(481),!0);default:if(c=f.nist[i.via_branch]){switch(c.state){case x.STATUS_TRYING:break;case x.STATUS_PROCEEDING:case x.STATUS_COMPLETED:c.transport.send(c.last_response)}return!0}}}}},function(n,i){n.exports=function(n){if("function"!=typeof n)throw TypeError(n+" is not a function!");return n}},function(n,i){n.exports=function(n){try{return!!n()}catch(n){return!0}}},function(n,i){n.exports=function(n,i){return{enumerable:!(1&n),configurable:!(2&n),writable:!(4&n),value:i}}},function(n,i){var c=0,f=Math.random();n.exports=function(n){return"Symbol(".concat(void 0===n?"":n,")_",(++c+f).toString(36))}},function(n,i,c){var f=c(9).f,h=c(15),a=c(4)("toStringTag");n.exports=function(n,i,c){n&&!h(n=c?n:n.prototype,a)&&f(n,a,{configurable:!0,value:i})}},function(n,i,c){"use strict";function f(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}var h=c(1),a=c(134),o=c(23),d=c(0)("JsSIP:RequestSender"),v={onRequestTimeout:function(){},onTransportError:function(){},onReceiveResponse:function(){},onAuthenticated:function(){}};n.exports=function(){function n(i,c,f){for(var a in function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}(this,n),this._ua=i,this._eventHandlers=f,this._method=c.method,this._request=c,this._auth=null,this._challenged=!1,this._staled=!1,v)Object.prototype.hasOwnProperty.call(v,a)&&(this._eventHandlers[a]||(this._eventHandlers[a]=v[a]));i.status!==i.C.STATUS_USER_CLOSED||this._method===h.BYE&&this._method===h.ACK||this._eventHandlers.onTransportError()}var i,c,y;return i=n,(c=[{key:"send",value:function(){var n=this,i={onRequestTimeout:function(){n._eventHandlers.onRequestTimeout()},onTransportError:function(){n._eventHandlers.onTransportError()},onReceiveResponse:function(i){n._receiveResponse(i)}};switch(this._method){case"INVITE":this.clientTransaction=new o.InviteClientTransaction(this._ua,this._ua.transport,this._request,i);break;case"ACK":this.clientTransaction=new o.AckClientTransaction(this._ua,this._ua.transport,this._request,i);break;default:this.clientTransaction=new o.NonInviteClientTransaction(this._ua,this._ua.transport,this._request,i)}this.clientTransaction.send()}},{key:"_receiveResponse",value:function(n){var i,c,f=n.status_code;if(401!==f&&407!==f||null===this._ua.configuration.password&&null===this._ua.configuration.ha1)this._eventHandlers.onReceiveResponse(n);else{if(401===n.status_code?(i=n.parseHeader("www-authenticate"),c="authorization"):(i=n.parseHeader("proxy-authenticate"),c="proxy-authorization"),!i)return d("".concat(n.status_code," with wrong or missing challenge, cannot authenticate")),void this._eventHandlers.onReceiveResponse(n);if(!this._challenged||!this._staled&&!0===i.stale){if(this._auth||(this._auth=new a({username:this._ua.configuration.authorization_user,password:this._ua.configuration.password,realm:this._ua.configuration.realm,ha1:this._ua.configuration.ha1})),!this._auth.authenticate(this._request,i))return void this._eventHandlers.onReceiveResponse(n);this._challenged=!0,this._ua.set("realm",this._auth.get("realm")),this._ua.set("ha1",this._auth.get("ha1")),i.stale&&(this._staled=!0),this._request=this._request.clone(),this._request.cseq+=1,this._request.setHeader("cseq","".concat(this._request.cseq," ").concat(this._method)),this._request.setHeader(c,this._auth.toString()),this._eventHandlers.onAuthenticated(this._request),this.send()}else this._eventHandlers.onReceiveResponse(n)}}}])&&f(i.prototype,c),y&&f(i,y),n}()},function(n,i){var c=Math.ceil,f=Math.floor;n.exports=function(n){return isNaN(n=+n)?0:(n>0?f:c)(n)}},function(n,i){n.exports=function(n){if(null==n)throw TypeError("Can't call method on  "+n);return n}},function(n,i,c){var f=c(10),h=c(3).document,a=f(h)&&f(h.createElement);n.exports=function(n){return a?h.createElement(n):{}}},function(n,i,c){var f=c(10);n.exports=function(n,i){if(!f(n))return n;var c,h;if(i&&"function"==typeof(c=n.toString)&&!f(h=c.call(n)))return h;if("function"==typeof(c=n.valueOf)&&!f(h=c.call(n)))return h;if(!i&&"function"==typeof(c=n.toString)&&!f(h=c.call(n)))return h;throw TypeError("Can't convert object to primitive value")}},function(n,i,c){var f=c(7),h=c(80),a=c(38),o=c(36)("IE_PROTO"),d=function(){},v=function(){var n,i=c(32)("iframe"),f=a.length;for(i.style.display="none",c(54).appendChild(i),i.src="javascript:",(n=i.contentWindow.document).open(),n.write("<script>document.F=Object<\/script>"),n.close(),v=n.F;f--;)delete v.prototype[a[f]];return v()};n.exports=Object.create||function(n,i){var c;return null!==n?(d.prototype=f(n),c=new d,d.prototype=null,c[o]=n):c=v(),void 0===i?c:h(c,i)}},function(n,i,c){var f=c(52),h=c(38);n.exports=Object.keys||function(n){return f(n,h)}},function(n,i,c){var f=c(37)("keys"),h=c(27);n.exports=function(n){return f[n]||(f[n]=h(n))}},function(n,i,c){var f=c(5),h=c(3),a=h["__core-js_shared__"]||(h["__core-js_shared__"]={});(n.exports=function(n,i){return a[n]||(a[n]=void 0!==i?i:{})})("versions",[]).push({version:f.version,mode:c(19)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(n,i){n.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(n,i,c){"use strict";var f=c(24);function h(n){var i,c;this.promise=new n(function(n,f){if(void 0!==i||void 0!==c)throw TypeError("Bad Promise constructor");i=n,c=f}),this.resolve=f(i),this.reject=f(c)}n.exports.f=function(n){return new h(n)}},function(n,i,c){i.f=c(4)},function(n,i,c){var f=c(3),h=c(5),a=c(19),o=c(40),d=c(9).f;n.exports=function(n){var i=h.Symbol||(h.Symbol=a?{}:f.Symbol||{});"_"==n.charAt(0)||n in i||d(i,n,{value:o.f(n)})}},function(n,i){i.f={}.propertyIsEnumerable},function(n,i,c){"use strict";function f(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}function h(n,i,c){return i&&f(n.prototype,i),c&&f(n,c),n}var a=c(18),o=c(6);n.exports=function(){function n(i,c,f){if(function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}(this,n),!(i&&i instanceof a))throw new TypeError('missing or invalid "uri" parameter');for(var h in this._uri=i,this._parameters={},this._display_name=c,f)Object.prototype.hasOwnProperty.call(f,h)&&this.setParam(h,f[h])}return h(n,null,[{key:"parse",value:function(n){return-1!==(n=o.parse(n,"Name_Addr_Header"))?n:void 0}}]),h(n,[{key:"setParam",value:function(n,i){n&&(this._parameters[n.toLowerCase()]=null==i?null:i.toString())}},{key:"getParam",value:function(n){if(n)return this._parameters[n.toLowerCase()]}},{key:"hasParam",value:function(n){if(n)return!!this._parameters.hasOwnProperty(n.toLowerCase())}},{key:"deleteParam",value:function(n){if(n=n.toLowerCase(),this._parameters.hasOwnProperty(n)){var i=this._parameters[n];return delete this._parameters[n],i}}},{key:"clearParams",value:function(){this._parameters={}}},{key:"clone",value:function(){return new n(this._uri.clone(),this._display_name,JSON.parse(JSON.stringify(this._parameters)))}},{key:"toString",value:function(){var n=this._display_name||0===this._display_name?'"'.concat(this._display_name,'" '):"";for(var i in n+="<".concat(this._uri.toString(),">"),this._parameters)Object.prototype.hasOwnProperty.call(this._parameters,i)&&(n+=";".concat(i),null!==this._parameters[i]&&(n+="=".concat(this._parameters[i])));return n}},{key:"uri",get:function(){return this._uri}},{key:"display_name",get:function(){return this._display_name},set:function(n){this._display_name=0===n?"0":n}}]),n}()},function(n,i,c){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var f=o(c(61)),h=o(c(62)),a=o(c(0));function o(n){return n&&n.__esModule?n:{default:n}}var d="jssip-wrap",v=function(){function n(i){(0,f.default)(this,n),i?(this._debug=(0,a.default)(d+":"+i),this._warn=(0,a.default)(d+":WARN:"+i),this._error=(0,a.default)(d+":ERROR:"+i)):(this._debug=(0,a.default)(d),this._warn=(0,a.default)(d+":WARN"),this._error=(0,a.default)(d+":ERROR")),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}return(0,h.default)(n,[{key:"debug",get:function(){return this._debug}},{key:"warn",get:function(){return this._warn}},{key:"error",get:function(){return this._error}}]),n}();i.default=v},function(n,i,c){n.exports=c(74)},function(n,i,c){"use strict";i.__esModule=!0;var f,h=c(76),a=(f=h)&&f.__esModule?f:{default:f};i.default=function(n){return function(){var i=n.apply(this,arguments);return new a.default(function(n,c){return function f(h,o){try{var d=i[h](o),v=d.value}catch(n){return void c(n)}if(!d.done)return a.default.resolve(v).then(function(n){f("next",n)},function(n){f("throw",n)});n(v)}("next")})}}},function(n,i){},function(n,i,c){"use strict";var f=c(78)(!0);c(49)(String,"String",function(n){this._t=String(n),this._i=0},function(){var n,i=this._t,c=this._i;return c>=i.length?{value:void 0,done:!0}:(n=f(i,c),this._i+=n.length,{value:n,done:!1})})},function(n,i,c){"use strict";var f=c(19),h=c(8),a=c(51),o=c(14),d=c(21),v=c(79),y=c(28),g=c(84),b=c(4)("iterator"),m=!([].keys&&"next"in[].keys()),w=function(){return this};n.exports=function(n,i,c,A,C,T,E){v(c,i,A);var k,N,R,x=function(n){if(!m&&n in S)return S[n];switch(n){case"keys":case"values":return function(){return new c(this,n)}}return function(){return new c(this,n)}},O=i+" Iterator",L="values"==C,H=!1,S=n.prototype,j=S[b]||S["@@iterator"]||C&&S[C],B=j||x(C),W=C?L?x("entries"):B:void 0,V="Array"==i&&S.entries||j;if(V&&(R=g(V.call(new n)))!==Object.prototype&&R.next&&(y(R,O,!0),f||"function"==typeof R[b]||o(R,b,w)),L&&j&&"values"!==j.name&&(H=!0,B=function(){return j.call(this)}),f&&!E||!m&&!H&&S[b]||o(S,b,B),d[i]=B,d[O]=w,C)if(k={values:L?B:x("values"),keys:T?B:x("keys"),entries:W},E)for(N in k)N in S||a(S,N,k[N]);else h(h.P+h.F*(m||H),i,k);return k}},function(n,i,c){n.exports=!c(11)&&!c(25)(function(){return 7!=Object.defineProperty(c(32)("div"),"a",{get:function(){return 7}}).a})},function(n,i,c){n.exports=c(14)},function(n,i,c){var f=c(15),h=c(17),a=c(82)(!1),o=c(36)("IE_PROTO");n.exports=function(n,i){var c,d=h(n),v=0,y=[];for(c in d)c!=o&&f(d,c)&&y.push(c);for(;i.length>v;)f(d,c=i[v++])&&(~a(y,c)||y.push(c));return y}},function(n,i,c){var f=c(30),h=Math.min;n.exports=function(n){return n>0?h(f(n),9007199254740991):0}},function(n,i,c){var f=c(3).document;n.exports=f&&f.documentElement},function(n,i,c){c(86);for(var f=c(3),h=c(14),a=c(21),o=c(4)("toStringTag"),d="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),v=0;v<d.length;v++){var y=d[v],g=f[y],b=g&&g.prototype;b&&!b[o]&&h(b,o,y),a[y]=a.Array}},function(n,i,c){var f=c(22),h=c(4)("toStringTag"),a="Arguments"==f(function(){return arguments}());n.exports=function(n){var i,c,o;return void 0===n?"Undefined":null===n?"Null":"string"==typeof(c=function(n,i){try{return n[i]}catch(n){}}(i=Object(n),h))?c:a?f(i):"Object"==(o=f(i))&&"function"==typeof i.callee?"Arguments":o}},function(n,i,c){var f=c(7),h=c(24),a=c(4)("species");n.exports=function(n,i){var c,o=f(n).constructor;return void 0===o||null==(c=f(o)[a])?i:h(c)}},function(n,i,c){var f,h,a,o=c(20),d=c(95),v=c(54),y=c(32),g=c(3),b=g.process,m=g.setImmediate,w=g.clearImmediate,A=g.MessageChannel,C=g.Dispatch,T=0,E={},k=function(){var n=+this;if(E.hasOwnProperty(n)){var i=E[n];delete E[n],i()}},N=function(n){k.call(n.data)};m&&w||(m=function(n){for(var i=[],c=1;arguments.length>c;)i.push(arguments[c++]);return E[++T]=function(){d("function"==typeof n?n:Function(n),i)},f(T),T},w=function(n){delete E[n]},"process"==c(22)(b)?f=function(n){b.nextTick(o(k,n,1))}:C&&C.now?f=function(n){C.now(o(k,n,1))}:A?(a=(h=new A).port2,h.port1.onmessage=N,f=o(a.postMessage,a,1)):g.addEventListener&&"function"==typeof postMessage&&!g.importScripts?(f=function(n){g.postMessage(n+"","*")},g.addEventListener("message",N,!1)):f="onreadystatechange"in y("script")?function(n){v.appendChild(y("script")).onreadystatechange=function(){v.removeChild(this),k.call(n)}}:function(n){setTimeout(o(k,n,1),0)}),n.exports={set:m,clear:w}},function(n,i){n.exports=function(n){try{return{e:!1,v:n()}}catch(n){return{e:!0,v:n}}}},function(n,i,c){var f=c(7),h=c(10),a=c(39);n.exports=function(n,i){if(f(n),h(i)&&i.constructor===n)return i;var c=a.f(n);return(0,c.resolve)(i),c.promise}},function(n,i,c){"use strict";i.__esModule=!0,i.default=function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}},function(n,i,c){"use strict";i.__esModule=!0;var f,h=c(103),a=(f=h)&&f.__esModule?f:{default:f};i.default=function(){function n(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),(0,a.default)(n,f.key,f)}}return function(i,c,f){return c&&n(i.prototype,c),f&&n(i,f),i}}()},function(n,i,c){"use strict";i.__esModule=!0;var f=o(c(107)),h=o(c(109)),a="function"==typeof h.default&&"symbol"==typeof f.default?function(n){return typeof n}:function(n){return n&&"function"==typeof h.default&&n.constructor===h.default&&n!==h.default.prototype?"symbol":typeof n};function o(n){return n&&n.__esModule?n:{default:n}}i.default="function"==typeof h.default&&"symbol"===a(f.default)?function(n){return void 0===n?"undefined":a(n)}:function(n){return n&&"function"==typeof h.default&&n.constructor===h.default&&n!==h.default.prototype?"symbol":void 0===n?"undefined":a(n)}},function(n,i){i.f=Object.getOwnPropertySymbols},function(n,i,c){var f=c(52),h=c(38).concat("length","prototype");i.f=Object.getOwnPropertyNames||function(n){return f(n,h)}},function(n,i,c){var f=c(42),h=c(26),a=c(17),o=c(33),d=c(15),v=c(50),y=Object.getOwnPropertyDescriptor;i.f=c(11)?y:function(n,i){if(n=a(n),i=o(i,!0),v)try{return y(n,i)}catch(n){}if(d(n,i))return h(!f.f.call(n,i),n[i])}},function(n){n.exports={name:"jssip",title:"JsSIP",description:"the Javascript SIP library",version:"3.3.2",homepage:"http://jssip.net",author:"José Luis Millán <jmillan@aliax.net> (https://github.com/jmillan)",contributors:["Iñaki Baz Castillo <ibc@aliax.net> (https://github.com/ibc)","Saúl Ibarra Corretgé <saghul@gmail.com> (https://github.com/saghul)"],main:"lib-es5/JsSIP.js",keywords:["sip","websocket","webrtc","node","browser","library"],license:"MIT",repository:{type:"git",url:"https://github.com/versatica/JsSIP.git"},bugs:{url:"https://github.com/versatica/JsSIP/issues"},dependencies:{debug:"^4.1.0",events:"^3.0.0","sdp-transform":"^2.7.0"},devDependencies:{"ansi-colors":"^3.2.3","@babel/core":"^7.2.2","@babel/preset-env":"^7.2.0",browserify:"^16.2.3",eslint:"^5.10.0","fancy-log":"^1.3.3",gulp:"^4.0.0","gulp-babel":"^8.0.0","gulp-eslint":"^5.0.0","gulp-expect-file":"^1.0.0","gulp-header":"^2.0.7","gulp-nodeunit-runner":"^0.2.2","gulp-plumber":"^1.2.1","gulp-rename":"^1.4.0","gulp-uglify-es":"^1.0.4",pegjs:"^0.7.0","vinyl-buffer":"^1.0.1","vinyl-source-stream":"^2.0.0"},scripts:{test:"gulp test",prepublishOnly:"gulp babel"},__npminstall_done:"Wed Dec 26 2018 11:15:39 GMT+0800 (GMT+08:00)",_from:"jssip@3.3.2",_resolved:"http://registry.npm.taobao.org/jssip/download/jssip-3.3.2.tgz"}},function(n,i,c){var f=c(129),h=c(130);i.write=h,i.parse=f.parse,i.parseFmtpConfig=f.parseFmtpConfig,i.parseParams=f.parseParams,i.parsePayloads=f.parsePayloads,i.parseRemoteCandidates=f.parseRemoteCandidates,i.parseImageAttributes=f.parseImageAttributes,i.parseSimulcastStreamList=f.parseSimulcastStreamList},function(n,i){var c=n.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(n){return n.encoding?"rtpmap:%d %s/%s/%s":n.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(n){return null!=n.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(n){return null!=n.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,names:["value","direction","uri","config"],format:function(n){return"extmap:%d"+(n.direction?"/%s":"%v")+" %s"+(n.config?" %s":"")}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(n){return null!=n.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(n){var i="candidate:%s %d %s %d %s %d typ %s";return i+=null!=n.raddr?" raddr %s rport %d":"%v%v",i+=null!=n.tcptype?" tcptype %s":"%v",null!=n.generation&&(i+=" generation %d"),i+=null!=n["network-id"]?" network-id %d":"%v",i+=null!=n["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(n){var i="ssrc:%d";return null!=n.attribute&&(i+=" %s",null!=n.value&&(i+=":%s")),i}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(n){return null!=n.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(n){return n.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(n){return"imageattr:%s %s %s"+(n.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(n){return"simulcast:%s %s"+(n.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"invalid",names:["value"]}]};Object.keys(c).forEach(function(n){c[n].forEach(function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")})})},function(n,i,c){"use strict";var f=500;n.exports={T1:f,T2:4e3,T4:5e3,TIMER_B:32e3,TIMER_D:0,TIMER_F:32e3,TIMER_H:32e3,TIMER_I:0,TIMER_J:0,TIMER_K:0,TIMER_L:32e3,TIMER_M:32e3,PROVISIONAL_RESPONSE_INTERVAL:6e4}},function(n,i,c){"use strict";function f(n){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function h(n,i){return!i||"object"!==f(i)&&"function"!=typeof i?function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n):i}function a(n){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function o(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}function d(n,i,c){return i&&o(n.prototype,i),c&&o(n,c),n}function v(n,i){return(v=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n})(n,i)}var y=c(12).EventEmitter,g=c(68),b=c(1),m=c(16),w=c(23),A=c(2),C=c(70),T=c(13),E=c(135),k=c(29),N=c(137),R=c(138),x=c(139),O=c(140),L=c(0)("JsSIP:RTCSession"),H=c(0)("JsSIP:ERROR:RTCSession");H.log=console.warn.bind(console);var S={STATUS_NULL:0,STATUS_INVITE_SENT:1,STATUS_1XX_RECEIVED:2,STATUS_INVITE_RECEIVED:3,STATUS_WAITING_FOR_ANSWER:4,STATUS_ANSWERED:5,STATUS_WAITING_FOR_ACK:6,STATUS_CANCELED:7,STATUS_TERMINATED:8,STATUS_CONFIRMED:9},j=["audio","video"];n.exports=function(n){function i(n){var c;return function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),L("new"),(c=h(this,a(i).call(this)))._id=null,c._ua=n,c._status=S.STATUS_NULL,c._dialog=null,c._earlyDialogs={},c._contact=null,c._from_tag=null,c._to_tag=null,c._connection=null,c._connectionPromiseQueue=Promise.resolve(),c._request=null,c._is_canceled=!1,c._cancel_reason="",c._is_confirmed=!1,c._late_sdp=!1,c._rtcOfferConstraints=null,c._rtcAnswerConstraints=null,c._localMediaStream=null,c._localMediaStreamLocallyGenerated=!1,c._rtcReady=!0,c._timers={ackTimer:null,expiresTimer:null,invite2xxTimer:null,userNoAnswerTimer:null},c._direction=null,c._local_identity=null,c._remote_identity=null,c._start_time=null,c._end_time=null,c._tones=null,c._audioMuted=!1,c._videoMuted=!1,c._localHold=!1,c._remoteHold=!1,c._sessionTimers={enabled:c._ua.configuration.session_timers,refreshMethod:c._ua.configuration.session_timers_refresh_method,defaultExpires:b.SESSION_EXPIRES,currentExpires:null,running:!1,refresher:!1,timer:null},c._referSubscribers={},c._data={},c}return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(i&&i.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),i&&v(n,i)}(i,y),d(i,null,[{key:"C",get:function(){return S}}]),d(i,[{key:"isInProgress",value:function(){switch(this._status){case S.STATUS_NULL:case S.STATUS_INVITE_SENT:case S.STATUS_1XX_RECEIVED:case S.STATUS_INVITE_RECEIVED:case S.STATUS_WAITING_FOR_ANSWER:return!0;default:return!1}}},{key:"isEstablished",value:function(){switch(this._status){case S.STATUS_ANSWERED:case S.STATUS_WAITING_FOR_ACK:case S.STATUS_CONFIRMED:return!0;default:return!1}}},{key:"isEnded",value:function(){switch(this._status){case S.STATUS_CANCELED:case S.STATUS_TERMINATED:return!0;default:return!1}}},{key:"isMuted",value:function(){return{audio:this._audioMuted,video:this._videoMuted}}},{key:"isOnHold",value:function(){return{local:this._localHold,remote:this._remoteHold}}},{key:"connect",value:function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=arguments.length>2?arguments[2]:void 0;L("connect()");var f=n,h=i.eventHandlers||{},a=A.cloneArray(i.extraHeaders),o=i.mediaConstraints||{audio:!0,video:!0},d=i.mediaStream||null,v=i.pcConfig||{iceServers:[]},y=i.rtcConstraints||null,g=i.rtcOfferConstraints||null;if(this._rtcOfferConstraints=g,this._rtcAnswerConstraints=i.rtcAnswerConstraints||null,this._data=i.data||this._data,void 0===n)throw new TypeError("Not enough arguments");if(this._status!==S.STATUS_NULL)throw new m.InvalidStateError(this._status);if(!window.RTCPeerConnection)throw new m.NotSupportedError("WebRTC not supported");if(!(n=this._ua.normalizeTarget(n)))throw new TypeError("Invalid target: ".concat(f));for(var w in this._sessionTimers.enabled&&A.isDecimal(i.sessionTimersExpires)&&(i.sessionTimersExpires>=b.MIN_SESSION_EXPIRES?this._sessionTimers.defaultExpires=i.sessionTimersExpires:this._sessionTimers.defaultExpires=b.SESSION_EXPIRES),h)Object.prototype.hasOwnProperty.call(h,w)&&this.on(w,h[w]);this._from_tag=A.newTag();var C=i.anonymous||!1,E={from_tag:this._from_tag};this._contact=this._ua.contact.toString({anonymous:C,outbound:!0}),C&&(E.from_display_name="Anonymous",E.from_uri="sip:anonymous@anonymous.invalid",a.push("P-Preferred-Identity: ".concat(this._ua.configuration.uri.toString())),a.push("Privacy: id")),a.push("Contact: ".concat(this._contact)),a.push("Content-Type: application/sdp"),this._sessionTimers.enabled&&a.push("Session-Expires: ".concat(this._sessionTimers.defaultExpires)),this._request=new T.InitialOutgoingInviteRequest(n,this._ua,E,a),this._id=this._request.call_id+this._from_tag,this._createRTCConnection(v,y),this._direction="outgoing",this._local_identity=this._request.from,this._remote_identity=this._request.to,c&&c(this),this._newRTCSession("local",this._request),this._sendInitialRequest(o,g,d)}},{key:"init_incoming",value:function(n,i){var c,f=this;L("init_incoming()");var h=n.getHeader("Content-Type");n.body&&"application/sdp"!==h?n.reply(415):(this._status=S.STATUS_INVITE_RECEIVED,this._from_tag=n.from_tag,this._id=n.call_id+this._from_tag,this._request=n,this._contact=this._ua.contact.toString(),n.hasHeader("expires")&&(c=1e3*n.getHeader("expires")),n.to_tag=A.newTag(),this._createDialog(n,"UAS",!0)?(n.body?this._late_sdp=!1:this._late_sdp=!0,this._status=S.STATUS_WAITING_FOR_ANSWER,this._timers.userNoAnswerTimer=setTimeout(function(){n.reply(408),f._failed("local",null,b.causes.NO_ANSWER)},this._ua.configuration.no_answer_timeout),c&&(this._timers.expiresTimer=setTimeout(function(){f._status===S.STATUS_WAITING_FOR_ANSWER&&(n.reply(487),f._failed("system",null,b.causes.EXPIRES))},c)),this._direction="incoming",this._local_identity=n.to,this._remote_identity=n.from,i&&i(this),this._newRTCSession("remote",n),this._status!==S.STATUS_TERMINATED&&(n.reply(180,null,["Contact: ".concat(this._contact)]),this._progress("local",null))):n.reply(500,"Missing Contact header field"))}},{key:"answer",value:function(){var n=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};L("answer()");var c,f=this._request,h=A.cloneArray(i.extraHeaders),a=i.mediaConstraints||{},o=i.mediaStream||null,d=i.pcConfig||{iceServers:[]},v=i.rtcConstraints||null,y=i.rtcAnswerConstraints||null,g=!1,w=!1,C=!1,T=!1;if(this._rtcAnswerConstraints=y,this._rtcOfferConstraints=i.rtcOfferConstraints||null,this._data=i.data||this._data,"incoming"!==this._direction)throw new m.NotSupportedError('"answer" not supported for outgoing RTCSession');if(this._status!==S.STATUS_WAITING_FOR_ANSWER)throw new m.InvalidStateError(this._status);if(this._sessionTimers.enabled&&A.isDecimal(i.sessionTimersExpires)&&(i.sessionTimersExpires>=b.MIN_SESSION_EXPIRES?this._sessionTimers.defaultExpires=i.sessionTimersExpires:this._sessionTimers.defaultExpires=b.SESSION_EXPIRES),this._status=S.STATUS_ANSWERED,this._createDialog(f,"UAS")){clearTimeout(this._timers.userNoAnswerTimer),h.unshift("Contact: ".concat(this._contact));var E=f.parseSDP();Array.isArray(E.media)||(E.media=[E.media]);var k=!0,N=!1,R=void 0;try{for(var x,O=E.media[Symbol.iterator]();!(k=(x=O.next()).done);k=!0){var j=x.value;"audio"===j.type&&(g=!0,j.direction&&"sendrecv"!==j.direction||(C=!0)),"video"===j.type&&(w=!0,j.direction&&"sendrecv"!==j.direction||(T=!0))}}catch(n){N=!0,R=n}finally{try{k||null==O.return||O.return()}finally{if(N)throw R}}if(o&&!1===a.audio){c=o.getAudioTracks();var B=!0,W=!1,V=void 0;try{for(var K,Y=c[Symbol.iterator]();!(B=(K=Y.next()).done);B=!0){var U=K.value;o.removeTrack(U)}}catch(n){W=!0,V=n}finally{try{B||null==Y.return||Y.return()}finally{if(W)throw V}}}if(o&&!1===a.video){c=o.getVideoTracks();var z=!0,X=!1,$=void 0;try{for(var J,Z=c[Symbol.iterator]();!(z=(J=Z.next()).done);z=!0){var D=J.value;o.removeTrack(D)}}catch(n){X=!0,$=n}finally{try{z||null==Z.return||Z.return()}finally{if(X)throw $}}}o||void 0!==a.audio||(a.audio=C),o||void 0!==a.video||(a.video=T),o||g||(a.audio=!1),o||w||(a.video=!1),this._createRTCConnection(d,v),Promise.resolve().then(function(){return o||(a.audio||a.video?(n._localMediaStreamLocallyGenerated=!0,navigator.mediaDevices.getUserMedia(a).catch(function(i){if(n._status===S.STATUS_TERMINATED)throw new Error("terminated");throw f.reply(480),n._failed("local",null,b.causes.USER_DENIED_MEDIA_ACCESS),H('emit "getusermediafailed" [error:%o]',i),n.emit("getusermediafailed",i),new Error("getUserMedia() failed")})):void 0)}).then(function(i){if(n._status===S.STATUS_TERMINATED)throw new Error("terminated");n._localMediaStream=i,i&&i.getTracks().forEach(function(c){n._connection.addTrack(c,i)})}).then(function(){if(!n._late_sdp){var i={originator:"remote",type:"offer",sdp:f.body};L('emit "sdp"'),n.emit("sdp",i);var c=new RTCSessionDescription({type:"offer",sdp:i.sdp});return n._connectionPromiseQueue=n._connectionPromiseQueue.then(function(){return n._connection.setRemoteDescription(c)}).catch(function(i){throw f.reply(488),n._failed("system",null,b.causes.WEBRTC_ERROR),H('emit "peerconnection:setremotedescriptionfailed" [error:%o]',i),n.emit("peerconnection:setremotedescriptionfailed",i),new Error("peerconnection.setRemoteDescription() failed")}),n._connectionPromiseQueue}}).then(function(){if(n._status===S.STATUS_TERMINATED)throw new Error("terminated");return n._connecting(f),n._late_sdp?n._createLocalDescription("offer",n._rtcOfferConstraints).catch(function(){throw f.reply(500),new Error("_createLocalDescription() failed")}):n._createLocalDescription("answer",y).catch(function(){throw f.reply(500),new Error("_createLocalDescription() failed")})}).then(function(i){if(n._status===S.STATUS_TERMINATED)throw new Error("terminated");n._handleSessionTimersInIncomingRequest(f,h),f.reply(200,null,h,i,function(){n._status=S.STATUS_WAITING_FOR_ACK,n._setInvite2xxTimer(f,i),n._setACKTimer(),n._accepted("local")},function(){n._failed("system",null,b.causes.CONNECTION_ERROR)})}).catch(function(i){n._status!==S.STATUS_TERMINATED&&H(i)})}else f.reply(500,"Error creating dialog")}},{key:"terminate",value:function(){var n=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};L("terminate()");var c,f=i.cause||b.causes.BYE,h=A.cloneArray(i.extraHeaders),a=i.body,o=i.status_code,d=i.reason_phrase;if(this._status===S.STATUS_TERMINATED)throw new m.InvalidStateError(this._status);switch(this._status){case S.STATUS_NULL:case S.STATUS_INVITE_SENT:case S.STATUS_1XX_RECEIVED:if(L("canceling session"),o&&(o<200||o>=700))throw new TypeError("Invalid status_code: ".concat(o));o&&(d=d||b.REASON_PHRASE[o]||"",c="SIP ;cause=".concat(o,' ;text="').concat(d,'"')),this._status===S.STATUS_NULL||this._status===S.STATUS_INVITE_SENT?(this._is_canceled=!0,this._cancel_reason=c):this._status===S.STATUS_1XX_RECEIVED&&this._request.cancel(c),this._status=S.STATUS_CANCELED,this._failed("local",null,b.causes.CANCELED);break;case S.STATUS_WAITING_FOR_ANSWER:case S.STATUS_ANSWERED:if(L("rejecting session"),(o=o||480)<300||o>=700)throw new TypeError("Invalid status_code: ".concat(o));this._request.reply(o,d,h,a),this._failed("local",null,b.causes.REJECTED);break;case S.STATUS_WAITING_FOR_ACK:case S.STATUS_CONFIRMED:if(L("terminating session"),d=i.reason_phrase||b.REASON_PHRASE[o]||"",o&&(o<200||o>=700))throw new TypeError("Invalid status_code: ".concat(o));if(o&&h.push("Reason: SIP ;cause=".concat(o,'; text="').concat(d,'"')),this._status===S.STATUS_WAITING_FOR_ACK&&"incoming"===this._direction&&this._request.server_transaction.state!==w.C.STATUS_TERMINATED){var v=this._dialog;this.receiveRequest=function(i){i.method===b.ACK&&(n.sendRequest(b.BYE,{extraHeaders:h,body:a}),v.terminate())},this._request.server_transaction.on("stateChanged",function(){n._request.server_transaction.state===w.C.STATUS_TERMINATED&&(n.sendRequest(b.BYE,{extraHeaders:h,body:a}),v.terminate())}),this._ended("local",null,f),this._dialog=v,this._ua.newDialog(v)}else this.sendRequest(b.BYE,{extraHeaders:h,body:a}),this._ended("local",null,f)}}},{key:"sendDTMF",value:function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};L("sendDTMF() | tones: %s",n);var c=0,f=i.duration||null,h=i.interToneGap||null;if(void 0===n)throw new TypeError("Not enough arguments");if(this._status!==S.STATUS_CONFIRMED&&this._status!==S.STATUS_WAITING_FOR_ACK)throw new m.InvalidStateError(this._status);if("number"==typeof n&&(n=n.toString()),!n||"string"!=typeof n||!n.match(/^[0-9A-DR#*,]+$/i))throw new TypeError("Invalid tones: ".concat(n));if(f&&!A.isDecimal(f))throw new TypeError("Invalid tone duration: ".concat(f));if(f?f<N.C.MIN_DURATION?(L('"duration" value is lower than the minimum allowed, setting it to '.concat(N.C.MIN_DURATION," milliseconds")),f=N.C.MIN_DURATION):f>N.C.MAX_DURATION?(L('"duration" value is greater than the maximum allowed, setting it to '.concat(N.C.MAX_DURATION," milliseconds")),f=N.C.MAX_DURATION):f=Math.abs(f):f=N.C.DEFAULT_DURATION,i.duration=f,h&&!A.isDecimal(h))throw new TypeError("Invalid interToneGap: ".concat(h));h?h<N.C.MIN_INTER_TONE_GAP?(L('"interToneGap" value is lower than the minimum allowed, setting it to '.concat(N.C.MIN_INTER_TONE_GAP," milliseconds")),h=N.C.MIN_INTER_TONE_GAP):h=Math.abs(h):h=N.C.DEFAULT_INTER_TONE_GAP,this._tones?this._tones+=n:(this._tones=n,function n(){var a=this;var o;if(this._status===S.STATUS_TERMINATED||!this._tones||c>=this._tones.length)return void(this._tones=null);var d=this._tones[c];c+=1;if(","===d)o=2e3;else{var v=new N(this);i.eventHandlers={onFailed:function(){a._tones=null}},v.send(d,i),o=f+h}setTimeout(n.bind(this),o)}.call(this))}},{key:"sendInfo",value:function(n,i){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(L("sendInfo()"),this._status!==S.STATUS_CONFIRMED&&this._status!==S.STATUS_WAITING_FOR_ACK)throw new m.InvalidStateError(this._status);new R(this).send(n,i,c)}},{key:"mute",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{audio:!0,video:!1};L("mute()");var i=!1,c=!1;!1===this._audioMuted&&n.audio&&(i=!0,this._audioMuted=!0,this._toggleMuteAudio(!0)),!1===this._videoMuted&&n.video&&(c=!0,this._videoMuted=!0,this._toggleMuteVideo(!0)),!0!==i&&!0!==c||this._onmute({audio:i,video:c})}},{key:"unmute",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{audio:!0,video:!0};L("unmute()");var i=!1,c=!1;!0===this._audioMuted&&n.audio&&(i=!0,this._audioMuted=!1,!1===this._localHold&&this._toggleMuteAudio(!1)),!0===this._videoMuted&&n.video&&(c=!0,this._videoMuted=!1,!1===this._localHold&&this._toggleMuteVideo(!1)),!0!==i&&!0!==c||this._onunmute({audio:i,video:c})}},{key:"hold",value:function(){var n=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1?arguments[1]:void 0;if(L("hold()"),this._status!==S.STATUS_WAITING_FOR_ACK&&this._status!==S.STATUS_CONFIRMED)return!1;if(!0===this._localHold)return!1;if(!this._isReadyToReOffer())return!1;this._localHold=!0,this._onhold("local");var f={succeeded:function(){c&&c()},failed:function(){n.terminate({cause:b.causes.WEBRTC_ERROR,status_code:500,reason_phrase:"Hold Failed"})}};return i.useUpdate?this._sendUpdate({sdpOffer:!0,eventHandlers:f,extraHeaders:i.extraHeaders}):this._sendReinvite({eventHandlers:f,extraHeaders:i.extraHeaders}),!0}},{key:"unhold",value:function(){var n=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1?arguments[1]:void 0;if(L("unhold()"),this._status!==S.STATUS_WAITING_FOR_ACK&&this._status!==S.STATUS_CONFIRMED)return!1;if(!1===this._localHold)return!1;if(!this._isReadyToReOffer())return!1;this._localHold=!1,this._onunhold("local");var f={succeeded:function(){c&&c()},failed:function(){n.terminate({cause:b.causes.WEBRTC_ERROR,status_code:500,reason_phrase:"Unhold Failed"})}};return i.useUpdate?this._sendUpdate({sdpOffer:!0,eventHandlers:f,extraHeaders:i.extraHeaders}):this._sendReinvite({eventHandlers:f,extraHeaders:i.extraHeaders}),!0}},{key:"renegotiate",value:function(){var n=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1?arguments[1]:void 0;L("renegotiate()");var f=i.rtcOfferConstraints||null;if(this._status!==S.STATUS_WAITING_FOR_ACK&&this._status!==S.STATUS_CONFIRMED)return!1;if(!this._isReadyToReOffer())return!1;var h={succeeded:function(){c&&c()},failed:function(){n.terminate({cause:b.causes.WEBRTC_ERROR,status_code:500,reason_phrase:"Media Renegotiation Failed"})}};return this._setLocalMediaStatus(),i.useUpdate?this._sendUpdate({sdpOffer:!0,eventHandlers:h,rtcOfferConstraints:f,extraHeaders:i.extraHeaders}):this._sendReinvite({eventHandlers:h,rtcOfferConstraints:f,extraHeaders:i.extraHeaders}),!0}},{key:"refer",value:function(n,i){var c=this;L("refer()");var f=n;if(this._status!==S.STATUS_WAITING_FOR_ACK&&this._status!==S.STATUS_CONFIRMED)return!1;if(!(n=this._ua.normalizeTarget(n)))throw new TypeError("Invalid target: ".concat(f));var h=new O(this);h.sendRefer(n,i);var a=h.id;return this._referSubscribers[a]=h,h.on("requestFailed",function(){delete c._referSubscribers[a]}),h.on("accepted",function(){delete c._referSubscribers[a]}),h.on("failed",function(){delete c._referSubscribers[a]}),h}},{key:"sendRequest",value:function(n,i){return L("sendRequest()"),this._dialog.sendRequest(n,i)}},{key:"receiveRequest",value:function(n){var i=this;if(L("receiveRequest()"),n.method===b.CANCEL)this._status!==S.STATUS_WAITING_FOR_ANSWER&&this._status!==S.STATUS_ANSWERED||(this._status=S.STATUS_CANCELED,this._request.reply(487),this._failed("remote",n,b.causes.CANCELED));else switch(n.method){case b.ACK:if(this._status!==S.STATUS_WAITING_FOR_ACK)return;if(this._status=S.STATUS_CONFIRMED,clearTimeout(this._timers.ackTimer),clearTimeout(this._timers.invite2xxTimer),this._late_sdp){if(!n.body){this.terminate({cause:b.causes.MISSING_SDP,status_code:400});break}var c={originator:"remote",type:"answer",sdp:n.body};L('emit "sdp"'),this.emit("sdp",c);var f=new RTCSessionDescription({type:"answer",sdp:c.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return i._connection.setRemoteDescription(f)}).then(function(){i._is_confirmed||i._confirmed("remote",n)}).catch(function(n){i.terminate({cause:b.causes.BAD_MEDIA_DESCRIPTION,status_code:488}),H('emit "peerconnection:setremotedescriptionfailed" [error:%o]',n),i.emit("peerconnection:setremotedescriptionfailed",n)})}else this._is_confirmed||this._confirmed("remote",n);break;case b.BYE:this._status===S.STATUS_CONFIRMED?(n.reply(200),this._ended("remote",n,b.causes.BYE)):this._status===S.STATUS_INVITE_RECEIVED?(n.reply(200),this._request.reply(487,"BYE Received"),this._ended("remote",n,b.causes.BYE)):n.reply(403,"Wrong Status");break;case b.INVITE:this._status===S.STATUS_CONFIRMED?n.hasHeader("replaces")?this._receiveReplaces(n):this._receiveReinvite(n):n.reply(403,"Wrong Status");break;case b.INFO:if(this._status===S.STATUS_1XX_RECEIVED||this._status===S.STATUS_WAITING_FOR_ANSWER||this._status===S.STATUS_ANSWERED||this._status===S.STATUS_WAITING_FOR_ACK||this._status===S.STATUS_CONFIRMED){var h=n.getHeader("content-type");h&&h.match(/^application\/dtmf-relay/i)?new N(this).init_incoming(n):void 0!==h?new R(this).init_incoming(n):n.reply(415)}else n.reply(403,"Wrong Status");break;case b.UPDATE:this._status===S.STATUS_CONFIRMED?this._receiveUpdate(n):n.reply(403,"Wrong Status");break;case b.REFER:this._status===S.STATUS_CONFIRMED?this._receiveRefer(n):n.reply(403,"Wrong Status");break;case b.NOTIFY:this._status===S.STATUS_CONFIRMED?this._receiveNotify(n):n.reply(403,"Wrong Status");break;default:n.reply(501)}}},{key:"onTransportError",value:function(){H("onTransportError()"),this._status!==S.STATUS_TERMINATED&&this.terminate({status_code:500,reason_phrase:b.causes.CONNECTION_ERROR,cause:b.causes.CONNECTION_ERROR})}},{key:"onRequestTimeout",value:function(){H("onRequestTimeout()"),this._status!==S.STATUS_TERMINATED&&this.terminate({status_code:408,reason_phrase:b.causes.REQUEST_TIMEOUT,cause:b.causes.REQUEST_TIMEOUT})}},{key:"onDialogError",value:function(){H("onDialogError()"),this._status!==S.STATUS_TERMINATED&&this.terminate({status_code:500,reason_phrase:b.causes.DIALOG_ERROR,cause:b.causes.DIALOG_ERROR})}},{key:"newDTMF",value:function(n){L("newDTMF()"),this.emit("newDTMF",n)}},{key:"newInfo",value:function(n){L("newInfo()"),this.emit("newInfo",n)}},{key:"_isReadyToReOffer",value:function(){return this._rtcReady?this._dialog?!0!==this._dialog.uac_pending_reply&&!0!==this._dialog.uas_pending_reply||(L("_isReadyToReOffer() | there is another INVITE/UPDATE transaction in progress"),!1):(L("_isReadyToReOffer() | session not established yet"),!1):(L("_isReadyToReOffer() | internal WebRTC status not ready"),!1)}},{key:"_close",value:function(){if(L("close()"),this._status!==S.STATUS_TERMINATED){if(this._status=S.STATUS_TERMINATED,this._connection)try{this._connection.close()}catch(n){H("close() | error closing the RTCPeerConnection: %o",n)}for(var n in this._localMediaStream&&this._localMediaStreamLocallyGenerated&&(L("close() | closing local MediaStream"),A.closeMediaStream(this._localMediaStream)),this._timers)Object.prototype.hasOwnProperty.call(this._timers,n)&&clearTimeout(this._timers[n]);for(var i in clearTimeout(this._sessionTimers.timer),this._dialog&&(this._dialog.terminate(),delete this._dialog),this._earlyDialogs)Object.prototype.hasOwnProperty.call(this._earlyDialogs,i)&&(this._earlyDialogs[i].terminate(),delete this._earlyDialogs[i]);for(var c in this._referSubscribers)Object.prototype.hasOwnProperty.call(this._referSubscribers,c)&&delete this._referSubscribers[c];this._ua.destroyRTCSession(this)}}},{key:"_setInvite2xxTimer",value:function(n,i){var c=C.T1;this._timers.invite2xxTimer=setTimeout(function f(){this._status===S.STATUS_WAITING_FOR_ACK&&(n.reply(200,null,["Contact: ".concat(this._contact)],i),c<C.T2&&(c*=2)>C.T2&&(c=C.T2),this._timers.invite2xxTimer=setTimeout(f.bind(this),c))}.bind(this),c)}},{key:"_setACKTimer",value:function(){var n=this;this._timers.ackTimer=setTimeout(function(){n._status===S.STATUS_WAITING_FOR_ACK&&(L("no ACK received, terminating the session"),clearTimeout(n._timers.invite2xxTimer),n.sendRequest(b.BYE),n._ended("remote",null,b.causes.NO_ACK))},C.TIMER_H)}},{key:"_createRTCConnection",value:function(n,i){var c=this;this._connection=new RTCPeerConnection(n,i),this._connection.addEventListener("iceconnectionstatechange",function(){"failed"===c._connection.iceConnectionState&&c.terminate({cause:b.causes.RTP_TIMEOUT,status_code:408,reason_phrase:b.causes.RTP_TIMEOUT})}),L('emit "peerconnection"'),this.emit("peerconnection",{peerconnection:this._connection})}},{key:"_createLocalDescription",value:function(n,i){var c=this;if(L("createLocalDescription()"),"offer"!==n&&"answer"!==n)throw new Error('createLocalDescription() | invalid type "'.concat(n,'"'));var f=this._connection;return this._rtcReady=!1,Promise.resolve().then(function(){return"offer"===n?f.createOffer(i).catch(function(n){return H('emit "peerconnection:createofferfailed" [error:%o]',n),c.emit("peerconnection:createofferfailed",n),Promise.reject(n)}):f.createAnswer(i).catch(function(n){return H('emit "peerconnection:createanswerfailed" [error:%o]',n),c.emit("peerconnection:createanswerfailed",n),Promise.reject(n)})}).then(function(n){return f.setLocalDescription(n).catch(function(n){return c._rtcReady=!0,H('emit "peerconnection:setlocaldescriptionfailed" [error:%o]',n),c.emit("peerconnection:setlocaldescriptionfailed",n),Promise.reject(n)})}).then(function(){if("complete"===f.iceGatheringState){c._rtcReady=!0;var i={originator:"local",type:n,sdp:f.localDescription.sdp};return L('emit "sdp"'),c.emit("sdp",i),Promise.resolve(i.sdp)}return new Promise(function(i){var h,a=!1,o=function(){f.removeEventListener("icecandidate",h),a=!0,c._rtcReady=!0;var o={originator:"local",type:n,sdp:f.localDescription.sdp};L('emit "sdp"'),c.emit("sdp",o),i(o.sdp)};f.addEventListener("icecandidate",h=function(n){var i=n.candidate;i?c.emit("icecandidate",{candidate:i,ready:o}):a||o()})})})}},{key:"_createDialog",value:function(n,i,c){var f="UAS"===i?n.to_tag:n.from_tag,h="UAS"===i?n.from_tag:n.to_tag,a=n.call_id+f+h,o=this._earlyDialogs[a];if(c)return!!o||((o=new E(this,n,i,E.C.STATUS_EARLY)).error?(L(o.error),this._failed("remote",n,b.causes.INTERNAL_ERROR),!1):(this._earlyDialogs[a]=o,!0));if(this._from_tag=n.from_tag,this._to_tag=n.to_tag,o)return o.update(n,i),this._dialog=o,delete this._earlyDialogs[a],!0;var d=new E(this,n,i);return d.error?(L(d.error),this._failed("remote",n,b.causes.INTERNAL_ERROR),!1):(this._dialog=d,!0)}},{key:"_receiveReinvite",value:function(n){var i=this;L("receiveReinvite()");var c=n.getHeader("Content-Type"),f={request:n,callback:void 0,reject:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};h=!0;var c=i.status_code||403,f=i.reason_phrase||"",a=A.cloneArray(i.extraHeaders);if(this._status!==S.STATUS_CONFIRMED)return!1;if(c<300||c>=700)throw new TypeError("Invalid status_code: ".concat(c));n.reply(c,f,a)}.bind(this)},h=!1;if(this.emit("reinvite",f),!h){if(this._late_sdp=!1,!n.body)return this._late_sdp=!0,void(this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return i._createLocalDescription("offer",i._rtcOfferConstraints)}).then(function(n){a.call(i,n)}).catch(function(){n.reply(500)}));if("application/sdp"!==c)return L("invalid Content-Type"),void n.reply(415);this._processInDialogSdpOffer(n).then(function(n){i._status!==S.STATUS_TERMINATED&&a.call(i,n)}).catch(function(n){H(n)})}function a(i){var c=this,h=["Contact: ".concat(this._contact)];this._handleSessionTimersInIncomingRequest(n,h),this._late_sdp&&(i=this._mangleOffer(i)),n.reply(200,null,h,i,function(){c._status=S.STATUS_WAITING_FOR_ACK,c._setInvite2xxTimer(n,i),c._setACKTimer()}),"function"==typeof f.callback&&f.callback()}}},{key:"_receiveUpdate",value:function(n){var i=this;L("receiveUpdate()");var c=n.getHeader("Content-Type"),f={request:n,callback:void 0,reject:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};h=!0;var c=i.status_code||403,f=i.reason_phrase||"",a=A.cloneArray(i.extraHeaders);if(this._status!==S.STATUS_CONFIRMED)return!1;if(c<300||c>=700)throw new TypeError("Invalid status_code: ".concat(c));n.reply(c,f,a)}.bind(this)},h=!1;if(this.emit("update",f),!h)if(n.body){if("application/sdp"!==c)return L("invalid Content-Type"),void n.reply(415);this._processInDialogSdpOffer(n).then(function(n){i._status!==S.STATUS_TERMINATED&&a.call(i,n)}).catch(function(n){H(n)})}else a.call(this,null);function a(i){var c=["Contact: ".concat(this._contact)];this._handleSessionTimersInIncomingRequest(n,c),n.reply(200,null,c,i),"function"==typeof f.callback&&f.callback()}}},{key:"_processInDialogSdpOffer",value:function(n){var i=this;L("_processInDialogSdpOffer()");var c=n.parseSDP(),f=!1,h=!0,a=!1,o=void 0;try{for(var d,v=c.media[Symbol.iterator]();!(h=(d=v.next()).done);h=!0){var y=d.value;if(-1!==j.indexOf(y.type)){var g=y.direction||c.direction||"sendrecv";if("sendonly"!==g&&"inactive"!==g){f=!1;break}f=!0}}}catch(n){a=!0,o=n}finally{try{h||null==v.return||v.return()}finally{if(a)throw o}}var b={originator:"remote",type:"offer",sdp:n.body};L('emit "sdp"'),this.emit("sdp",b);var m=new RTCSessionDescription({type:"offer",sdp:b.sdp});return this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){if(i._status===S.STATUS_TERMINATED)throw new Error("terminated");return i._connection.setRemoteDescription(m).catch(function(c){throw n.reply(488),H('emit "peerconnection:setremotedescriptionfailed" [error:%o]',c),i.emit("peerconnection:setremotedescriptionfailed",c),new Error("peerconnection.setRemoteDescription() failed")})}).then(function(){if(i._status===S.STATUS_TERMINATED)throw new Error("terminated");!0===i._remoteHold&&!1===f?(i._remoteHold=!1,i._onunhold("remote")):!1===i._remoteHold&&!0===f&&(i._remoteHold=!0,i._onhold("remote"))}).then(function(){if(i._status===S.STATUS_TERMINATED)throw new Error("terminated");return i._createLocalDescription("answer",i._rtcAnswerConstraints).catch(function(){throw n.reply(500),new Error("_createLocalDescription() failed")})}),this._connectionPromiseQueue}},{key:"_receiveRefer",value:function(n){var c=this;if(L("receiveRefer()"),!n.refer_to)return L("no Refer-To header field present in REFER"),void n.reply(400);if(n.refer_to.uri.scheme!==b.SIP)return L("Refer-To header field points to a non-SIP URI scheme"),void n.reply(416);n.reply(202);var f=new x(this,n.cseq);L('emit "refer"'),this.emit("refer",{request:n,accept:function(h,a){(function(c){var h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(c="function"==typeof c?c:null,this._status!==S.STATUS_WAITING_FOR_ACK&&this._status!==S.STATUS_CONFIRMED)return!1;var a=new i(this._ua);if(a.on("progress",function(n){var i=n.response;f.notify(i.status_code,i.reason_phrase)}),a.on("accepted",function(n){var i=n.response;f.notify(i.status_code,i.reason_phrase)}),a.on("failed",function(n){var i=n.message,c=n.cause;i?f.notify(i.status_code,i.reason_phrase):f.notify(487,c)}),n.refer_to.uri.hasHeader("replaces")){var o=decodeURIComponent(n.refer_to.uri.getHeader("replaces"));h.extraHeaders=A.cloneArray(h.extraHeaders),h.extraHeaders.push("Replaces: ".concat(o))}a.connect(n.refer_to.uri.toAor(),h,c)}).call(c,h,a)},reject:function(){(function(){f.notify(603)}).call(c)}})}},{key:"_receiveNotify",value:function(n){switch(L("receiveNotify()"),n.event||n.reply(400),n.event.event){case"refer":var i,c;if(n.event.params&&n.event.params.id)i=n.event.params.id,c=this._referSubscribers[i];else{if(1!==Object.keys(this._referSubscribers).length)return void n.reply(400,"Missing event id parameter");c=this._referSubscribers[Object.keys(this._referSubscribers)[0]]}if(!c)return void n.reply(481,"Subscription does not exist");c.receiveNotify(n),n.reply(200);break;default:n.reply(489)}}},{key:"_receiveReplaces",value:function(n){var c=this;L("receiveReplaces()"),this.emit("replaces",{request:n,accept:function(f){(function(c){var f=this;if(this._status!==S.STATUS_WAITING_FOR_ACK&&this._status!==S.STATUS_CONFIRMED)return!1;var h=new i(this._ua);h.on("confirmed",function(){f.terminate()}),h.init_incoming(n,c)}).call(c,f)},reject:function(){(function(){L("Replaced INVITE rejected by the user"),n.reply(486)}).call(c)}})}},{key:"_sendInitialRequest",value:function(n,i,c){var f=this,h=new k(this._ua,this._request,{onRequestTimeout:function(){f.onRequestTimeout()},onTransportError:function(){f.onTransportError()},onAuthenticated:function(n){f._request=n},onReceiveResponse:function(n){f._receiveInviteResponse(n)}});Promise.resolve().then(function(){return c||(n.audio||n.video?(f._localMediaStreamLocallyGenerated=!0,navigator.mediaDevices.getUserMedia(n).catch(function(n){if(f._status===S.STATUS_TERMINATED)throw new Error("terminated");throw f._failed("local",null,b.causes.USER_DENIED_MEDIA_ACCESS),H('emit "getusermediafailed" [error:%o]',n),f.emit("getusermediafailed",n),n})):void 0)}).then(function(n){if(f._status===S.STATUS_TERMINATED)throw new Error("terminated");return f._localMediaStream=n,n&&n.getTracks().forEach(function(i){f._connection.addTrack(i,n)}),f._connecting(f._request),f._createLocalDescription("offer",i).catch(function(n){throw f._failed("local",null,b.causes.WEBRTC_ERROR),n})}).then(function(n){if(f._is_canceled||f._status===S.STATUS_TERMINATED)throw new Error("terminated");f._request.body=n,f._status=S.STATUS_INVITE_SENT,L('emit "sending" [request:%o]',f._request),f.emit("sending",{request:f._request}),h.send()}).catch(function(n){f._status!==S.STATUS_TERMINATED&&H(n)})}},{key:"_receiveInviteResponse",value:function(n){var i=this;if(L("receiveInviteResponse()"),this._dialog&&n.status_code>=200&&n.status_code<=299){if(this._dialog.id.call_id===n.call_id&&this._dialog.id.local_tag===n.from_tag&&this._dialog.id.remote_tag===n.to_tag)return void this.sendRequest(b.ACK);var c=new E(this,n,"UAC");return void 0!==c.error?void L(c.error):(this.sendRequest(b.ACK),void this.sendRequest(b.BYE))}if(this._is_canceled)n.status_code>=100&&n.status_code<200?this._request.cancel(this._cancel_reason):n.status_code>=200&&n.status_code<299&&this._acceptAndTerminate(n);else if(this._status===S.STATUS_INVITE_SENT||this._status===S.STATUS_1XX_RECEIVED)switch(!0){case/^100$/.test(n.status_code):this._status=S.STATUS_1XX_RECEIVED;break;case/^1[0-9]{2}$/.test(n.status_code):if(!n.to_tag){L("1xx response received without to tag");break}if(n.hasHeader("contact")&&!this._createDialog(n,"UAC",!0))break;if(this._status=S.STATUS_1XX_RECEIVED,this._progress("remote",n),!n.body)break;var f={originator:"remote",type:"answer",sdp:n.body};L('emit "sdp"'),this.emit("sdp",f);var h=new RTCSessionDescription({type:"answer",sdp:f.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return i._connection.setRemoteDescription(h)}).catch(function(n){H('emit "peerconnection:setremotedescriptionfailed" [error:%o]',n),i.emit("peerconnection:setremotedescriptionfailed",n)});break;case/^2[0-9]{2}$/.test(n.status_code):if(this._status=S.STATUS_CONFIRMED,!n.body){this._acceptAndTerminate(n,400,b.causes.MISSING_SDP),this._failed("remote",n,b.causes.BAD_MEDIA_DESCRIPTION);break}if(!this._createDialog(n,"UAC"))break;var a={originator:"remote",type:"answer",sdp:n.body};L('emit "sdp"'),this.emit("sdp",a);var o=new RTCSessionDescription({type:"answer",sdp:a.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){if("stable"===i._connection.signalingState)return i._connection.createOffer().then(function(n){return i._connection.setLocalDescription(n)}).catch(function(c){i._acceptAndTerminate(n,500,c.toString()),i._failed("local",n,b.causes.WEBRTC_ERROR)})}).then(function(){i._connection.setRemoteDescription(o).then(function(){i._handleSessionTimersInIncomingResponse(n),i._accepted("remote",n),i.sendRequest(b.ACK),i._confirmed("local",null)}).catch(function(c){i._acceptAndTerminate(n,488,"Not Acceptable Here"),i._failed("remote",n,b.causes.BAD_MEDIA_DESCRIPTION),H('emit "peerconnection:setremotedescriptionfailed" [error:%o]',c),i.emit("peerconnection:setremotedescriptionfailed",c)})});break;default:var d=A.sipErrorCause(n.status_code);this._failed("remote",n,d)}}},{key:"_sendReinvite",value:function(){var n=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};L("sendReinvite()");var c=A.cloneArray(i.extraHeaders),f=i.eventHandlers||{},h=i.rtcOfferConstraints||this._rtcOfferConstraints||null,a=!1;function o(n){f.failed&&f.failed(n)}c.push("Contact: ".concat(this._contact)),c.push("Content-Type: application/sdp"),this._sessionTimers.running&&c.push("Session-Expires: ".concat(this._sessionTimers.currentExpires,";refresher=").concat(this._sessionTimers.refresher?"uac":"uas")),this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return n._createLocalDescription("offer",h)}).then(function(i){var h={originator:"local",type:"offer",sdp:i=n._mangleOffer(i)};L('emit "sdp"'),n.emit("sdp",h),n.sendRequest(b.INVITE,{extraHeaders:c,body:i,eventHandlers:{onSuccessResponse:function(i){(function(n){var i=this;if(this._status===S.STATUS_TERMINATED)return;if(this.sendRequest(b.ACK),a)return;if(this._handleSessionTimersInIncomingResponse(n),!n.body)return void o.call(this);if("application/sdp"!==n.getHeader("Content-Type"))return void o.call(this);var c={originator:"remote",type:"answer",sdp:n.body};L('emit "sdp"'),this.emit("sdp",c);var h=new RTCSessionDescription({type:"answer",sdp:c.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return i._connection.setRemoteDescription(h)}).then(function(){f.succeeded&&f.succeeded(n)}).catch(function(n){o.call(i),H('emit "peerconnection:setremotedescriptionfailed" [error:%o]',n),i.emit("peerconnection:setremotedescriptionfailed",n)})}).call(n,i),a=!0},onErrorResponse:function(i){o.call(n,i)},onTransportError:function(){n.onTransportError()},onRequestTimeout:function(){n.onRequestTimeout()},onDialogError:function(){n.onDialogError()}}})}).catch(function(){o()})}},{key:"_sendUpdate",value:function(){var n=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};L("sendUpdate()");var c=A.cloneArray(i.extraHeaders),f=i.eventHandlers||{},h=i.rtcOfferConstraints||this._rtcOfferConstraints||null,a=i.sdpOffer||!1,o=!1;function d(n){var i=this;if(this._status!==S.STATUS_TERMINATED&&!o)if(this._handleSessionTimersInIncomingResponse(n),a){if(!n.body)return void v.call(this);if("application/sdp"!==n.getHeader("Content-Type"))return void v.call(this);var c={originator:"remote",type:"answer",sdp:n.body};L('emit "sdp"'),this.emit("sdp",c);var h=new RTCSessionDescription({type:"answer",sdp:c.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return i._connection.setRemoteDescription(h)}).then(function(){f.succeeded&&f.succeeded(n)}).catch(function(n){v.call(i),H('emit "peerconnection:setremotedescriptionfailed" [error:%o]',n),i.emit("peerconnection:setremotedescriptionfailed",n)})}else f.succeeded&&f.succeeded(n)}function v(n){f.failed&&f.failed(n)}c.push("Contact: ".concat(this._contact)),this._sessionTimers.running&&c.push("Session-Expires: ".concat(this._sessionTimers.currentExpires,";refresher=").concat(this._sessionTimers.refresher?"uac":"uas")),a?(c.push("Content-Type: application/sdp"),this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return n._createLocalDescription("offer",h)}).then(function(i){var f={originator:"local",type:"offer",sdp:i=n._mangleOffer(i)};L('emit "sdp"'),n.emit("sdp",f),n.sendRequest(b.UPDATE,{extraHeaders:c,body:i,eventHandlers:{onSuccessResponse:function(i){d.call(n,i),o=!0},onErrorResponse:function(i){v.call(n,i)},onTransportError:function(){n.onTransportError()},onRequestTimeout:function(){n.onRequestTimeout()},onDialogError:function(){n.onDialogError()}}})}).catch(function(){v.call(n)})):this.sendRequest(b.UPDATE,{extraHeaders:c,eventHandlers:{onSuccessResponse:function(i){d.call(n,i)},onErrorResponse:function(i){v.call(n,i)},onTransportError:function(){n.onTransportError()},onRequestTimeout:function(){n.onRequestTimeout()},onDialogError:function(){n.onDialogError()}}})}},{key:"_acceptAndTerminate",value:function(n,i,c){L("acceptAndTerminate()");var f=[];i&&(c=c||b.REASON_PHRASE[i]||"",f.push("Reason: SIP ;cause=".concat(i,'; text="').concat(c,'"'))),(this._dialog||this._createDialog(n,"UAC"))&&(this.sendRequest(b.ACK),this.sendRequest(b.BYE,{extraHeaders:f})),this._status=S.STATUS_TERMINATED}},{key:"_mangleOffer",value:function(n){if(!this._localHold&&!this._remoteHold)return n;if(n=g.parse(n),this._localHold&&!this._remoteHold){L("mangleOffer() | me on hold, mangling offer");var i=!0,c=!1,f=void 0;try{for(var h,a=n.media[Symbol.iterator]();!(i=(h=a.next()).done);i=!0){var o=h.value;-1!==j.indexOf(o.type)&&(o.direction?"sendrecv"===o.direction?o.direction="sendonly":"recvonly"===o.direction&&(o.direction="inactive"):o.direction="sendonly")}}catch(n){c=!0,f=n}finally{try{i||null==a.return||a.return()}finally{if(c)throw f}}}else if(this._localHold&&this._remoteHold){L("mangleOffer() | both on hold, mangling offer");var d=!0,v=!1,y=void 0;try{for(var b,m=n.media[Symbol.iterator]();!(d=(b=m.next()).done);d=!0){var w=b.value;-1!==j.indexOf(w.type)&&(w.direction="inactive")}}catch(n){v=!0,y=n}finally{try{d||null==m.return||m.return()}finally{if(v)throw y}}}else if(this._remoteHold){L("mangleOffer() | remote on hold, mangling offer");var A=!0,C=!1,T=void 0;try{for(var E,k=n.media[Symbol.iterator]();!(A=(E=k.next()).done);A=!0){var N=E.value;-1!==j.indexOf(N.type)&&(N.direction?"sendrecv"===N.direction?N.direction="recvonly":"recvonly"===N.direction&&(N.direction="inactive"):N.direction="recvonly")}}catch(n){C=!0,T=n}finally{try{A||null==k.return||k.return()}finally{if(C)throw T}}}return g.write(n)}},{key:"_setLocalMediaStatus",value:function(){var n=!0,i=!0;(this._localHold||this._remoteHold)&&(n=!1,i=!1),this._audioMuted&&(n=!1),this._videoMuted&&(i=!1),this._toggleMuteAudio(!n),this._toggleMuteVideo(!i)}},{key:"_handleSessionTimersInIncomingRequest",value:function(n,i){var c;this._sessionTimers.enabled&&(n.session_expires&&n.session_expires>=b.MIN_SESSION_EXPIRES?(this._sessionTimers.currentExpires=n.session_expires,c=n.session_expires_refresher||"uas"):(this._sessionTimers.currentExpires=this._sessionTimers.defaultExpires,c="uas"),i.push("Session-Expires: ".concat(this._sessionTimers.currentExpires,";refresher=").concat(c)),this._sessionTimers.refresher="uas"===c,this._runSessionTimer())}},{key:"_handleSessionTimersInIncomingResponse",value:function(n){var i;this._sessionTimers.enabled&&(n.session_expires&&n.session_expires>=b.MIN_SESSION_EXPIRES?(this._sessionTimers.currentExpires=n.session_expires,i=n.session_expires_refresher||"uac"):(this._sessionTimers.currentExpires=this._sessionTimers.defaultExpires,i="uac"),this._sessionTimers.refresher="uac"===i,this._runSessionTimer())}},{key:"_runSessionTimer",value:function(){var n=this,i=this._sessionTimers.currentExpires;this._sessionTimers.running=!0,clearTimeout(this._sessionTimers.timer),this._sessionTimers.refresher?this._sessionTimers.timer=setTimeout(function(){n._status!==S.STATUS_TERMINATED&&(L("runSessionTimer() | sending session refresh request"),n._sessionTimers.refreshMethod===b.UPDATE?n._sendUpdate():n._sendReinvite())},500*i):this._sessionTimers.timer=setTimeout(function(){n._status!==S.STATUS_TERMINATED&&(H("runSessionTimer() | timer expired, terminating the session"),n.terminate({cause:b.causes.REQUEST_TIMEOUT,status_code:408,reason_phrase:"Session Timer Expired"}))},1100*i)}},{key:"_toggleMuteAudio",value:function(n){var i=this._connection.getSenders().filter(function(n){return n.track&&"audio"===n.track.kind}),c=!0,f=!1,h=void 0;try{for(var a,o=i[Symbol.iterator]();!(c=(a=o.next()).done);c=!0){a.value.track.enabled=!n}}catch(n){f=!0,h=n}finally{try{c||null==o.return||o.return()}finally{if(f)throw h}}}},{key:"_toggleMuteVideo",value:function(n){var i=this._connection.getSenders().filter(function(n){return n.track&&"video"===n.track.kind}),c=!0,f=!1,h=void 0;try{for(var a,o=i[Symbol.iterator]();!(c=(a=o.next()).done);c=!0){a.value.track.enabled=!n}}catch(n){f=!0,h=n}finally{try{c||null==o.return||o.return()}finally{if(f)throw h}}}},{key:"_newRTCSession",value:function(n,i){L("newRTCSession()"),this._ua.newRTCSession(this,{originator:n,session:this,request:i})}},{key:"_connecting",value:function(n){L("session connecting"),L('emit "connecting"'),this.emit("connecting",{request:n})}},{key:"_progress",value:function(n,i){L("session progress"),L('emit "progress"'),this.emit("progress",{originator:n,response:i||null})}},{key:"_accepted",value:function(n,i){L("session accepted"),this._start_time=new Date,L('emit "accepted"'),this.emit("accepted",{originator:n,response:i||null})}},{key:"_confirmed",value:function(n,i){L("session confirmed"),this._is_confirmed=!0,L('emit "confirmed"'),this.emit("confirmed",{originator:n,ack:i||null})}},{key:"_ended",value:function(n,i,c){L("session ended"),this._end_time=new Date,this._close(),L('emit "ended"'),this.emit("ended",{originator:n,message:i||null,cause:c})}},{key:"_failed",value:function(n,i,c){L("session failed"),this._close(),L('emit "failed"'),this.emit("failed",{originator:n,message:i||null,cause:c})}},{key:"_onhold",value:function(n){L("session onhold"),this._setLocalMediaStatus(),L('emit "hold"'),this.emit("hold",{originator:n})}},{key:"_onunhold",value:function(n){L("session onunhold"),this._setLocalMediaStatus(),L('emit "unhold"'),this.emit("unhold",{originator:n})}},{key:"_onmute",value:function(n){var i=n.audio,c=n.video;L("session onmute"),this._setLocalMediaStatus(),L('emit "muted"'),this.emit("muted",{audio:i,video:c})}},{key:"_onunmute",value:function(n){var i=n.audio,c=n.video;L("session onunmute"),this._setLocalMediaStatus(),L('emit "unmuted"'),this.emit("unmuted",{audio:i,video:c})}},{key:"C",get:function(){return S}},{key:"causes",get:function(){return b.causes}},{key:"id",get:function(){return this._id}},{key:"connection",get:function(){return this._connection}},{key:"contact",get:function(){return this._contact}},{key:"direction",get:function(){return this._direction}},{key:"local_identity",get:function(){return this._local_identity}},{key:"remote_identity",get:function(){return this._remote_identity}},{key:"start_time",get:function(){return this._start_time}},{key:"end_time",get:function(){return this._end_time}},{key:"data",get:function(){return this._data},set:function(n){this._data=n}},{key:"status",get:function(){return this._status}}]),i}()},function(n,i,c){"use strict";var f=c(2),h=c(6),a=c(0)("JsSIP:ERROR:Socket");a.log=console.warn.bind(console),i.isSocket=function(n){if(Array.isArray(n))return!1;if(void 0===n)return a("undefined JsSIP.Socket instance"),!1;try{if(!f.isString(n.url))throw a("missing or invalid JsSIP.Socket url property"),new Error;if(!f.isString(n.via_transport))throw a("missing or invalid JsSIP.Socket via_transport property"),new Error;if(-1===h.parse(n.sip_uri,"SIP_URI"))throw a("missing or invalid JsSIP.Socket sip_uri property"),new Error}catch(n){return!1}try{["connect","disconnect","send"].forEach(function(i){if(!f.isFunction(n[i]))throw a("missing or invalid JsSIP.Socket method: ".concat(i)),new Error})}catch(n){return!1}return!0}},function(n,i,c){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var f=w(c(45)),h=w(c(46)),a=w(c(61)),o=w(c(62)),d=w(c(106)),v=w(c(118)),y=w(c(126)),g=w(c(44)),b=w(c(147)),m=w(c(148));function w(n){return n&&n.__esModule?n:{default:n}}var A=w(c(12)).default.EventEmitter,C=new g.default("index"),T=function(n){function i(){(0,a.default)(this,i);var n=(0,d.default)(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return n._ua=null,n.fns={},n._ccNumber=null,n.callType=0,n.answerTime=void 0,n}return(0,v.default)(i,n),(0,o.default)(i,[{key:"init",value:function(){var n=(0,h.default)(f.default.mark(function n(i,c){var h,a,o,d,v,y,g,b,w;return f.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(C.debug("初始化准备sip注册"),h={},n.prev=2,window.localStorage&&window.WebSocket&&WebSocket&&localStorage){n.next=7;break}return h.code=10006,h.message="浏览器不支持WebSocket or localStorage",n.abrupt("return",c&&c(h));case 7:if(i&&i.extension&&2==i.extension.split("_").length&&i.appId&&2==i.appId.split("_").length&&i.password&&i.phoneNumber&&i.ip&&i.port&&i.appId){n.next=11;break}return h.code=10001,h.message="配置属性必填",n.abrupt("return",c&&c(h));case 11:if(a=i.extension.split("_"),o={seatnumber:a[0],password:i.password,eid:a[1],callType:i.callType?i.callType:4,modelnumber:i.phoneNumber,frontIp:i.ip,port:i.port,debug:0,wsPort:i.appId.split("_")[1],webPort:i.appId.split("_")[0],secretKey:i.secretKey},!this._ua||!this._ua.isRegistered()){n.next=28;break}if(d=JSON.parse(localStorage.userData),v=d.seatNumber,y=d.eid,g=d.phoneNumber,o.eid!=y||o.seatnumber!=v||o.frontIp!=d.serverInfo.frontIp||o.port!=d.serverInfo.port||o.webPort!=d.serverInfo.webPort){n.next=26;break}if(g==o.modelnumber){n.next=21;break}return n.abrupt("return",this.login(c,o.modelnumber));case 21:return C.debug("相同的企业坐席登陆"),c&&c({code:0,message:"注册成功"}),n.abrupt("return");case 26:this.logout(),C.debug("取消注册重新登陆");case 28:return n.next=30,m.default.getLoginData(o.seatnumber,o.password,o.eid,o.callType,o.modelnumber,{webPort:o.webPort,frontIp:o.frontIp,port:o.port});case 30:if(200==(b=n.sent).status){n.next=35;break}return b.code=b.status,b.message=b.info,n.abrupt("return",c&&c(b));case 35:(w=JSON.parse(localStorage.userData)).gid=0,w.socketUri="ws://"+o.frontIp+":"+o.wsPort,this.registerSip(w),this.registerEvents(c,w),this.receiveNewMsg(),n.next=46;break;case 43:n.prev=43,n.t0=n.catch(2),c&&c({code:6e3,message:n.t0.message});case 46:case"end":return n.stop()}},n,this,[[2,43]])}));return function(i,c){return n.apply(this,arguments)}}()},{key:"registerSip",value:function(n){var i=n.serverIp+":"+n.sipPort,c=n.seatNumber+"_"+n.eid16,f=new y.default.WebSocketInterface(n.socketUri);this._ua=new y.default.UA({uri:"sip:"+c+"@"+n.serverIp,password:n.clearPwd.slice(8,n.clearPwd.length-6),display_name:n.seatNumber,sockets:[f],registrar_server:i,contact_uri:"sip:"+c+"@"+i,authorization_user:c,user_agent:"callcenter_w_pc_Sipek_win32/r50517",use_preloaded_route:!1,session_timers:!0,register_expires:500}),this._ua.start()}},{key:"receiveNewMsg",value:function(){var n=this;this._ua.on("newMessage",function(i){if("local"!=i.originator){var c=i.request.body,f=b.default.xmlToJs(c);C.debug("receive message:"+JSON.stringify(f));var h=Object.keys(f)[0],a=JSON.parse(localStorage.userData);if("cc"==h&&1!==Number(a.seatMode)){var o=f.cc.a,d=f.cc;switch(d.extension=a.seatNumber+"_"+a.eid,C.debug("message",f),o){case"1":case"2":var v="1"==o?"LDLE":"2"==o?"BUSY":o;n._ua.emit("statusChanged",d.extension,v);break;case"87":n._ua.emit("preSetStatusResponse",d);break;case"201":case"301":n.callType=2;var y={code:Number(d.r),message:""};switch(Number(d.r)){case 200:y.message="拨号成功",n.ccNumber=d.c;break;case 470:y.message="当前分机未绑定SIP话机";break;case 471:y.message="SIP话机不在线";break;case 486:y.message="SIP话机正忙";break;case 503:y.message="对方忙碌";break;case 507:y.message="总机号已停机";break;case 508:y.message="非工作时间";break;case 511:y.message="总机号不存在";break;case 512:y.message="该客户今日被呼叫次数已达上限";break;case 1e3:y.message="禁止拨打无权限坐席";break;default:y.message="呼叫失败"}n._ua.emit("calloutResponse",y);break;case"309":n._ua.emit("callinFaildResponse",d);break;case"100":n.callType=0,n.answerPBXCall(d.c),n.ccNumber=d.c,n._ua.emit("newPBXCall",d);break;case"101":n.ccNumber=void 0,n._ua.emit("cancelPBXCall",d);break;case"104":n.answerTime=Date.now(),d.t=new Date(n.answerTime).format("yyyy-MM-dd hh:mm:ss"),n._ua.emit("answeredPBXCall",d);break;case"105":d.t=n.answerTime?Math.round((Date.now()-n.answerTime)/1e3):0,d.a=n.answerTime?new Date(n.answerTime).format("yyyy-MM-dd hh:mm:ss"):0,n.ccNumber=void 0,n.answerTime=void 0,n._ua.emit("endPBXCall",d)}}else"o"==h&&f.o.a&&f.o.a.u&&n.kickOffcb(f.o.a.u[0])}})}},{key:"registerEvents",value:function(n,i){var c=this;this._ua.on("connecting",function(){C.debug("ws connecting")}),this._ua.on("connected",function(){C.debug("ws connected")}),this._ua.on("disconnected",function(){C.error("ws disconnected")}),this._ua.on("registered",function(){C.debug("注册成功 续注册监听")}),this._ua.once("registered",function(f){c.setSeatMode(52),c.logonWithGroup(i.gid,i.eid),localStorage.userData=JSON.stringify(i),c.preLoginStatus("1"),n&&n({code:0,data:f,status:"registered"}),C.debug("注册成功")}),this._ua.on("registrationFailed",function(i){C.debug("sip注册失败"),localStorage.removeItem("userData"),c._ua.stop(),n&&n({code:51003,data:i,info:"sip注册失败",status:"registrationFailed"})})}},{key:"register",value:function(n){var i=this;return this._ua&&this._ua.isRegistered()?("function"==typeof n.callIn&&(this.fns.callIn&&this._ua.removeListener("newPBXCall",this.fns.callIn),this.fns.callIn=function(c){i.fns.stateChange&&i.fns.stateChange(c.extension,"RING"),n.callIn(c.extension,c.n,c.c)},this._ua.on("newPBXCall",this.fns.callIn)),"function"==typeof n.stateChange&&(this.fns.stateChange&&this._ua.removeListener("statusChanged",this.fns.stateChange),this.fns.stateChange=n.stateChange,this._ua.on("statusChanged",this.fns.stateChange)),"function"==typeof n.answer&&(this.fns.answer&&this._ua.removeListener("answeredPBXCall",this.fns.answer),this.fns.answer=function(c){n.answer(c.extension,c.n,c.c,"callTime","record",c.t,i.callType)},this._ua.on("answeredPBXCall",this.fns.answer)),"function"==typeof n.hangup&&(this.fns.hangup&&(this._ua.removeListener("endPBXCall",this.fns.hangup),this._ua.removeListener("cancelPBXCall",this.fns.hangup)),this.fns.hangup=function(c){n.hangup(c.extension,c.n,c.c,c.t,c.c,c.a),i.answerTime=void 0},this._ua.on("endPBXCall",this.fns.hangup),this._ua.on("cancelPBXCall",this.fns.hangup)),"function"==typeof n.error&&(this.fns.error&&this._ua.removeListener("error",this.fns.error),this.fns.error=n.error,this._ua.on("error",this.fns.error)),this.fns.succcess&&(this._ua.removeAllListeners("sendMessageSucccess",this.fns.succcess),delete this.fns.succcess),this.fns.succcess=function(){},this._ua.on("sendMessageSucccess",this.fns.succcess),{code:0}):{code:0,message:"未注册"}}},{key:"sendMsgHelper",value:function(n,i,c,f){var h=this,a=b.default.jsToXml(n,c);"preSetStatus"!=i&&"preSetStatusCancle"!=i||this.once("preSetStatusResponse",function(n){C.debug(n),200==n.r?h._ua.emit("sendMessageSucccess",{callbacktype:i,info:"调用成功",data:"预设状态成功",status:200}):h._ua.emit("sendMessageFaild",{callbacktype:i,info:"预设状态失败",status:"preSetStatus"==i?52006:52007})});var o={succeeded:function(c){C.debug(i+" success!");var a,o=JSON.parse(localStorage.userData);switch(i){case"showBusy":case"showIdle":a="1"==n.a?"LDLE":"2"==n.a?"BUSY":n.a,h.fns[i]&&h.fns[i]({status:200});case"preLoginStatus":case"changeStaus":a="1"==n.a?"LDLE":"2"==n.a?"BUSY":n.a,h._ua.emit("statusChanged",o.seatNumber,a);break;case"setSeatMode":o.seatMode=f.seatMode,f.callintype&&(o.callintype=f.callintype),localStorage.setItem("userData",JSON.stringify(o));default:h._ua.emit("sendMessageSucccess",{callbacktype:i,info:"调用成功",data:c,dataInfo:f,status:200})}},failed:function(n){C.debug(i+n);var c=0;switch(i){case"showBusy":case"showIdle":h.fns[i]&&h.fns[i]({status:500,error:n});case"preLoginStatus":c=52e3;break;case"logonWithGroup":c=52001;break;case"setSeatMode":c=52002;break;case"changeStaus":c=52003;break;case"holdPBXCall":c=52004;break;case"unholdPBXCall":c=52005;break;case"preSetStatus":c=52006;break;case"preSetStatusCancle":c=52007;break;case"answerPBXCall":c=52008;break;case"hangUpPBXCall":c=52009;break;case"callOutWithNumber":c=52010;break;case"callOutWithPhone":c=52011;break;case"transferPBXCall":c=52012;break;default:c=5e4}h._ua.emit("sendMessageFaild",{callbacktype:i,info:n,status:c,dataInfo:f})}};this.sendMessage("PBX",a,o)}},{key:"answerPBXCall",value:function(n){var i={a:"102",c:n};this.sendMsgHelper(i,"answerPBXCall","cc")}},{key:"holdPBXCall",value:function(n){var i=JSON.parse(localStorage.getItem("userData")),c="";2!=i.callintype&&5!=i.callintype||(c=i.seatNumber+"_"+i.eid16),4==i.callintype&&(c="9"+i.phoneNumber);var f={a:"1",number:c,cc:n};this.sendMsgHelper(f,"holdPBXCall","ch")}},{key:"unholdPBXCall",value:function(n){if(!this._ua)return{code:0,message:"未注册"};var i=JSON.parse(localStorage.getItem("userData")),c="";2!=i.callintype&&5!=i.callintype||(c=i.seatNumber+"_"+i.eid16),4==i.callintype&&(c="9"+i.phoneNumber);var f={a:"2",number:c,cc:n};this.sendMsgHelper(f,"unholdPBXCall","ch")}},{key:"preSetStatus",value:function(n){var i={a:"87",s:"2",c:n};this.sendMsgHelper(i,"preSetStatus","cc")}},{key:"preSetStatusCancle",value:function(n){var i={a:"87",s:"-1",c:n};this.sendMsgHelper(i,"preSetStatusCancle","cc")}},{key:"hangup",value:function(n,i){if(!this._ua)return n&&n({code:10002,message:"未初始化"});if(!this.ccNumber)return n&&n({code:10002,message:"通话不存在"});var c={a:"106",c:i=i||this.ccNumber};this.sendMsgHelper(c,"hangUpPBXCall","cc"),n&&n({code:0,message:"调用成功"})}},{key:"call",value:function(n,i){if(!localStorage.userData||!this._ua)return i&&i({code:10001,message:"非注册状态"});if(!n)return i&&i({code:10001,message:"必传参数不能为空"});try{var c="9"+n;C.debug('call others [uri:"%s"]',n);var f=Math.random().toString().split(".")[1].substr(0,3),h={a:"200",i:Date.now().toString()+f,t:c};this.sendMsgHelper(h,"callOutWithPhone","cc"),this._ua.once("calloutResponse",i)}catch(n){i&&i({code:"10001",message:n.message})}}},{key:"login",value:function(n,i){if(!this._ua||!this._ua.isRegistered())return n&&n({code:10001,message:"init 未初始化"});if(i){C.debug("更改回拨话机号码");var c=JSON.parse(localStorage.userData),f=i.startsWith("A")&&i.endsWith("Z")?i.slice(1,i.length-1):i,h={un:c.seatNumber,pwd:c.pwd,eid:c.eid,jsonStr:JSON.stringify({data:{callintype:4,telephone:f}})};m.default.webApiHandler("updateInfo",h).then(function(i){if(200!=i.status)return n&&n({code:10003,message:"updateInfoError",data:i});var c=JSON.parse(localStorage.userData);c.phoneNumber=f,localStorage.userData=JSON.stringify(c),n&&n({code:0,message:"登陆成功"})}).catch(function(i){n&&n({code:10003,message:i.message})})}else n&&n({code:0,message:"登陆成功"})}},{key:"logout",value:function(n){var i=this;this._ua&&this._ua.isRegistered()||n&&n({code:0,message:"未注册"}),this._ua.removeAllListeners(),this._ua.stop(),this._ua.once("unregistered",function(c){var f=c.response||{};"OK"==f.reason_phrase&&200==f.status_code&&"REGISTER"==f.method?(localStorage.removeItem("userData"),i._ua=null,n&&n({code:0,message:f.reason_phrase})):n&&n({code:53e3,message:f.reason_phrase})})}},{key:"showBusy",value:function(n){if(this._ua||n&&n({code:0,message:"未初始化"}),this.fns.showBusy&&delete this.fns.showBusy,this.fns.showBusy=function(i){200==i.status?n&&n({code:0,message:"调用成功"}):n&&n({code:5e3,message:i.error})},this.ccNumber)return this.preSetStatus(this.ccNumber);this.sendMsgHelper({a:"2"},"showBusy","cc")}},{key:"showIdle",value:function(n){this._ua||n&&n({code:0,message:"未初始化"}),this.fns.showIdle&&delete this.fns.showBusy,this.fns.showIdle=function(i){n&&(200==i.status?n&&n({code:0,message:"调用成功"}):n&&n({code:5e3,message:i.error}))},this.sendMsgHelper({a:"1"},"showIdle","cc")}},{key:"changeStaus",value:function(n){return this.sendMsgHelper({a:n.toString()},"changeStaus","cc")}},{key:"sendMessage",value:function(n,i,c){C.debug("send message!!!,content:"+i+" target:"+n);var f={eventHandlers:c,contentType:"application/pidf+xml"},h=JSON.parse(localStorage.getItem("userData"));return this._ua.sendMessage("sip:"+n+"@"+h.serverIp+":"+h.sipPort,i,f)}},{key:"isConnected",value:function(){return this._ua.isConnected}},{key:"preLoginStatus",value:function(n){return this.sendMsgHelper({a:n.toString()},"preLoginStatus","cc")}},{key:"logonWithGroup",value:function(n,i){return this.sendMsgHelper({a:"53",g:n+"_"+i},"logonWithGroup","cc")}},{key:"setSeatMode",value:function(){var n=(0,h.default)(f.default.mark(function n(i){var c,h,a,o;return f.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.changeStaus("1"),c=JSON.parse(localStorage.userData),h={un:c.seatNumber,pwd:c.pwd,eid:c.eid,jsonStr:JSON.stringify({data:{callintype:4}})},n.next=5,m.default.webApiHandler("updateInfo",h);case 5:if(200===(a=n.sent).status){n.next=9;break}return this.emit("sendMessageFaild",{callbacktype:"setSeatMode",info:a.info,status:52002}),n.abrupt("return");case 9:return o={seatMode:2,callintype:4},n.abrupt("return",this.sendMsgHelper({a:i.toString()},"setSeatMode","cc",o));case 11:case"end":return n.stop()}},n,this)}));return function(i){return n.apply(this,arguments)}}()},{key:"kickOffcb",value:function(n){var i=n.r;switch(C.debug("被踢下线",i),i){case"895":case"897":confirm(("897"==i?"注册超时，请重新登录":"其他用户登录您的账号")+"确认重新登录,取消退出状态")?(this._ua.register(),this.ccNumber&&this.hangup(this.ccNumber)):this.logout();break;case"898":case"899":alert("898"==i?"账号过期/账号被删/账号修改，请重新登录":"企业停止"),this.logout()}}},{key:"ccNumber",get:function(){return this._ccNumber},set:function(n){this._ccNumber=n,localStorage.ccNumber=n,C.debug(n)}}]),i}(A);i.default=T;var E=new T;window.BCCSDK=E,window.addEventListener("beforeunload",function(n){E._ua&&E._ua.isRegistered&&E._ua.isRegistered()&&(C.debug(E._ua,E._ua.isRegistered()),E.ccNumber||localStorage.ccNumber,E._ua.stop(),localStorage.removeItem("userData")),(n||window.event).returnValue="离开将不会保存当前状态"}),Date.prototype.format=function(n){var i={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var c in/(y+)/.test(n)&&(n=n.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),i){var f=i[c];new RegExp("("+c+")").test(n)&&(n=n.replace(RegExp.$1,1==RegExp.$1.length?f:("00"+f).substr((""+f).length)))}return n}},function(n,i,c){var f=function(){return this}()||Function("return this")(),h=f.regeneratorRuntime&&Object.getOwnPropertyNames(f).indexOf("regeneratorRuntime")>=0,a=h&&f.regeneratorRuntime;if(f.regeneratorRuntime=void 0,n.exports=c(75),h)f.regeneratorRuntime=a;else try{delete f.regeneratorRuntime}catch(n){f.regeneratorRuntime=void 0}},function(n,i){!function(i){"use strict";var c,f=Object.prototype,h=f.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",d=a.asyncIterator||"@@asyncIterator",v=a.toStringTag||"@@toStringTag",y="object"==typeof n,g=i.regeneratorRuntime;if(g)y&&(n.exports=g);else{(g=i.regeneratorRuntime=y?n.exports:{}).wrap=R;var b="suspendedStart",m="suspendedYield",w="executing",A="completed",C={},T={};T[o]=function(){return this};var E=Object.getPrototypeOf,k=E&&E(E(Y([])));k&&k!==f&&h.call(k,o)&&(T=k);var N=H.prototype=O.prototype=Object.create(T);L.prototype=N.constructor=H,H.constructor=L,H[v]=L.displayName="GeneratorFunction",g.isGeneratorFunction=function(n){var i="function"==typeof n&&n.constructor;return!!i&&(i===L||"GeneratorFunction"===(i.displayName||i.name))},g.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,H):(n.__proto__=H,v in n||(n[v]="GeneratorFunction")),n.prototype=Object.create(N),n},g.awrap=function(n){return{__await:n}},S(j.prototype),j.prototype[d]=function(){return this},g.AsyncIterator=j,g.async=function(n,i,c,f){var h=new j(R(n,i,c,f));return g.isGeneratorFunction(i)?h:h.next().then(function(n){return n.done?n.value:h.next()})},S(N),N[v]="Generator",N[o]=function(){return this},N.toString=function(){return"[object Generator]"},g.keys=function(n){var i=[];for(var c in n)i.push(c);return i.reverse(),function c(){for(;i.length;){var f=i.pop();if(f in n)return c.value=f,c.done=!1,c}return c.done=!0,c}},g.values=Y,K.prototype={constructor:K,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(V),!n)for(var i in this)"t"===i.charAt(0)&&h.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=c)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var i=this;function f(f,h){return d.type="throw",d.arg=n,i.next=f,h&&(i.method="next",i.arg=c),!!h}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],d=o.completion;if("root"===o.tryLoc)return f("end");if(o.tryLoc<=this.prev){var v=h.call(o,"catchLoc"),y=h.call(o,"finallyLoc");if(v&&y){if(this.prev<o.catchLoc)return f(o.catchLoc,!0);if(this.prev<o.finallyLoc)return f(o.finallyLoc)}else if(v){if(this.prev<o.catchLoc)return f(o.catchLoc,!0)}else{if(!y)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return f(o.finallyLoc)}}}},abrupt:function(n,i){for(var c=this.tryEntries.length-1;c>=0;--c){var f=this.tryEntries[c];if(f.tryLoc<=this.prev&&h.call(f,"finallyLoc")&&this.prev<f.finallyLoc){var a=f;break}}a&&("break"===n||"continue"===n)&&a.tryLoc<=i&&i<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=n,o.arg=i,a?(this.method="next",this.next=a.finallyLoc,C):this.complete(o)},complete:function(n,i){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&i&&(this.next=i),C},finish:function(n){for(var i=this.tryEntries.length-1;i>=0;--i){var c=this.tryEntries[i];if(c.finallyLoc===n)return this.complete(c.completion,c.afterLoc),V(c),C}},catch:function(n){for(var i=this.tryEntries.length-1;i>=0;--i){var c=this.tryEntries[i];if(c.tryLoc===n){var f=c.completion;if("throw"===f.type){var h=f.arg;V(c)}return h}}throw new Error("illegal catch attempt")},delegateYield:function(n,i,f){return this.delegate={iterator:Y(n),resultName:i,nextLoc:f},"next"===this.method&&(this.arg=c),C}}}function R(n,i,c,f){var h=i&&i.prototype instanceof O?i:O,a=Object.create(h.prototype),o=new K(f||[]);return a._invoke=function(n,i,c){var f=b;return function(h,a){if(f===w)throw new Error("Generator is already running");if(f===A){if("throw"===h)throw a;return U()}for(c.method=h,c.arg=a;;){var o=c.delegate;if(o){var d=B(o,c);if(d){if(d===C)continue;return d}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(f===b)throw f=A,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);f=w;var v=x(n,i,c);if("normal"===v.type){if(f=c.done?A:m,v.arg===C)continue;return{value:v.arg,done:c.done}}"throw"===v.type&&(f=A,c.method="throw",c.arg=v.arg)}}}(n,c,o),a}function x(n,i,c){try{return{type:"normal",arg:n.call(i,c)}}catch(n){return{type:"throw",arg:n}}}function O(){}function L(){}function H(){}function S(n){["next","throw","return"].forEach(function(i){n[i]=function(n){return this._invoke(i,n)}})}function j(n){var i;this._invoke=function(c,f){function a(){return new Promise(function(i,a){!function i(c,f,a,o){var d=x(n[c],n,f);if("throw"!==d.type){var v=d.arg,y=v.value;return y&&"object"==typeof y&&h.call(y,"__await")?Promise.resolve(y.__await).then(function(n){i("next",n,a,o)},function(n){i("throw",n,a,o)}):Promise.resolve(y).then(function(n){v.value=n,a(v)},o)}o(d.arg)}(c,f,i,a)})}return i=i?i.then(a,a):a()}}function B(n,i){var f=n.iterator[i.method];if(f===c){if(i.delegate=null,"throw"===i.method){if(n.iterator.return&&(i.method="return",i.arg=c,B(n,i),"throw"===i.method))return C;i.method="throw",i.arg=new TypeError("The iterator does not provide a 'throw' method")}return C}var h=x(f,n.iterator,i.arg);if("throw"===h.type)return i.method="throw",i.arg=h.arg,i.delegate=null,C;var a=h.arg;return a?a.done?(i[n.resultName]=a.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=c),i.delegate=null,C):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,C)}function W(n){var i={tryLoc:n[0]};1 in n&&(i.catchLoc=n[1]),2 in n&&(i.finallyLoc=n[2],i.afterLoc=n[3]),this.tryEntries.push(i)}function V(n){var i=n.completion||{};i.type="normal",delete i.arg,n.completion=i}function K(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(W,this),this.reset(!0)}function Y(n){if(n){var i=n[o];if(i)return i.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var f=-1,a=function i(){for(;++f<n.length;)if(h.call(n,f))return i.value=n[f],i.done=!1,i;return i.value=c,i.done=!0,i};return a.next=a}}return{next:U}}function U(){return{value:c,done:!0}}}(function(){return this}()||Function("return this")())},function(n,i,c){n.exports={default:c(77),__esModule:!0}},function(n,i,c){c(47),c(48),c(55),c(89),c(101),c(102),n.exports=c(5).Promise},function(n,i,c){var f=c(30),h=c(31);n.exports=function(n){return function(i,c){var a,o,d=String(h(i)),v=f(c),y=d.length;return v<0||v>=y?n?"":void 0:(a=d.charCodeAt(v))<55296||a>56319||v+1===y||(o=d.charCodeAt(v+1))<56320||o>57343?n?d.charAt(v):a:n?d.slice(v,v+2):o-56320+(a-55296<<10)+65536}}},function(n,i,c){"use strict";var f=c(34),h=c(26),a=c(28),o={};c(14)(o,c(4)("iterator"),function(){return this}),n.exports=function(n,i,c){n.prototype=f(o,{next:h(1,c)}),a(n,i+" Iterator")}},function(n,i,c){var f=c(9),h=c(7),a=c(35);n.exports=c(11)?Object.defineProperties:function(n,i){h(n);for(var c,o=a(i),d=o.length,v=0;d>v;)f.f(n,c=o[v++],i[c]);return n}},function(n,i,c){var f=c(22);n.exports=Object("z").propertyIsEnumerable(0)?Object:function(n){return"String"==f(n)?n.split(""):Object(n)}},function(n,i,c){var f=c(17),h=c(53),a=c(83);n.exports=function(n){return function(i,c,o){var d,v=f(i),y=h(v.length),g=a(o,y);if(n&&c!=c){for(;y>g;)if((d=v[g++])!=d)return!0}else for(;y>g;g++)if((n||g in v)&&v[g]===c)return n||g||0;return!n&&-1}}},function(n,i,c){var f=c(30),h=Math.max,a=Math.min;n.exports=function(n,i){return(n=f(n))<0?h(n+i,0):a(n,i)}},function(n,i,c){var f=c(15),h=c(85),a=c(36)("IE_PROTO"),o=Object.prototype;n.exports=Object.getPrototypeOf||function(n){return n=h(n),f(n,a)?n[a]:"function"==typeof n.constructor&&n instanceof n.constructor?n.constructor.prototype:n instanceof Object?o:null}},function(n,i,c){var f=c(31);n.exports=function(n){return Object(f(n))}},function(n,i,c){"use strict";var f=c(87),h=c(88),a=c(21),o=c(17);n.exports=c(49)(Array,"Array",function(n,i){this._t=o(n),this._i=0,this._k=i},function(){var n=this._t,i=this._k,c=this._i++;return!n||c>=n.length?(this._t=void 0,h(1)):h(0,"keys"==i?c:"values"==i?n[c]:[c,n[c]])},"values"),a.Arguments=a.Array,f("keys"),f("values"),f("entries")},function(n,i){n.exports=function(){}},function(n,i){n.exports=function(n,i){return{value:i,done:!!n}}},function(n,i,c){"use strict";var f,h,a,o,d=c(19),v=c(3),y=c(20),g=c(56),b=c(8),m=c(10),w=c(24),A=c(90),C=c(91),T=c(57),E=c(58).set,k=c(96)(),N=c(39),R=c(59),x=c(97),O=c(60),L=v.TypeError,H=v.process,S=H&&H.versions,j=S&&S.v8||"",B=v.Promise,W="process"==g(H),V=function(){},K=h=N.f,Y=!!function(){try{var n=B.resolve(1),i=(n.constructor={})[c(4)("species")]=function(n){n(V,V)};return(W||"function"==typeof PromiseRejectionEvent)&&n.then(V)instanceof i&&0!==j.indexOf("6.6")&&-1===x.indexOf("Chrome/66")}catch(n){}}(),U=function(n){var i;return!(!m(n)||"function"!=typeof(i=n.then))&&i},z=function(n,i){if(!n._n){n._n=!0;var c=n._c;k(function(){for(var f=n._v,h=1==n._s,a=0,o=function(i){var c,a,o,d=h?i.ok:i.fail,v=i.resolve,y=i.reject,g=i.domain;try{d?(h||(2==n._h&&J(n),n._h=1),!0===d?c=f:(g&&g.enter(),c=d(f),g&&(g.exit(),o=!0)),c===i.promise?y(L("Promise-chain cycle")):(a=U(c))?a.call(c,v,y):v(c)):y(f)}catch(n){g&&!o&&g.exit(),y(n)}};c.length>a;)o(c[a++]);n._c=[],n._n=!1,i&&!n._h&&X(n)})}},X=function(n){E.call(v,function(){var i,c,f,h=n._v,a=$(n);if(a&&(i=R(function(){W?H.emit("unhandledRejection",h,n):(c=v.onunhandledrejection)?c({promise:n,reason:h}):(f=v.console)&&f.error&&f.error("Unhandled promise rejection",h)}),n._h=W||$(n)?2:1),n._a=void 0,a&&i.e)throw i.v})},$=function(n){return 1!==n._h&&0===(n._a||n._c).length},J=function(n){E.call(v,function(){var i;W?H.emit("rejectionHandled",n):(i=v.onrejectionhandled)&&i({promise:n,reason:n._v})})},Z=function(n){var i=this;i._d||(i._d=!0,(i=i._w||i)._v=n,i._s=2,i._a||(i._a=i._c.slice()),z(i,!0))},D=function(n){var i,c=this;if(!c._d){c._d=!0,c=c._w||c;try{if(c===n)throw L("Promise can't be resolved itself");(i=U(n))?k(function(){var f={_w:c,_d:!1};try{i.call(n,y(D,f,1),y(Z,f,1))}catch(n){Z.call(f,n)}}):(c._v=n,c._s=1,z(c,!1))}catch(n){Z.call({_w:c,_d:!1},n)}}};Y||(B=function(n){A(this,B,"Promise","_h"),w(n),f.call(this);try{n(y(D,this,1),y(Z,this,1))}catch(n){Z.call(this,n)}},(f=function(n){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=c(98)(B.prototype,{then:function(n,i){var c=K(T(this,B));return c.ok="function"!=typeof n||n,c.fail="function"==typeof i&&i,c.domain=W?H.domain:void 0,this._c.push(c),this._a&&this._a.push(c),this._s&&z(this,!1),c.promise},catch:function(n){return this.then(void 0,n)}}),a=function(){var n=new f;this.promise=n,this.resolve=y(D,n,1),this.reject=y(Z,n,1)},N.f=K=function(n){return n===B||n===o?new a(n):h(n)}),b(b.G+b.W+b.F*!Y,{Promise:B}),c(28)(B,"Promise"),c(99)("Promise"),o=c(5).Promise,b(b.S+b.F*!Y,"Promise",{reject:function(n){var i=K(this);return(0,i.reject)(n),i.promise}}),b(b.S+b.F*(d||!Y),"Promise",{resolve:function(n){return O(d&&this===o?B:this,n)}}),b(b.S+b.F*!(Y&&c(100)(function(n){B.all(n).catch(V)})),"Promise",{all:function(n){var i=this,c=K(i),f=c.resolve,h=c.reject,a=R(function(){var c=[],a=0,o=1;C(n,!1,function(n){var d=a++,v=!1;c.push(void 0),o++,i.resolve(n).then(function(n){v||(v=!0,c[d]=n,--o||f(c))},h)}),--o||f(c)});return a.e&&h(a.v),c.promise},race:function(n){var i=this,c=K(i),f=c.reject,h=R(function(){C(n,!1,function(n){i.resolve(n).then(c.resolve,f)})});return h.e&&f(h.v),c.promise}})},function(n,i){n.exports=function(n,i,c,f){if(!(n instanceof i)||void 0!==f&&f in n)throw TypeError(c+": incorrect invocation!");return n}},function(n,i,c){var f=c(20),h=c(92),a=c(93),o=c(7),d=c(53),v=c(94),y={},g={};(i=n.exports=function(n,i,c,b,m){var w,A,C,T,E=m?function(){return n}:v(n),k=f(c,b,i?2:1),N=0;if("function"!=typeof E)throw TypeError(n+" is not iterable!");if(a(E)){for(w=d(n.length);w>N;N++)if((T=i?k(o(A=n[N])[0],A[1]):k(n[N]))===y||T===g)return T}else for(C=E.call(n);!(A=C.next()).done;)if((T=h(C,k,A.value,i))===y||T===g)return T}).BREAK=y,i.RETURN=g},function(n,i,c){var f=c(7);n.exports=function(n,i,c,h){try{return h?i(f(c)[0],c[1]):i(c)}catch(i){var a=n.return;throw void 0!==a&&f(a.call(n)),i}}},function(n,i,c){var f=c(21),h=c(4)("iterator"),a=Array.prototype;n.exports=function(n){return void 0!==n&&(f.Array===n||a[h]===n)}},function(n,i,c){var f=c(56),h=c(4)("iterator"),a=c(21);n.exports=c(5).getIteratorMethod=function(n){if(null!=n)return n[h]||n["@@iterator"]||a[f(n)]}},function(n,i){n.exports=function(n,i,c){var f=void 0===c;switch(i.length){case 0:return f?n():n.call(c);case 1:return f?n(i[0]):n.call(c,i[0]);case 2:return f?n(i[0],i[1]):n.call(c,i[0],i[1]);case 3:return f?n(i[0],i[1],i[2]):n.call(c,i[0],i[1],i[2]);case 4:return f?n(i[0],i[1],i[2],i[3]):n.call(c,i[0],i[1],i[2],i[3])}return n.apply(c,i)}},function(n,i,c){var f=c(3),h=c(58).set,a=f.MutationObserver||f.WebKitMutationObserver,o=f.process,d=f.Promise,v="process"==c(22)(o);n.exports=function(){var n,i,c,y=function(){var f,h;for(v&&(f=o.domain)&&f.exit();n;){h=n.fn,n=n.next;try{h()}catch(f){throw n?c():i=void 0,f}}i=void 0,f&&f.enter()};if(v)c=function(){o.nextTick(y)};else if(!a||f.navigator&&f.navigator.standalone)if(d&&d.resolve){var g=d.resolve(void 0);c=function(){g.then(y)}}else c=function(){h.call(f,y)};else{var b=!0,m=document.createTextNode("");new a(y).observe(m,{characterData:!0}),c=function(){m.data=b=!b}}return function(f){var h={fn:f,next:void 0};i&&(i.next=h),n||(n=h,c()),i=h}}},function(n,i,c){var f=c(3).navigator;n.exports=f&&f.userAgent||""},function(n,i,c){var f=c(14);n.exports=function(n,i,c){for(var h in i)c&&n[h]?n[h]=i[h]:f(n,h,i[h]);return n}},function(n,i,c){"use strict";var f=c(3),h=c(5),a=c(9),o=c(11),d=c(4)("species");n.exports=function(n){var i="function"==typeof h[n]?h[n]:f[n];o&&i&&!i[d]&&a.f(i,d,{configurable:!0,get:function(){return this}})}},function(n,i,c){var f=c(4)("iterator"),h=!1;try{var a=[7][f]();a.return=function(){h=!0},Array.from(a,function(){throw 2})}catch(n){}n.exports=function(n,i){if(!i&&!h)return!1;var c=!1;try{var a=[7],o=a[f]();o.next=function(){return{done:c=!0}},a[f]=function(){return o},n(a)}catch(n){}return c}},function(n,i,c){"use strict";var f=c(8),h=c(5),a=c(3),o=c(57),d=c(60);f(f.P+f.R,"Promise",{finally:function(n){var i=o(this,h.Promise||a.Promise),c="function"==typeof n;return this.then(c?function(c){return d(i,n()).then(function(){return c})}:n,c?function(c){return d(i,n()).then(function(){throw c})}:n)}})},function(n,i,c){"use strict";var f=c(8),h=c(39),a=c(59);f(f.S,"Promise",{try:function(n){var i=h.f(this),c=a(n);return(c.e?i.reject:i.resolve)(c.v),i.promise}})},function(n,i,c){n.exports={default:c(104),__esModule:!0}},function(n,i,c){c(105);var f=c(5).Object;n.exports=function(n,i,c){return f.defineProperty(n,i,c)}},function(n,i,c){var f=c(8);f(f.S+f.F*!c(11),"Object",{defineProperty:c(9).f})},function(n,i,c){"use strict";i.__esModule=!0;var f,h=c(63),a=(f=h)&&f.__esModule?f:{default:f};i.default=function(n,i){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!==(void 0===i?"undefined":(0,a.default)(i))&&"function"!=typeof i?n:i}},function(n,i,c){n.exports={default:c(108),__esModule:!0}},function(n,i,c){c(48),c(55),n.exports=c(40).f("iterator")},function(n,i,c){n.exports={default:c(110),__esModule:!0}},function(n,i,c){c(111),c(47),c(116),c(117),n.exports=c(5).Symbol},function(n,i,c){"use strict";var f=c(3),h=c(15),a=c(11),o=c(8),d=c(51),v=c(112).KEY,y=c(25),g=c(37),b=c(28),m=c(27),w=c(4),A=c(40),C=c(41),T=c(113),E=c(114),k=c(7),N=c(10),R=c(17),x=c(33),O=c(26),L=c(34),H=c(115),S=c(66),j=c(9),B=c(35),W=S.f,V=j.f,K=H.f,Y=f.Symbol,U=f.JSON,z=U&&U.stringify,X=w("_hidden"),$=w("toPrimitive"),J={}.propertyIsEnumerable,Z=g("symbol-registry"),D=g("symbols"),Q=g("op-symbols"),M=Object.prototype,P="function"==typeof Y,q=f.QObject,G=!q||!q.prototype||!q.prototype.findChild,F=a&&y(function(){return 7!=L(V({},"a",{get:function(){return V(this,"a",{value:7}).a}})).a})?function(n,i,c){var f=W(M,i);f&&delete M[i],V(n,i,c),f&&n!==M&&V(M,i,f)}:V,I=function(n){var i=D[n]=L(Y.prototype);return i._k=n,i},_=P&&"symbol"==typeof Y.iterator?function(n){return"symbol"==typeof n}:function(n){return n instanceof Y},t=function(n,i,c){return n===M&&t(Q,i,c),k(n),i=x(i,!0),k(c),h(D,i)?(c.enumerable?(h(n,X)&&n[X][i]&&(n[X][i]=!1),c=L(c,{enumerable:O(0,!1)})):(h(n,X)||V(n,X,O(1,{})),n[X][i]=!0),F(n,i,c)):V(n,i,c)},p=function(n,i){k(n);for(var c,f=T(i=R(i)),h=0,a=f.length;a>h;)t(n,c=f[h++],i[c]);return n},e=function(n){var i=J.call(this,n=x(n,!0));return!(this===M&&h(D,n)&&!h(Q,n))&&(!(i||!h(this,n)||!h(D,n)||h(this,X)&&this[X][n])||i)},l=function(n,i){if(n=R(n),i=x(i,!0),n!==M||!h(D,i)||h(Q,i)){var c=W(n,i);return!c||!h(D,i)||h(n,X)&&n[X][i]||(c.enumerable=!0),c}},u=function(n){for(var i,c=K(R(n)),f=[],a=0;c.length>a;)h(D,i=c[a++])||i==X||i==v||f.push(i);return f},r=function(n){for(var i,c=n===M,f=K(c?Q:R(n)),a=[],o=0;f.length>o;)!h(D,i=f[o++])||c&&!h(M,i)||a.push(D[i]);return a};P||(d((Y=function(){if(this instanceof Y)throw TypeError("Symbol is not a constructor!");var n=m(arguments.length>0?arguments[0]:void 0),i=function(c){this===M&&i.call(Q,c),h(this,X)&&h(this[X],n)&&(this[X][n]=!1),F(this,n,O(1,c))};return a&&G&&F(M,n,{configurable:!0,set:i}),I(n)}).prototype,"toString",function(){return this._k}),S.f=l,j.f=t,c(65).f=H.f=u,c(42).f=e,c(64).f=r,a&&!c(19)&&d(M,"propertyIsEnumerable",e,!0),A.f=function(n){return I(w(n))}),o(o.G+o.W+o.F*!P,{Symbol:Y});for(var s="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nn=0;s.length>nn;)w(s[nn++]);for(var cn=B(w.store),fn=0;cn.length>fn;)C(cn[fn++]);o(o.S+o.F*!P,"Symbol",{for:function(n){return h(Z,n+="")?Z[n]:Z[n]=Y(n)},keyFor:function(n){if(!_(n))throw TypeError(n+" is not a symbol!");for(var i in Z)if(Z[i]===n)return i},useSetter:function(){G=!0},useSimple:function(){G=!1}}),o(o.S+o.F*!P,"Object",{create:function(n,i){return void 0===i?L(n):p(L(n),i)},defineProperty:t,defineProperties:p,getOwnPropertyDescriptor:l,getOwnPropertyNames:u,getOwnPropertySymbols:r}),U&&o(o.S+o.F*(!P||y(function(){var n=Y();return"[null]"!=z([n])||"{}"!=z({a:n})||"{}"!=z(Object(n))})),"JSON",{stringify:function(n){for(var i,c,f=[n],h=1;arguments.length>h;)f.push(arguments[h++]);if(c=i=f[1],(N(i)||void 0!==n)&&!_(n))return E(i)||(i=function(n,i){if("function"==typeof c&&(i=c.call(this,n,i)),!_(i))return i}),f[1]=i,z.apply(U,f)}}),Y.prototype[$]||c(14)(Y.prototype,$,Y.prototype.valueOf),b(Y,"Symbol"),b(Math,"Math",!0),b(f.JSON,"JSON",!0)},function(n,i,c){var f=c(27)("meta"),h=c(10),a=c(15),o=c(9).f,d=0,v=Object.isExtensible||function(){return!0},y=!c(25)(function(){return v(Object.preventExtensions({}))}),g=function(n){o(n,f,{value:{i:"O"+ ++d,w:{}}})},b=n.exports={KEY:f,NEED:!1,fastKey:function(n,i){if(!h(n))return"symbol"==typeof n?n:("string"==typeof n?"S":"P")+n;if(!a(n,f)){if(!v(n))return"F";if(!i)return"E";g(n)}return n[f].i},getWeak:function(n,i){if(!a(n,f)){if(!v(n))return!0;if(!i)return!1;g(n)}return n[f].w},onFreeze:function(n){return y&&b.NEED&&v(n)&&!a(n,f)&&g(n),n}}},function(n,i,c){var f=c(35),h=c(64),a=c(42);n.exports=function(n){var i=f(n),c=h.f;if(c)for(var o,d=c(n),v=a.f,y=0;d.length>y;)v.call(n,o=d[y++])&&i.push(o);return i}},function(n,i,c){var f=c(22);n.exports=Array.isArray||function(n){return"Array"==f(n)}},function(n,i,c){var f=c(17),h=c(65).f,a={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];n.exports.f=function(n){return o&&"[object Window]"==a.call(n)?function(n){try{return h(n)}catch(n){return o.slice()}}(n):h(f(n))}},function(n,i,c){c(41)("asyncIterator")},function(n,i,c){c(41)("observable")},function(n,i,c){"use strict";i.__esModule=!0;var f=o(c(119)),h=o(c(123)),a=o(c(63));function o(n){return n&&n.__esModule?n:{default:n}}i.default=function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+(void 0===i?"undefined":(0,a.default)(i)));n.prototype=(0,h.default)(i&&i.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),i&&(f.default?(0,f.default)(n,i):n.__proto__=i)}},function(n,i,c){n.exports={default:c(120),__esModule:!0}},function(n,i,c){c(121),n.exports=c(5).Object.setPrototypeOf},function(n,i,c){var f=c(8);f(f.S,"Object",{setPrototypeOf:c(122).set})},function(n,i,c){var f=c(10),h=c(7),a=function(n,i){if(h(n),!f(i)&&null!==i)throw TypeError(i+": can't set as prototype!")};n.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(n,i,f){try{(f=c(20)(Function.call,c(66).f(Object.prototype,"__proto__").set,2))(n,[]),i=!(n instanceof Array)}catch(n){i=!0}return function(n,c){return a(n,c),i?n.__proto__=c:f(n,c),n}}({},!1):void 0),check:a}},function(n,i,c){n.exports={default:c(124),__esModule:!0}},function(n,i,c){c(125);var f=c(5).Object;n.exports=function(n,i){return f.create(n,i)}},function(n,i,c){var f=c(8);f(f.S,"Object",{create:c(34)})},function(n,i,c){"use strict";var f=c(67),h=c(1),a=c(16),o=c(2),d=c(127),v=c(18),y=c(43),g=c(6),b=c(146);c(0)("JsSIP")("version %s",f.version),n.exports={C:h,Exceptions:a,Utils:o,UA:d,URI:v,NameAddrHeader:y,WebSocketInterface:b,Grammar:g,debug:c(0),get name(){return f.title},get version(){return f.version}}},function(n,i,c){"use strict";function f(n){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function h(n){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function a(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}function o(n,i,c){return i&&a(n.prototype,i),c&&a(n,c),n}function d(n,i){return(d=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n})(n,i)}function v(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}var y=c(12).EventEmitter,g=c(1),b=c(128),m=c(71),w=c(141),A=c(23),C=c(142),T=c(2),E=c(16),k=c(18),N=c(6),R=c(143),x=c(13),O=c(144),L=c(145),H=c(0)("JsSIP:UA"),S=c(0)("JsSIP:ERROR:UA");S.log=console.warn.bind(console);var j={STATUS_INIT:0,STATUS_READY:1,STATUS_USER_CLOSED:2,STATUS_NOT_READY:3,CONFIGURATION_ERROR:1,NETWORK_ERROR:2};n.exports=function(n){function i(n){var c,a,o;if(function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),H("new() [configuration:%o]",n),a=this,(c=!(o=h(i).call(this))||"object"!==f(o)&&"function"!=typeof o?v(a):o)._cache={credentials:{}},c._configuration=Object.assign({},L.settings),c._dynConfiguration={},c._dialogs={},c._applicants={},c._sessions={},c._transport=null,c._contact=null,c._status=j.STATUS_INIT,c._error=null,c._transactions={nist:{},nict:{},ist:{},ict:{}},c._data={},c._closeTimer=null,void 0===n)throw new TypeError("Not enough arguments");try{c._loadConfig(n)}catch(n){throw c._status=j.STATUS_NOT_READY,c._error=j.CONFIGURATION_ERROR,n}return c._registrator=new b(v(v(c))),c}return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(i&&i.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),i&&d(n,i)}(i,y),o(i,null,[{key:"C",get:function(){return j}}]),o(i,[{key:"start",value:function(){H("start()"),this._status===j.STATUS_INIT?this._transport.connect():this._status===j.STATUS_USER_CLOSED?(H("restarting UA"),null!==this._closeTimer&&(clearTimeout(this._closeTimer),this._closeTimer=null,this._transport.disconnect()),this._status=j.STATUS_INIT,this._transport.connect()):this._status===j.STATUS_READY?H("UA is in READY status, not restarted"):H("ERROR: connection is down, Auto-Recovery system is trying to reconnect"),this._dynConfiguration.register=this._configuration.register}},{key:"register",value:function(){H("register()"),this._dynConfiguration.register=!0,this._registrator.register()}},{key:"unregister",value:function(n){H("unregister()"),this._dynConfiguration.register=!1,this._registrator.unregister(n)}},{key:"registrator",value:function(){return this._registrator}},{key:"isRegistered",value:function(){return this._registrator.registered}},{key:"isConnected",value:function(){return this._transport.isConnected()}},{key:"call",value:function(n,i){H("call()");var c=new m(this);return c.connect(n,i),c}},{key:"sendMessage",value:function(n,i,c){H("sendMessage()");var f=new w(this);return f.send(n,i,c),f}},{key:"terminateSessions",value:function(n){for(var i in H("terminateSessions()"),this._sessions)this._sessions[i].isEnded()||this._sessions[i].terminate(n)}},{key:"stop",value:function(){var n=this;if(H("stop()"),this._dynConfiguration={},this._status!==j.STATUS_USER_CLOSED){this._registrator.close();var i=Object.keys(this._sessions).length;for(var c in this._sessions)if(Object.prototype.hasOwnProperty.call(this._sessions,c)){H("closing session ".concat(c));try{this._sessions[c].terminate()}catch(n){}}for(var f in this._applicants)if(Object.prototype.hasOwnProperty.call(this._applicants,f))try{this._applicants[f].close()}catch(n){}this._status=j.STATUS_USER_CLOSED,0===Object.keys(this._transactions.nict).length+Object.keys(this._transactions.nist).length+Object.keys(this._transactions.ict).length+Object.keys(this._transactions.ist).length&&0===i?this._transport.disconnect():this._closeTimer=setTimeout(function(){n._closeTimer=null,n._transport.disconnect()},2e3)}else H("UA already closed")}},{key:"normalizeTarget",value:function(n){return T.normalizeTarget(n,this._configuration.hostport_params)}},{key:"get",value:function(n){switch(n){case"realm":return this._configuration.realm;case"ha1":return this._configuration.ha1;default:return void S('get() | cannot get "%s" parameter in runtime',n)}}},{key:"set",value:function(n,i){switch(n){case"password":this._configuration.password=String(i);break;case"realm":this._configuration.realm=String(i);break;case"ha1":this._configuration.ha1=String(i),this._configuration.password=null;break;case"display_name":if(-1===N.parse('"'.concat(i,'"'),"display_name"))return S('set() | wrong "display_name"'),!1;this._configuration.display_name=i;break;default:return S('set() | cannot set "%s" parameter in runtime',n),!1}return!0}},{key:"newTransaction",value:function(n){this._transactions[n.type][n.id]=n,this.emit("newTransaction",{transaction:n})}},{key:"destroyTransaction",value:function(n){delete this._transactions[n.type][n.id],this.emit("transactionDestroyed",{transaction:n})}},{key:"newDialog",value:function(n){this._dialogs[n.id]=n}},{key:"destroyDialog",value:function(n){delete this._dialogs[n.id]}},{key:"newMessage",value:function(n,i){this._applicants[n]=n,this.emit("newMessage",i)}},{key:"destroyMessage",value:function(n){delete this._applicants[n]}},{key:"newRTCSession",value:function(n,i){this._sessions[n.id]=n,this.emit("newRTCSession",i)}},{key:"destroyRTCSession",value:function(n){delete this._sessions[n.id]}},{key:"registered",value:function(n){this.emit("registered",n)}},{key:"unregistered",value:function(n){this.emit("unregistered",n)}},{key:"registrationFailed",value:function(n){this.emit("registrationFailed",n)}},{key:"receiveRequest",value:function(n){var i=n.method;if(n.ruri.user!==this._configuration.uri.user&&n.ruri.user!==this._contact.uri.user)return H("Request-URI does not point to us"),void(n.method!==g.ACK&&n.reply_sl(404));if(n.ruri.scheme!==g.SIPS){if(!A.checkTransaction(this,n)){if(i===g.INVITE?new A.InviteServerTransaction(this,this._transport,n):i!==g.ACK&&i!==g.CANCEL&&new A.NonInviteServerTransaction(this,this._transport,n),i===g.OPTIONS)n.reply(200);else if(i===g.MESSAGE){if(0===this.listeners("newMessage").length)return void n.reply(405);new w(this).init_incoming(n)}else if(i===g.INVITE&&!n.to_tag&&0===this.listeners("newRTCSession").length)return void n.reply(405);var c,f;if(n.to_tag)(c=this._findDialog(n.call_id,n.from_tag,n.to_tag))?c.receiveRequest(n):i===g.NOTIFY?(f=this._findSession(n))?f.receiveRequest(n):(H("received NOTIFY request for a non existent subscription"),n.reply(481,"Subscription does not exist")):i!==g.ACK&&n.reply(481);else switch(i){case g.INVITE:if(window.RTCPeerConnection)if(n.hasHeader("replaces")){var h=n.replaces;(c=this._findDialog(h.call_id,h.from_tag,h.to_tag))?(f=c.owner).isEnded()?n.reply(603):f.receiveRequest(n):n.reply(481)}else(f=new m(this)).init_incoming(n);else S("INVITE received but WebRTC is not supported"),n.reply(488);break;case g.BYE:n.reply(481);break;case g.CANCEL:(f=this._findSession(n))?f.receiveRequest(n):H("received CANCEL request for a non existent session");break;case g.ACK:break;case g.NOTIFY:this.emit("sipEvent",{event:n.event,request:n}),n.reply(200);break;default:n.reply(405)}}}else n.reply_sl(416)}},{key:"_findSession",value:function(n){var i=n.call_id,c=n.from_tag,f=n.to_tag,h=i+c,a=this._sessions[h],o=i+f,d=this._sessions[o];return a||(d||null)}},{key:"_findDialog",value:function(n,i,c){var f=n+i+c,h=this._dialogs[f];return h||(f=n+c+i,(h=this._dialogs[f])||null)}},{key:"_loadConfig",value:function(n){try{L.load(this._configuration,n)}catch(n){throw n}0===this._configuration.display_name&&(this._configuration.display_name="0"),this._configuration.instance_id||(this._configuration.instance_id=T.newUUID()),this._configuration.jssip_id=T.createRandomToken(5);var i=this._configuration.uri.clone();i.user=null,this._configuration.hostport_params=i.toString().replace(/^sip:/i,"");try{this._transport=new C(this._configuration.sockets,{max_interval:this._configuration.connection_recovery_max_interval,min_interval:this._configuration.connection_recovery_min_interval}),this._transport.onconnecting=function(n){this.emit("connecting",n)}.bind(this),this._transport.onconnect=function(n){if(this._status===j.STATUS_USER_CLOSED)return;this._status=j.STATUS_READY,this._error=null,this.emit("connected",n),this._dynConfiguration.register&&this._registrator.register()}.bind(this),this._transport.ondisconnect=function(n){for(var i=["nict","ict","nist","ist"],c=0;c<i.length;c++){var f=i[c];for(var h in this._transactions[f])Object.prototype.hasOwnProperty.call(this._transactions[f],h)&&this._transactions[f][h].onTransportError()}this.emit("disconnected",n),this._registrator.onTransportClosed(),this._status!==j.STATUS_USER_CLOSED&&(this._status=j.STATUS_NOT_READY,this._error=j.NETWORK_ERROR)}.bind(this),this._transport.ondata=function(n){var i=n.transport,c=n.message;if(!(c=R.parseMessage(c,this)))return;if(this._status===j.STATUS_USER_CLOSED&&c instanceof x.IncomingRequest)return;if(!O(c,this,i))return;if(c instanceof x.IncomingRequest)c.transport=i,this.receiveRequest(c);else if(c instanceof x.IncomingResponse){var f;switch(c.method){case g.INVITE:(f=this._transactions.ict[c.via_branch])&&f.receiveResponse(c);break;case g.ACK:break;default:(f=this._transactions.nict[c.via_branch])&&f.receiveResponse(c)}}}.bind(this)}catch(n){throw S(n),new E.ConfigurationError("sockets",this._configuration.sockets)}if(delete this._configuration.sockets,this._configuration.authorization_user||(this._configuration.authorization_user=this._configuration.uri.user),!this._configuration.registrar_server){var c=this._configuration.uri.clone();c.user=null,c.clearParams(),c.clearHeaders(),this._configuration.registrar_server=c}this._configuration.no_answer_timeout*=1e3,this._configuration.contact_uri?this._configuration.via_host=this._configuration.contact_uri.host:this._configuration.contact_uri=new k("sip",T.createRandomToken(8),this._configuration.via_host,null,{transport:"ws"}),this._contact={pub_gruu:null,temp_gruu:null,uri:this._configuration.contact_uri,toString:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.anonymous||null,c=n.outbound||null,f="<";return f+=i?this.temp_gruu||"sip:anonymous@anonymous.invalid;transport=ws":this.pub_gruu||this.uri.toString(),!c||(i?this.temp_gruu:this.pub_gruu)||(f+=";ob"),f+=">"}};var f=["password","realm","ha1","display_name","register"];for(var h in this._configuration)Object.prototype.hasOwnProperty.call(this._configuration,h)&&(-1!==f.indexOf(h)?Object.defineProperty(this._configuration,h,{writable:!0,configurable:!1}):Object.defineProperty(this._configuration,h,{writable:!1,configurable:!1}));for(var a in H("configuration parameters after validation:"),this._configuration)if(Object.prototype.hasOwnProperty.call(L.settings,a))switch(a){case"uri":case"registrar_server":H("- ".concat(a,": ").concat(this._configuration[a]));break;case"password":case"ha1":H("- ".concat(a,": NOT SHOWN"));break;default:H("- ".concat(a,": ").concat(JSON.stringify(this._configuration[a])))}}},{key:"C",get:function(){return j}},{key:"status",get:function(){return this._status}},{key:"contact",get:function(){return this._contact}},{key:"configuration",get:function(){return this._configuration}},{key:"transport",get:function(){return this._transport}}]),i}()},function(n,i,c){"use strict";function f(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}var h=c(2),a=c(1),o=c(13),d=c(29),v=c(0)("JsSIP:Registrator");n.exports=function(){function n(i,c){!function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}(this,n);this._ua=i,this._transport=c,this._registrar=i.configuration.registrar_server,this._expires=i.configuration.register_expires,this._call_id=h.createRandomToken(22),this._cseq=0,this._to_uri=i.configuration.uri,this._registrationTimer=null,this._registering=!1,this._registered=!1,this._contact=this._ua.contact.toString(),this._contact+=";+sip.ice",this._extraHeaders=[],this._extraContactParams="",this._contact+=";reg-id=".concat(1),this._contact+=';+sip.instance="<urn:uuid:'.concat(this._ua.configuration.instance_id,'>"')}var i,c,y;return i=n,(c=[{key:"setExtraHeaders",value:function(n){Array.isArray(n)||(n=[]),this._extraHeaders=n.slice()}},{key:"setExtraContactParams",value:function(n){for(var i in n instanceof Object||(n={}),this._extraContactParams="",n)if(Object.prototype.hasOwnProperty.call(n,i)){var c=n[i];this._extraContactParams+=";".concat(i),c&&(this._extraContactParams+="=".concat(c))}}},{key:"register",value:function(){var n=this;if(this._registering)v("Register request in progress...");else{var i=this._extraHeaders.slice();i.push("Contact: ".concat(this._contact,";expires=").concat(this._expires).concat(this._extraContactParams)),i.push("Expires: ".concat(this._expires));var c=new o.OutgoingRequest(a.REGISTER,this._registrar,this._ua,{to_uri:this._to_uri,call_id:this._call_id,cseq:this._cseq+=1},i),f=new d(this._ua,c,{onRequestTimeout:function(){n._registrationFailure(null,a.causes.REQUEST_TIMEOUT)},onTransportError:function(){n._registrationFailure(null,a.causes.CONNECTION_ERROR)},onAuthenticated:function(){n._cseq+=1},onReceiveResponse:function(i){var c,f;if(i.hasHeader("Contact")){if(i.cseq===n._cseq){var o=i.headers.Contact.reduce(function(n,i){return n.concat(i.parsed)},[]);switch(null!==n._registrationTimer&&(clearTimeout(n._registrationTimer),n._registrationTimer=null),!0){case/^1[0-9]{2}$/.test(i.status_code):break;case/^2[0-9]{2}$/.test(i.status_code):if(n._registering=!1,!(c=o.find(function(i){return i.uri.user===n._ua.contact.uri.user}))){v("no Contact header pointing to us, response ignored");break}!(f=c.getParam("expires"))&&i.hasHeader("expires")&&(f=i.getHeader("expires")),f||(f=n._expires),(f=Number(f))<10&&(f=10),n._registrationTimer=setTimeout(function(){n._registrationTimer=null,0===n._ua.listeners("registrationExpiring").length?n.register():n._ua.emit("registrationExpiring")},1e3*f-5e3),c.hasParam("temp-gruu")&&(n._ua.contact.temp_gruu=c.getParam("temp-gruu").replace(/"/g,"")),c.hasParam("pub-gruu")&&(n._ua.contact.pub_gruu=c.getParam("pub-gruu").replace(/"/g,"")),n._registered||(n._registered=!0,n._ua.registered({response:i}));break;case/^423$/.test(i.status_code):i.hasHeader("min-expires")?(n._expires=Number(i.getHeader("min-expires")),n._expires<10&&(n._expires=10),n.register()):(v("423 response received for REGISTER without Min-Expires"),n._registrationFailure(i,a.causes.SIP_FAILURE_CODE));break;default:var d=h.sipErrorCause(i.status_code);n._registrationFailure(i,d)}}}else v("no Contact header in response to REGISTER, response ignored")}});this._registering=!0,f.send()}}},{key:"unregister",value:function(){var n=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._registered){this._registered=!1,null!==this._registrationTimer&&(clearTimeout(this._registrationTimer),this._registrationTimer=null);var c=this._extraHeaders.slice();i.all?c.push("Contact: *".concat(this._extraContactParams)):c.push("Contact: ".concat(this._contact,";expires=0").concat(this._extraContactParams)),c.push("Expires: 0");var f=new o.OutgoingRequest(a.REGISTER,this._registrar,this._ua,{to_uri:this._to_uri,call_id:this._call_id,cseq:this._cseq+=1},c);new d(this._ua,f,{onRequestTimeout:function(){n._unregistered(null,a.causes.REQUEST_TIMEOUT)},onTransportError:function(){n._unregistered(null,a.causes.CONNECTION_ERROR)},onAuthenticated:function(){n._cseq+=1},onReceiveResponse:function(i){switch(!0){case/^1[0-9]{2}$/.test(i.status_code):break;case/^2[0-9]{2}$/.test(i.status_code):n._unregistered(i);break;default:var c=h.sipErrorCause(i.status_code);n._unregistered(i,c)}}}).send()}else v("already unregistered")}},{key:"close",value:function(){this._registered&&this.unregister()}},{key:"onTransportClosed",value:function(){this._registering=!1,null!==this._registrationTimer&&(clearTimeout(this._registrationTimer),this._registrationTimer=null),this._registered&&(this._registered=!1,this._ua.unregistered({}))}},{key:"_registrationFailure",value:function(n,i){this._registering=!1,this._ua.registrationFailed({response:n||null,cause:i}),this._registered&&(this._registered=!1,this._ua.unregistered({response:n||null,cause:i}))}},{key:"_unregistered",value:function(n,i){this._registering=!1,this._registered=!1,this._ua.unregistered({response:n||null,cause:i||null})}},{key:"registered",get:function(){return this._registered}}])&&f(i.prototype,c),y&&f(i,y),n}()},function(n,i,c){var f=function(n){return String(Number(n))===n?Number(n):n},h=function(n,i,c){var h=n.name&&n.names;n.push&&!i[n.push]?i[n.push]=[]:h&&!i[n.name]&&(i[n.name]={});var a=n.push?{}:h?i[n.name]:i;!function(n,i,c,h){if(h&&!c)i[h]=f(n[1]);else for(var a=0;a<c.length;a+=1)null!=n[a+1]&&(i[c[a]]=f(n[a+1]))}(c.match(n.reg),a,n.names,n.name),n.push&&i[n.push].push(a)},a=c(69),o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);i.parse=function(n){var i={},c=[],f=i;return n.split(/(\r\n|\r|\n)/).filter(o).forEach(function(n){var i=n[0],o=n.slice(2);"m"===i&&(c.push({rtp:[],fmtp:[]}),f=c[c.length-1]);for(var d=0;d<(a[i]||[]).length;d+=1){var v=a[i][d];if(v.reg.test(o))return h(v,f,o)}}),i.media=c,i};var d=function(n,i){var c=i.split(/=(.+)/,2);return 2===c.length?n[c[0]]=f(c[1]):1===c.length&&i.length>1&&(n[c[0]]=void 0),n};i.parseParams=function(n){return n.split(/\;\s?/).reduce(d,{})},i.parseFmtpConfig=i.parseParams,i.parsePayloads=function(n){return n.split(" ").map(Number)},i.parseRemoteCandidates=function(n){for(var i=[],c=n.split(" ").map(f),h=0;h<c.length;h+=3)i.push({component:c[h],ip:c[h+1],port:c[h+2]});return i},i.parseImageAttributes=function(n){return n.split(" ").map(function(n){return n.substring(1,n.length-1).split(",").reduce(d,{})})},i.parseSimulcastStreamList=function(n){return n.split(";").map(function(n){return n.split(",").map(function(n){var i,c=!1;return"~"!==n[0]?i=f(n):(i=f(n.substring(1,n.length)),c=!0),{scid:i,paused:c}})})}},function(n,i,c){var f=c(69),h=/%[sdv%]/g,a=function(n,i,c){var f=[n+"="+(i.format instanceof Function?i.format(i.push?c:c[i.name]):i.format)];if(i.names)for(var a=0;a<i.names.length;a+=1){var o=i.names[a];i.name?f.push(c[i.name][o]):f.push(c[i.names[a]])}else f.push(c[i.name]);return function(n){var i=1,c=arguments,f=c.length;return n.replace(h,function(n){if(i>=f)return n;var h=c[i];switch(i+=1,n){case"%%":return"%";case"%s":return String(h);case"%d":return Number(h);case"%v":return""}})}.apply(null,f)},o=["v","o","s","i","u","e","p","c","b","t","r","z","a"],d=["i","c","b","a"];n.exports=function(n,i){i=i||{},null==n.version&&(n.version=0),null==n.name&&(n.name=" "),n.media.forEach(function(n){null==n.payloads&&(n.payloads="")});var c=i.outerOrder||o,h=i.innerOrder||d,v=[];return c.forEach(function(i){f[i].forEach(function(c){c.name in n&&null!=n[c.name]?v.push(a(i,c,n)):c.push in n&&null!=n[c.push]&&n[c.push].forEach(function(n){v.push(a(i,c,n))})})}),n.media.forEach(function(n){v.push(a("m",f.m[0],n)),h.forEach(function(i){f[i].forEach(function(c){c.name in n&&null!=n[c.name]?v.push(a(i,c,n)):c.push in n&&null!=n[c.push]&&n[c.push].forEach(function(n){v.push(a(i,c,n))})})})}),v.join("\r\n")+"\r\n"}},function(n,i){var c,f,h=n.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function d(n){if(c===setTimeout)return setTimeout(n,0);if((c===a||!c)&&setTimeout)return c=setTimeout,setTimeout(n,0);try{return c(n,0)}catch(i){try{return c.call(null,n,0)}catch(i){return c.call(this,n,0)}}}!function(){try{c="function"==typeof setTimeout?setTimeout:a}catch(n){c=a}try{f="function"==typeof clearTimeout?clearTimeout:o}catch(n){f=o}}();var v,y=[],g=!1,b=-1;function m(){g&&v&&(g=!1,v.length?y=v.concat(y):b=-1,y.length&&w())}function w(){if(!g){var n=d(m);g=!0;for(var i=y.length;i;){for(v=y,y=[];++b<i;)v&&v[b].run();b=-1,i=y.length}v=null,g=!1,function(n){if(f===clearTimeout)return clearTimeout(n);if((f===o||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(n);try{f(n)}catch(i){try{return f.call(null,n)}catch(i){return f.call(this,n)}}}(n)}}function A(n,i){this.fun=n,this.array=i}function C(){}h.nextTick=function(n){var i=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)i[c-1]=arguments[c];y.push(new A(n,i)),1!==y.length||g||d(w)},A.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=C,h.addListener=C,h.once=C,h.off=C,h.removeListener=C,h.removeAllListeners=C,h.emit=C,h.prependListener=C,h.prependOnceListener=C,h.listeners=function(n){return[]},h.binding=function(n){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(n){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(n,i,c){n.exports=function(n){function i(n){let i=0;for(let c=0;c<n.length;c++)i=(i<<5)-i+n.charCodeAt(c),i|=0;return f.colors[Math.abs(i)%f.colors.length]}function f(n){let c;function o(...n){if(!o.enabled)return;const i=o,h=Number(new Date),a=h-(c||h);i.diff=a,i.prev=c,i.curr=h,c=h,n[0]=f.coerce(n[0]),"string"!=typeof n[0]&&n.unshift("%O");let d=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(c,h)=>{if("%%"===c)return c;d++;const a=f.formatters[h];if("function"==typeof a){const f=n[d];c=a.call(i,f),n.splice(d,1),d--}return c}),f.formatArgs.call(i,n),(i.log||f.log).apply(i,n)}return o.namespace=n,o.enabled=f.enabled(n),o.useColors=f.useColors(),o.color=i(n),o.destroy=h,o.extend=a,"function"==typeof f.init&&f.init(o),f.instances.push(o),o}function h(){const n=f.instances.indexOf(this);return-1!==n&&(f.instances.splice(n,1),!0)}function a(n,i){const c=f(this.namespace+(void 0===i?":":i)+n);return c.log=this.log,c}function o(n){return n.toString().substring(2,n.toString().length-2).replace(/\.\*\?$/,"*")}return f.debug=f,f.default=f,f.coerce=function(n){return n instanceof Error?n.stack||n.message:n},f.disable=function(){const n=[...f.names.map(o),...f.skips.map(o).map(n=>"-"+n)].join(",");return f.enable(""),n},f.enable=function(n){let i;f.save(n),f.names=[],f.skips=[];const c=("string"==typeof n?n:"").split(/[\s,]+/),h=c.length;for(i=0;i<h;i++)c[i]&&("-"===(n=c[i].replace(/\*/g,".*?"))[0]?f.skips.push(new RegExp("^"+n.substr(1)+"$")):f.names.push(new RegExp("^"+n+"$")));for(i=0;i<f.instances.length;i++){const n=f.instances[i];n.enabled=f.enabled(n.namespace)}},f.enabled=function(n){if("*"===n[n.length-1])return!0;let i,c;for(i=0,c=f.skips.length;i<c;i++)if(f.skips[i].test(n))return!1;for(i=0,c=f.names.length;i<c;i++)if(f.names[i].test(n))return!0;return!1},f.humanize=c(133),Object.keys(n).forEach(i=>{f[i]=n[i]}),f.instances=[],f.names=[],f.skips=[],f.formatters={},f.selectColor=i,f.enable(f.load()),f}},function(n,i){var c=1e3,f=60*c,h=60*f,a=24*h,o=7*a,d=365.25*a;function v(n,i,c,f){var h=i>=1.5*c;return Math.round(n/c)+" "+f+(h?"s":"")}n.exports=function(n,i){i=i||{};var y=typeof n;if("string"===y&&n.length>0)return function(n){if((n=String(n)).length>100)return;var i=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(n);if(!i)return;var v=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return v*d;case"weeks":case"week":case"w":return v*o;case"days":case"day":case"d":return v*a;case"hours":case"hour":case"hrs":case"hr":case"h":return v*h;case"minutes":case"minute":case"mins":case"min":case"m":return v*f;case"seconds":case"second":case"secs":case"sec":case"s":return v*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return v;default:return}}(n);if("number"===y&&!1===isNaN(n))return i.long?function(n){var i=Math.abs(n);if(i>=a)return v(n,i,a,"day");if(i>=h)return v(n,i,h,"hour");if(i>=f)return v(n,i,f,"minute");if(i>=c)return v(n,i,c,"second");return n+" ms"}(n):function(n){var i=Math.abs(n);if(i>=a)return Math.round(n/a)+"d";if(i>=h)return Math.round(n/h)+"h";if(i>=f)return Math.round(n/f)+"m";if(i>=c)return Math.round(n/c)+"s";return n+"ms"}(n);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(n))}},function(n,i,c){"use strict";function f(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}var h=c(2),a=c(0)("JsSIP:DigestAuthentication"),o=c(0)("JsSIP:ERROR:DigestAuthentication");o.log=console.warn.bind(console),n.exports=function(){function n(i){!function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}(this,n),this._credentials=i,this._cnonce=null,this._nc=0,this._ncHex="00000000",this._algorithm=null,this._realm=null,this._nonce=null,this._opaque=null,this._stale=null,this._qop=null,this._method=null,this._uri=null,this._ha1=null,this._response=null}var i,c,d;return i=n,(c=[{key:"get",value:function(n){switch(n){case"realm":return this._realm;case"ha1":return this._ha1;default:return void o('get() | cannot get "%s" parameter',n)}}},{key:"authenticate",value:function(n,i){var c=n.method,f=n.ruri,d=n.body,v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this._algorithm=i.algorithm,this._realm=i.realm,this._nonce=i.nonce,this._opaque=i.opaque,this._stale=i.stale,this._algorithm){if("MD5"!==this._algorithm)return o('authenticate() | challenge with Digest algorithm different than "MD5", authentication aborted'),!1}else this._algorithm="MD5";if(!this._nonce)return o("authenticate() | challenge without Digest nonce, authentication aborted"),!1;if(!this._realm)return o("authenticate() | challenge without Digest realm, authentication aborted"),!1;if(!this._credentials.password){if(!this._credentials.ha1)return o("authenticate() | no plain SIP password nor ha1 provided, authentication aborted"),!1;if(this._credentials.realm!==this._realm)return o('authenticate() | no plain SIP password, and stored `realm` does not match the given `realm`, cannot authenticate [stored:"%s", given:"%s"]',this._credentials.realm,this._realm),!1}if(i.qop)if(i.qop.indexOf("auth-int")>-1)this._qop="auth-int";else{if(!(i.qop.indexOf("auth")>-1))return o('authenticate() | challenge without Digest qop different than "auth" or "auth-int", authentication aborted'),!1;this._qop="auth"}else this._qop=null;this._method=c,this._uri=f,this._cnonce=v||h.createRandomToken(12),this._nc+=1;var y,g=Number(this._nc).toString(16);return this._ncHex="00000000".substr(0,8-g.length)+g,4294967296===this._nc&&(this._nc=1,this._ncHex="00000001"),this._credentials.password?this._ha1=h.calculateMD5("".concat(this._credentials.username,":").concat(this._realm,":").concat(this._credentials.password)):this._ha1=this._credentials.ha1,"auth"===this._qop?(y=h.calculateMD5("".concat(this._method,":").concat(this._uri)),this._response=h.calculateMD5("".concat(this._ha1,":").concat(this._nonce,":").concat(this._ncHex,":").concat(this._cnonce,":auth:").concat(y))):"auth-int"===this._qop?(y=h.calculateMD5("".concat(this._method,":").concat(this._uri,":").concat(h.calculateMD5(d||""))),this._response=h.calculateMD5("".concat(this._ha1,":").concat(this._nonce,":").concat(this._ncHex,":").concat(this._cnonce,":auth-int:").concat(y))):null===this._qop&&(y=h.calculateMD5("".concat(this._method,":").concat(this._uri)),this._response=h.calculateMD5("".concat(this._ha1,":").concat(this._nonce,":").concat(y))),a("authenticate() | response generated"),!0}},{key:"toString",value:function(){var n=[];if(!this._response)throw new Error("response field does not exist, cannot generate Authorization header");return n.push("algorithm=".concat(this._algorithm)),n.push('username="'.concat(this._credentials.username,'"')),n.push('realm="'.concat(this._realm,'"')),n.push('nonce="'.concat(this._nonce,'"')),n.push('uri="'.concat(this._uri,'"')),n.push('response="'.concat(this._response,'"')),this._opaque&&n.push('opaque="'.concat(this._opaque,'"')),this._qop&&(n.push("qop=".concat(this._qop)),n.push('cnonce="'.concat(this._cnonce,'"')),n.push("nc=".concat(this._ncHex))),"Digest ".concat(n.join(", "))}}])&&f(i.prototype,c),d&&f(i,d),n}()},function(n,i,c){"use strict";function f(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}function h(n,i,c){return i&&f(n.prototype,i),c&&f(n,c),n}var a=c(13),o=c(1),d=c(23),v=c(136),y=c(2),g=c(0)("JsSIP:Dialog"),b={STATUS_EARLY:1,STATUS_CONFIRMED:2};n.exports=function(){function n(i,c,f){var h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:b.STATUS_CONFIRMED;if(function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}(this,n),this._owner=i,this._ua=i._ua,this._uac_pending_reply=!1,this._uas_pending_reply=!1,!c.hasHeader("contact"))return{error:"unable to create a Dialog without Contact header field"};c instanceof a.IncomingResponse&&(h=c.status_code<200?b.STATUS_EARLY:b.STATUS_CONFIRMED);var o=c.parseHeader("contact");"UAS"===f?(this._id={call_id:c.call_id,local_tag:c.to_tag,remote_tag:c.from_tag,toString:function(){return this.call_id+this.local_tag+this.remote_tag}},this._state=h,this._remote_seqnum=c.cseq,this._local_uri=c.parseHeader("to").uri,this._remote_uri=c.parseHeader("from").uri,this._remote_target=o.uri,this._route_set=c.getHeaders("record-route"),this._ack_seqnum=this._remote_seqnum):"UAC"===f&&(this._id={call_id:c.call_id,local_tag:c.from_tag,remote_tag:c.to_tag,toString:function(){return this.call_id+this.local_tag+this.remote_tag}},this._state=h,this._local_seqnum=c.cseq,this._local_uri=c.parseHeader("from").uri,this._remote_uri=c.parseHeader("to").uri,this._remote_target=o.uri,this._route_set=c.getHeaders("record-route").reverse(),this._ack_seqnum=null),this._ua.newDialog(this),g("new ".concat(f," dialog created with status ").concat(this._state===b.STATUS_EARLY?"EARLY":"CONFIRMED"))}return h(n,null,[{key:"C",get:function(){return b}}]),h(n,[{key:"update",value:function(n,i){this._state=b.STATUS_CONFIRMED,g("dialog ".concat(this._id.toString(),"  changed to CONFIRMED state")),"UAC"===i&&(this._route_set=n.getHeaders("record-route").reverse())}},{key:"terminate",value:function(){g("dialog ".concat(this._id.toString()," deleted")),this._ua.destroyDialog(this)}},{key:"sendRequest",value:function(n){var i=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},f=y.cloneArray(c.extraHeaders),h=c.eventHandlers||{},a=c.body||null,o=this._createRequest(n,f,a);return h.onAuthenticated=function(){i._local_seqnum+=1},new v(this,o,h).send(),o}},{key:"receiveRequest",value:function(n){this._checkInDialogRequest(n)&&(n.method===o.ACK&&null!==this._ack_seqnum?this._ack_seqnum=null:n.method===o.INVITE&&(this._ack_seqnum=n.cseq),this._owner.receiveRequest(n))}},{key:"_createRequest",value:function(n,i,c){i=y.cloneArray(i),this._local_seqnum||(this._local_seqnum=Math.floor(1e4*Math.random()));var f=n===o.CANCEL||n===o.ACK?this._local_seqnum:this._local_seqnum+=1;return new a.OutgoingRequest(n,this._remote_target,this._ua,{cseq:f,call_id:this._id.call_id,from_uri:this._local_uri,from_tag:this._id.local_tag,to_uri:this._remote_uri,to_tag:this._id.remote_tag,route_set:this._route_set},i,c)}},{key:"_checkInDialogRequest",value:function(n){var i=this;if(this._remote_seqnum)if(n.cseq<this._remote_seqnum){if(n.method!==o.ACK)return n.reply(500),!1;if(null===this._ack_seqnum||n.cseq!==this._ack_seqnum)return!1}else n.cseq>this._remote_seqnum&&(this._remote_seqnum=n.cseq);else this._remote_seqnum=n.cseq;if(n.method===o.INVITE||n.method===o.UPDATE&&n.body){if(!0===this._uac_pending_reply)n.reply(491);else{if(!0===this._uas_pending_reply){var c=1+(10*Math.random()|0);return n.reply(500,null,["Retry-After:".concat(c)]),!1}this._uas_pending_reply=!0;n.server_transaction.on("stateChanged",function c(){n.server_transaction.state!==d.C.STATUS_ACCEPTED&&n.server_transaction.state!==d.C.STATUS_COMPLETED&&n.server_transaction.state!==d.C.STATUS_TERMINATED||(n.server_transaction.removeListener("stateChanged",c),i._uas_pending_reply=!1)})}n.hasHeader("contact")&&n.server_transaction.on("stateChanged",function(){n.server_transaction.state===d.C.STATUS_ACCEPTED&&(i._remote_target=n.parseHeader("contact").uri)})}else n.method===o.NOTIFY&&n.hasHeader("contact")&&n.server_transaction.on("stateChanged",function(){n.server_transaction.state===d.C.STATUS_COMPLETED&&(i._remote_target=n.parseHeader("contact").uri)});return!0}},{key:"id",get:function(){return this._id}},{key:"local_seqnum",get:function(){return this._local_seqnum},set:function(n){this._local_seqnum=n}},{key:"owner",get:function(){return this._owner}},{key:"uac_pending_reply",get:function(){return this._uac_pending_reply},set:function(n){this._uac_pending_reply=n}},{key:"uas_pending_reply",get:function(){return this._uas_pending_reply}}]),n}()},function(n,i,c){"use strict";function f(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}var h=c(1),a=c(23),o=c(71),d=c(29),v={onRequestTimeout:function(){},onTransportError:function(){},onSuccessResponse:function(){},onErrorResponse:function(){},onAuthenticated:function(){},onDialogError:function(){}};n.exports=function(){function n(i,c,f){for(var h in function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}(this,n),this._dialog=i,this._ua=i._ua,this._request=c,this._eventHandlers=f,this._reattempt=!1,this._reattemptTimer=null,v)Object.prototype.hasOwnProperty.call(v,h)&&(this._eventHandlers[h]||(this._eventHandlers[h]=v[h]))}var i,c,y;return i=n,(c=[{key:"send",value:function(){var n=this,i=new d(this._ua,this._request,{onRequestTimeout:function(){n._eventHandlers.onRequestTimeout()},onTransportError:function(){n._eventHandlers.onTransportError()},onAuthenticated:function(i){n._eventHandlers.onAuthenticated(i)},onReceiveResponse:function(i){n._receiveResponse(i)}});if(i.send(),(this._request.method===h.INVITE||this._request.method===h.UPDATE&&this._request.body)&&i.clientTransaction.state!==a.C.STATUS_TERMINATED){this._dialog.uac_pending_reply=!0;i.clientTransaction.on("stateChanged",function c(){i.clientTransaction.state!==a.C.STATUS_ACCEPTED&&i.clientTransaction.state!==a.C.STATUS_COMPLETED&&i.clientTransaction.state!==a.C.STATUS_TERMINATED||(i.clientTransaction.removeListener("stateChanged",c),n._dialog.uac_pending_reply=!1)})}}},{key:"_receiveResponse",value:function(n){var i=this;408===n.status_code||481===n.status_code?this._eventHandlers.onDialogError(n):n.method===h.INVITE&&491===n.status_code?this._reattempt?n.status_code>=200&&n.status_code<300?this._eventHandlers.onSuccessResponse(n):n.status_code>=300&&this._eventHandlers.onErrorResponse(n):(this._request.cseq.value=this._dialog.local_seqnum+=1,this._reattemptTimer=setTimeout(function(){i._dialog.owner.status!==o.C.STATUS_TERMINATED&&(i._reattempt=!0,i._request_sender.send())},1e3)):n.status_code>=200&&n.status_code<300?this._eventHandlers.onSuccessResponse(n):n.status_code>=300&&this._eventHandlers.onErrorResponse(n)}},{key:"request",get:function(){return this._request}}])&&f(i.prototype,c),y&&f(i,y),n}()},function(n,i,c){"use strict";function f(n){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function h(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}function a(n,i){return!i||"object"!==f(i)&&"function"!=typeof i?function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n):i}function o(n){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function d(n,i){return(d=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n})(n,i)}var v=c(12).EventEmitter,y=c(1),g=c(16),b=c(2),m=c(0)("JsSIP:RTCSession:DTMF");c(0)("JsSIP:ERROR:RTCSession:DTMF").log=console.warn.bind(console);var w={MIN_DURATION:70,MAX_DURATION:6e3,DEFAULT_DURATION:100,MIN_INTER_TONE_GAP:50,DEFAULT_INTER_TONE_GAP:500};n.exports=function(n){function i(n){var c;return function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(c=a(this,o(i).call(this)))._session=n,c._direction=null,c._tone=null,c._duration=null,c._request=null,c}var c,f,A;return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(i&&i.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),i&&d(n,i)}(i,v),c=i,(f=[{key:"send",value:function(n){var i=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===n)throw new TypeError("Not enough arguments");if(this._direction="outgoing",this._session.status!==this._session.C.STATUS_CONFIRMED&&this._session.status!==this._session.C.STATUS_WAITING_FOR_ACK)throw new g.InvalidStateError(this._session.status);var f=b.cloneArray(c.extraHeaders);if(this.eventHandlers=c.eventHandlers||{},"string"==typeof n)n=n.toUpperCase();else{if("number"!=typeof n)throw new TypeError("Invalid tone: ".concat(n));n=n.toString()}if(!n.match(/^[0-9A-DR#*]$/))throw new TypeError("Invalid tone: ".concat(n));this._tone=n,this._duration=c.duration,f.push("Content-Type: application/dtmf-relay");var h="Signal=".concat(this._tone,"\r\n");h+="Duration=".concat(this._duration),this._session.newDTMF({originator:"local",dtmf:this,request:this._request}),this._session.sendRequest(y.INFO,{extraHeaders:f,eventHandlers:{onSuccessResponse:function(n){i.emit("succeeded",{originator:"remote",response:n})},onErrorResponse:function(n){i.eventHandlers.onFailed&&i.eventHandlers.onFailed(),i.emit("failed",{originator:"remote",response:n})},onRequestTimeout:function(){i._session.onRequestTimeout()},onTransportError:function(){i._session.onTransportError()},onDialogError:function(){i._session.onDialogError()}},body:h})}},{key:"init_incoming",value:function(n){var i=/^(Signal\s*?=\s*?)([0-9A-D#*]{1})(\s)?.*/,c=/^(Duration\s?=\s?)([0-9]{1,4})(\s)?.*/;if(this._direction="incoming",this._request=n,n.reply(200),n.body){var f=n.body.split("\n");f.length>=1&&i.test(f[0])&&(this._tone=f[0].replace(i,"$2")),f.length>=2&&c.test(f[1])&&(this._duration=parseInt(f[1].replace(c,"$2"),10))}this._duration||(this._duration=w.DEFAULT_DURATION),this._tone?this._session.newDTMF({originator:"remote",dtmf:this,request:n}):m("invalid INFO DTMF received, discarded")}},{key:"tone",get:function(){return this._tone}},{key:"duration",get:function(){return this._duration}}])&&h(c.prototype,f),A&&h(c,A),i}(),n.exports.C=w},function(n,i,c){"use strict";function f(n){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function h(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}function a(n,i){return!i||"object"!==f(i)&&"function"!=typeof i?function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n):i}function o(n){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function d(n,i){return(d=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n})(n,i)}var v=c(12).EventEmitter;c(0)("JsSIP:ERROR:RTCSession:Info").log=console.warn.bind(console);var y=c(1),g=c(16),b=c(2);n.exports=function(n){function i(n){var c;return function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(c=a(this,o(i).call(this)))._session=n,c._direction=null,c._contentType=null,c._body=null,c}var c,f,m;return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(i&&i.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),i&&d(n,i)}(i,v),c=i,(f=[{key:"send",value:function(n,i){var c=this,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._direction="outgoing",void 0===n)throw new TypeError("Not enough arguments");if(this._session.status!==this._session.C.STATUS_CONFIRMED&&this._session.status!==this._session.C.STATUS_WAITING_FOR_ACK)throw new g.InvalidStateError(this._session.status);this._contentType=n,this._body=i;var h=b.cloneArray(f.extraHeaders);h.push("Content-Type: ".concat(n)),this._session.newInfo({originator:"local",info:this,request:this.request}),this._session.sendRequest(y.INFO,{extraHeaders:h,eventHandlers:{onSuccessResponse:function(n){c.emit("succeeded",{originator:"remote",response:n})},onErrorResponse:function(n){c.emit("failed",{originator:"remote",response:n})},onTransportError:function(){c._session.onTransportError()},onRequestTimeout:function(){c._session.onRequestTimeout()},onDialogError:function(){c._session.onDialogError()}},body:i})}},{key:"init_incoming",value:function(n){this._direction="incoming",this.request=n,n.reply(200),this._contentType=n.getHeader("content-type"),this._body=n.body,this._session.newInfo({originator:"remote",info:this,request:n})}},{key:"contentType",get:function(){return this._contentType}},{key:"body",get:function(){return this._body}}])&&h(c.prototype,f),m&&h(c,m),i}()},function(n,i,c){"use strict";function f(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}var h=c(1),a=c(0)("JsSIP:RTCSession:ReferNotifier"),o={event_type:"refer",body_type:"message/sipfrag;version=2.0",expires:300};n.exports=function(){function n(i,c,f){!function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}(this,n),this._session=i,this._id=c,this._expires=f||o.expires,this._active=!0,this.notify(100)}var i,c,d;return i=n,(c=[{key:"notify",value:function(n,i){var c;(a("notify()"),!1!==this._active)&&(i=i||h.REASON_PHRASE[n]||"",c=n>=200?"terminated;reason=noresource":"active;expires=".concat(this._expires),this._session.sendRequest(h.NOTIFY,{extraHeaders:["Event: ".concat(o.event_type,";id=").concat(this._id),"Subscription-State: ".concat(c),"Content-Type: ".concat(o.body_type)],body:"SIP/2.0 ".concat(n," ").concat(i),eventHandlers:{onErrorResponse:function(){this._active=!1}}}))}}])&&f(i.prototype,c),d&&f(i,d),n}()},function(n,i,c){"use strict";function f(n){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function h(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}function a(n,i){return!i||"object"!==f(i)&&"function"!=typeof i?function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n):i}function o(n){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function d(n,i){return(d=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n})(n,i)}var v=c(12).EventEmitter,y=c(1),g=c(6),b=c(2),m=c(0)("JsSIP:RTCSession:ReferSubscriber");n.exports=function(n){function i(n){var c;return function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(c=a(this,o(i).call(this)))._id=null,c._session=n,c}var c,f,w;return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(i&&i.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),i&&d(n,i)}(i,v),c=i,(f=[{key:"sendRefer",value:function(n){var i=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};m("sendRefer()");var f=b.cloneArray(c.extraHeaders),h=c.eventHandlers||{};for(var a in h)Object.prototype.hasOwnProperty.call(h,a)&&this.on(a,h[a]);var o=null;c.replaces&&(o=c.replaces._request.call_id,o+=";to-tag=".concat(c.replaces._to_tag),o+=";from-tag=".concat(c.replaces._from_tag),o=encodeURIComponent(o));var d="Refer-To: <".concat(n).concat(o?"?Replaces=".concat(o):"",">");f.push(d),f.push("Contact: ".concat(this._session.contact));var v=this._session.sendRequest(y.REFER,{extraHeaders:f,eventHandlers:{onSuccessResponse:function(n){i._requestSucceeded(n)},onErrorResponse:function(n){i._requestFailed(n,y.causes.REJECTED)},onTransportError:function(){i._requestFailed(null,y.causes.CONNECTION_ERROR)},onRequestTimeout:function(){i._requestFailed(null,y.causes.REQUEST_TIMEOUT)},onDialogError:function(){i._requestFailed(null,y.causes.DIALOG_ERROR)}}});this._id=v.cseq}},{key:"receiveNotify",value:function(n){if(m("receiveNotify()"),n.body){var i=g.parse(n.body.trim(),"Status_Line");if(-1!==i)switch(!0){case/^100$/.test(i.status_code):this.emit("trying",{request:n,status_line:i});break;case/^1[0-9]{2}$/.test(i.status_code):this.emit("progress",{request:n,status_line:i});break;case/^2[0-9]{2}$/.test(i.status_code):this.emit("accepted",{request:n,status_line:i});break;default:this.emit("failed",{request:n,status_line:i})}else m('receiveNotify() | error parsing NOTIFY body: "'.concat(n.body,'"'))}}},{key:"_requestSucceeded",value:function(n){m("REFER succeeded"),m('emit "requestSucceeded"'),this.emit("requestSucceeded",{response:n})}},{key:"_requestFailed",value:function(n,i){m("REFER failed"),m('emit "requestFailed"'),this.emit("requestFailed",{response:n||null,cause:i})}},{key:"id",get:function(){return this._id}}])&&h(c.prototype,f),w&&h(c,w),i}()},function(n,i,c){"use strict";function f(n){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function h(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}function a(n,i){return!i||"object"!==f(i)&&"function"!=typeof i?function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n):i}function o(n){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function d(n,i){return(d=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n})(n,i)}var v=c(12).EventEmitter,y=c(1),g=c(13),b=c(2),m=c(29),w=c(16),A=c(0)("JsSIP:Message");n.exports=function(n){function i(n){var c;return function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(c=a(this,o(i).call(this)))._ua=n,c._request=null,c._closed=!1,c._direction=null,c._local_identity=null,c._remote_identity=null,c._is_replied=!1,c._data={},c}var c,f,C;return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(i&&i.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),i&&d(n,i)}(i,v),c=i,(f=[{key:"send",value:function(n,i){var c=this,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},h=n;if(void 0===n||void 0===i)throw new TypeError("Not enough arguments");if(!(n=this._ua.normalizeTarget(n)))throw new TypeError("Invalid target: ".concat(h));var a=b.cloneArray(f.extraHeaders),o=f.eventHandlers||{},d=f.contentType||"text/plain";for(var v in o)Object.prototype.hasOwnProperty.call(o,v)&&this.on(v,o[v]);a.push("Content-Type: ".concat(d)),this._request=new g.OutgoingRequest(y.MESSAGE,n,this._ua,null,a),i&&(this._request.body=i);var w=new m(this._ua,this._request,{onRequestTimeout:function(){c._onRequestTimeout()},onTransportError:function(){c._onTransportError()},onReceiveResponse:function(n){c._receiveResponse(n)}});this._newMessage("local",this._request),w.send()}},{key:"init_incoming",value:function(n){this._request=n,this._newMessage("remote",n),this._is_replied||(this._is_replied=!0,n.reply(200)),this._close()}},{key:"accept",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=b.cloneArray(n.extraHeaders),c=n.body;if("incoming"!==this._direction)throw new w.NotSupportedError('"accept" not supported for outgoing Message');if(this._is_replied)throw new Error("incoming Message already replied");this._is_replied=!0,this._request.reply(200,null,i,c)}},{key:"reject",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.status_code||480,c=n.reason_phrase,f=b.cloneArray(n.extraHeaders),h=n.body;if("incoming"!==this._direction)throw new w.NotSupportedError('"reject" not supported for outgoing Message');if(this._is_replied)throw new Error("incoming Message already replied");if(i<300||i>=700)throw new TypeError("Invalid status_code: ".concat(i));this._is_replied=!0,this._request.reply(i,c,f,h)}},{key:"_receiveResponse",value:function(n){if(!this._closed)switch(!0){case/^1[0-9]{2}$/.test(n.status_code):break;case/^2[0-9]{2}$/.test(n.status_code):this._succeeded("remote",n);break;default:var i=b.sipErrorCause(n.status_code);this._failed("remote",n,i)}}},{key:"_onRequestTimeout",value:function(){this._closed||this._failed("system",null,y.causes.REQUEST_TIMEOUT)}},{key:"_onTransportError",value:function(){this._closed||this._failed("system",null,y.causes.CONNECTION_ERROR)}},{key:"_close",value:function(){this._closed=!0,this._ua.destroyMessage(this)}},{key:"_newMessage",value:function(n,i){"remote"===n?(this._direction="incoming",this._local_identity=i.to,this._remote_identity=i.from):"local"===n&&(this._direction="outgoing",this._local_identity=i.from,this._remote_identity=i.to),this._ua.newMessage(this,{originator:n,message:this,request:i})}},{key:"_failed",value:function(n,i,c){A("MESSAGE failed"),this._close(),A('emit "failed"'),this.emit("failed",{originator:n,response:i||null,cause:c})}},{key:"_succeeded",value:function(n,i){A("MESSAGE succeeded"),this._close(),A('emit "succeeded"'),this.emit("succeeded",{originator:n,response:i})}},{key:"direction",get:function(){return this._direction}},{key:"local_identity",get:function(){return this._local_identity}},{key:"remote_identity",get:function(){return this._remote_identity}}])&&h(c.prototype,f),C&&h(c,C),i}()},function(n,i,c){"use strict";function f(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}var h=c(72),a=c(0)("JsSIP:Transport"),o=c(0)("JsSIP:ERROR:Transport");o.log=console.warn.bind(console);var d={STATUS_CONNECTED:0,STATUS_CONNECTING:1,STATUS_DISCONNECTED:2,SOCKET_STATUS_READY:0,SOCKET_STATUS_ERROR:1,recovery_options:{min_interval:2,max_interval:30}};n.exports=function(){function n(i){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.recovery_options;if(function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}(this,n),a("new()"),this.status=d.STATUS_DISCONNECTED,this.socket=null,this.sockets=[],this.recovery_options=c,this.recover_attempts=0,this.recovery_timer=null,this.close_requested=!1,void 0===i)throw new TypeError("Invalid argument. undefined 'sockets' argument");i instanceof Array||(i=[i]),i.forEach(function(n){if(!h.isSocket(n.socket))throw new TypeError("Invalid argument. invalid 'JsSIP.Socket' instance");if(n.weight&&!Number(n.weight))throw new TypeError("Invalid argument. 'weight' attribute is not a number");this.sockets.push({socket:n.socket,weight:n.weight||0,status:d.SOCKET_STATUS_READY})},this),this._getSocket()}var i,c,v;return i=n,(c=[{key:"connect",value:function(){a("connect()"),this.isConnected()?a("Transport is already connected"):this.isConnecting()?a("Transport is connecting"):(this.close_requested=!1,this.status=d.STATUS_CONNECTING,this.onconnecting({socket:this.socket,attempts:this.recover_attempts}),this.close_requested||(this.socket.onconnect=this._onConnect.bind(this),this.socket.ondisconnect=this._onDisconnect.bind(this),this.socket.ondata=this._onData.bind(this),this.socket.connect()))}},{key:"disconnect",value:function(){a("close()"),this.close_requested=!0,this.recover_attempts=0,this.status=d.STATUS_DISCONNECTED,null!==this.recovery_timer&&(clearTimeout(this.recovery_timer),this.recovery_timer=null),this.socket.onconnect=function(){},this.socket.ondisconnect=function(){},this.socket.ondata=function(){},this.socket.disconnect(),this.ondisconnect({socket:this.socket,error:!1})}},{key:"send",value:function(n){if(a("send()"),!this.isConnected())return o("unable to send message, transport is not connected"),!1;var i=n.toString();return a("sending message:\n\n".concat(i,"\n")),this.socket.send(i)}},{key:"isConnected",value:function(){return this.status===d.STATUS_CONNECTED}},{key:"isConnecting",value:function(){return this.status===d.STATUS_CONNECTING}},{key:"_reconnect",value:function(){var n=this;this.recover_attempts+=1;var i=Math.floor(Math.random()*Math.pow(2,this.recover_attempts)+1);i<this.recovery_options.min_interval?i=this.recovery_options.min_interval:i>this.recovery_options.max_interval&&(i=this.recovery_options.max_interval),a("reconnection attempt: ".concat(this.recover_attempts,". next connection attempt in ").concat(i," seconds")),this.recovery_timer=setTimeout(function(){n.close_requested||n.isConnected()||n.isConnecting()||(n._getSocket(),n.connect())},1e3*i)}},{key:"_getSocket",value:function(){var n=[];if(this.sockets.forEach(function(i){i.status!==d.SOCKET_STATUS_ERROR&&(0===n.length?n.push(i):i.weight>n[0].weight?n=[i]:i.weight===n[0].weight&&n.push(i))}),0===n.length)return this.sockets.forEach(function(n){n.status=d.SOCKET_STATUS_READY}),void this._getSocket();var i=Math.floor(Math.random()*n.length);this.socket=n[i].socket}},{key:"_onConnect",value:function(){this.recover_attempts=0,this.status=d.STATUS_CONNECTED,null!==this.recovery_timer&&(clearTimeout(this.recovery_timer),this.recovery_timer=null),this.onconnect({socket:this})}},{key:"_onDisconnect",value:function(n,i,c){this.status=d.STATUS_DISCONNECTED,this.ondisconnect({socket:this.socket,error:n,code:i,reason:c}),this.close_requested||(this.sockets.forEach(function(n){this.socket===n.socket&&(n.status=d.SOCKET_STATUS_ERROR)},this),this._reconnect(n))}},{key:"_onData",value:function(n){if("\r\n"!==n){if("string"!=typeof n){try{n=String.fromCharCode.apply(null,new Uint8Array(n))}catch(n){return void a("received binary message failed to be converted into string, message discarded")}a("received binary message:\n\n".concat(n,"\n"))}else a("received text message:\n\n".concat(n,"\n"));this.ondata({transport:this,message:n})}else a("received message with CRLF Keep Alive response")}},{key:"via_transport",get:function(){return this.socket.via_transport}},{key:"url",get:function(){return this.socket.url}},{key:"sip_uri",get:function(){return this.socket.sip_uri}}])&&f(i.prototype,c),v&&f(i,v),n}()},function(n,i,c){"use strict";var f=c(6),h=c(13),a=c(0)("JsSIP:ERROR:Parser");function o(n,i){var c=i,f=0,h=0;if(n.substring(c,c+2).match(/(^\r\n)/))return-2;for(;0===f;){if(-1===(h=n.indexOf("\r\n",c)))return h;!n.substring(h+2,h+4).match(/(^\r\n)/)&&n.charAt(h+2).match(/(^\s+)/)?c=h+2:f=h}return f}function d(n,i,c,a){var o,d=i.indexOf(":",c),v=i.substring(c,d).trim(),y=i.substring(d+1,a).trim();switch(v.toLowerCase()){case"via":case"v":n.addHeader("via",y),1===n.getHeaders("via").length?(o=n.parseHeader("Via"))&&(n.via=o,n.via_branch=o.branch):o=0;break;case"from":case"f":n.setHeader("from",y),(o=n.parseHeader("from"))&&(n.from=o,n.from_tag=o.getParam("tag"));break;case"to":case"t":n.setHeader("to",y),(o=n.parseHeader("to"))&&(n.to=o,n.to_tag=o.getParam("tag"));break;case"record-route":if(-1===(o=f.parse(y,"Record_Route")))o=void 0;else{var g=!0,b=!1,m=void 0;try{for(var w,A=o[Symbol.iterator]();!(g=(w=A.next()).done);g=!0){var C=w.value;n.addHeader("record-route",y.substring(C.possition,C.offset)),n.headers["Record-Route"][n.getHeaders("record-route").length-1].parsed=C.parsed}}catch(n){b=!0,m=n}finally{try{g||null==A.return||A.return()}finally{if(b)throw m}}}break;case"call-id":case"i":n.setHeader("call-id",y),(o=n.parseHeader("call-id"))&&(n.call_id=y);break;case"contact":case"m":if(-1===(o=f.parse(y,"Contact")))o=void 0;else{var T=!0,E=!1,k=void 0;try{for(var N,R=o[Symbol.iterator]();!(T=(N=R.next()).done);T=!0){var x=N.value;n.addHeader("contact",y.substring(x.possition,x.offset)),n.headers.Contact[n.getHeaders("contact").length-1].parsed=x.parsed}}catch(n){E=!0,k=n}finally{try{T||null==R.return||R.return()}finally{if(E)throw k}}}break;case"content-length":case"l":n.setHeader("content-length",y),o=n.parseHeader("content-length");break;case"content-type":case"c":n.setHeader("content-type",y),o=n.parseHeader("content-type");break;case"cseq":n.setHeader("cseq",y),(o=n.parseHeader("cseq"))&&(n.cseq=o.value),n instanceof h.IncomingResponse&&(n.method=o.method);break;case"max-forwards":n.setHeader("max-forwards",y),o=n.parseHeader("max-forwards");break;case"www-authenticate":n.setHeader("www-authenticate",y),o=n.parseHeader("www-authenticate");break;case"proxy-authenticate":n.setHeader("proxy-authenticate",y),o=n.parseHeader("proxy-authenticate");break;case"session-expires":case"x":n.setHeader("session-expires",y),(o=n.parseHeader("session-expires"))&&(n.session_expires=o.expires,n.session_expires_refresher=o.refresher);break;case"refer-to":case"r":n.setHeader("refer-to",y),(o=n.parseHeader("refer-to"))&&(n.refer_to=o);break;case"replaces":n.setHeader("replaces",y),(o=n.parseHeader("replaces"))&&(n.replaces=o);break;case"event":case"o":n.setHeader("event",y),(o=n.parseHeader("event"))&&(n.event=o);break;default:n.addHeader(v,y),o=0}return void 0!==o||{error:'error parsing header "'.concat(v,'"')}}a.log=console.warn.bind(console),i.parseMessage=function(n,i){var c,v,y=n.indexOf("\r\n");if(-1!==y){var g=n.substring(0,y),b=f.parse(g,"Request_Response");if(-1!==b){b.status_code?((c=new h.IncomingResponse).status_code=b.status_code,c.reason_phrase=b.reason_phrase):((c=new h.IncomingRequest(i)).method=b.method,c.ruri=b.uri),c.data=n;for(var m=y+2;;){if(-2===(y=o(n,m))){v=m+2;break}if(-1===y)return void a("parseMessage() | malformed message");if(!0!==(b=d(c,n,m,y)))return void a("parseMessage() |",b.error);m=y+2}if(c.hasHeader("content-length")){var w=c.getHeader("content-length");c.body=n.substr(v,w)}else c.body=n.substring(v);return c}a('parseMessage() | error parsing first line of SIP message: "'.concat(g,'"'))}else a("parseMessage() | no CRLF found, not a SIP message")}},function(n,i,c){"use strict";var f,h,a,o=c(1),d=c(13),v=c(2),y=c(0)("JsSIP:sanityCheck"),g=[function(){for(var n=["from","to","call_id","cseq","via"],i=0;i<n.length;i++){var c=n[i];if(!f.hasHeader(c))return y("missing mandatory header field : ".concat(c,", dropping the response")),!1}}],b=[function(){if("sip"!==f.s("to").uri.scheme)return w(416),!1},function(){if(!f.to_tag&&f.call_id.substr(0,5)===h.configuration.jssip_id)return w(482),!1},function(){var n=v.str_utf8_length(f.body),i=f.getHeader("content-length");if(n<i)return w(400),!1},function(){var n,i=f.from_tag,c=f.call_id,a=f.cseq;if(f.to_tag)return;if(f.method===o.INVITE){if(h._transactions.ist[f.via_branch])return!1;for(var d in h._transactions.ist)if(Object.prototype.hasOwnProperty.call(h._transactions.ist,d)&&(n=h._transactions.ist[d]).request.from_tag===i&&n.request.call_id===c&&n.request.cseq===a)return w(482),!1}else{if(h._transactions.nist[f.via_branch])return!1;for(var v in h._transactions.nist)if(Object.prototype.hasOwnProperty.call(h._transactions.nist,v)&&(n=h._transactions.nist[v]).request.from_tag===i&&n.request.call_id===c&&n.request.cseq===a)return w(482),!1}}],m=[function(){if(f.getHeaders("via").length>1)return y("more than one Via header field present in the response, dropping the response"),!1},function(){var n=v.str_utf8_length(f.body),i=f.getHeader("content-length");if(n<i)return y("message body length is lower than the value in Content-Length header field, dropping the response"),!1}];function w(n){var i,c=f.getHeaders("via"),h="SIP/2.0 ".concat(n," ").concat(o.REASON_PHRASE[n],"\r\n"),d=!0,y=!1,g=void 0;try{for(var b,m=c[Symbol.iterator]();!(d=(b=m.next()).done);d=!0){var w=b.value;h+="Via: ".concat(w,"\r\n")}}catch(n){y=!0,g=n}finally{try{d||null==m.return||m.return()}finally{if(y)throw g}}i=f.getHeader("To"),f.to_tag||(i+=";tag=".concat(v.newTag())),h+="To: ".concat(i,"\r\n"),h+="From: ".concat(f.getHeader("From"),"\r\n"),h+="Call-ID: ".concat(f.call_id,"\r\n"),h+="CSeq: ".concat(f.cseq," ").concat(f.method,"\r\n"),h+="\r\n",a.send(h)}n.exports=function(n,i,c){f=n,h=i,a=c;for(var o=0;o<g.length;o++){if(!1===(0,g[o])())return!1}if(f instanceof d.IncomingRequest)for(var v=0;v<b.length;v++){if(!1===(0,b[v])())return!1}else if(f instanceof d.IncomingResponse)for(var y=0;y<m.length;y++){if(!1===(0,m[y])())return!1}return!0}},function(n,i,c){"use strict";var f=c(2),h=c(1),a=c(6),o=c(18),d=c(72),v=c(16);i.settings={authorization_user:null,password:null,realm:null,ha1:null,display_name:null,uri:null,contact_uri:null,instance_id:null,use_preloaded_route:!1,session_timers:!0,session_timers_refresh_method:h.UPDATE,no_answer_timeout:60,register:!0,register_expires:600,registrar_server:null,sockets:null,connection_recovery_max_interval:null,connection_recovery_min_interval:null,via_host:"".concat(f.createRandomToken(12),".invalid")};var y={mandatory:{sockets:function(n){var i=[];if(d.isSocket(n))i.push({socket:n});else{if(!Array.isArray(n)||!n.length)return;var c=!0,f=!1,h=void 0;try{for(var a,o=n[Symbol.iterator]();!(c=(a=o.next()).done);c=!0){var v=a.value;Object.prototype.hasOwnProperty.call(v,"socket")&&d.isSocket(v.socket)?i.push(v):d.isSocket(v)&&i.push({socket:v})}}catch(n){f=!0,h=n}finally{try{c||null==o.return||o.return()}finally{if(f)throw h}}}return i},uri:function(n){/^sip:/i.test(n)||(n="".concat(h.SIP,":").concat(n));var i=o.parse(n);return i&&i.user?i:void 0}},optional:{authorization_user:function(n){return-1===a.parse('"'.concat(n,'"'),"quoted_string")?void 0:n},user_agent:function(n){if("string"==typeof n)return n},connection_recovery_max_interval:function(n){if(f.isDecimal(n)){var i=Number(n);if(i>0)return i}},connection_recovery_min_interval:function(n){if(f.isDecimal(n)){var i=Number(n);if(i>0)return i}},contact_uri:function(n){if("string"==typeof n){var i=a.parse(n,"SIP_URI");if(-1!==i)return i}},display_name:function(n){return-1===a.parse('"'.concat(n,'"'),"display_name")?void 0:n},instance_id:function(n){return/^uuid:/i.test(n)&&(n=n.substr(5)),-1===a.parse(n,"uuid")?void 0:n},no_answer_timeout:function(n){if(f.isDecimal(n)){var i=Number(n);if(i>0)return i}},session_timers:function(n){if("boolean"==typeof n)return n},session_timers_refresh_method:function(n){if("string"==typeof n&&((n=n.toUpperCase())===h.INVITE||n===h.UPDATE))return n},password:function(n){return String(n)},realm:function(n){return String(n)},ha1:function(n){return String(n)},register:function(n){if("boolean"==typeof n)return n},register_expires:function(n){if(f.isDecimal(n)){var i=Number(n);if(i>0)return i}},registrar_server:function(n){/^sip:/i.test(n)||(n="".concat(h.SIP,":").concat(n));var i=o.parse(n);return i?i.user?void 0:i:void 0},use_preloaded_route:function(n){if("boolean"==typeof n)return n}}};i.load=function(n,i){for(var c in y.mandatory){if(!i.hasOwnProperty(c))throw new v.ConfigurationError(c);var h=i[c],a=y.mandatory[c](h);if(void 0===a)throw new v.ConfigurationError(c,h);n[c]=a}for(var o in y.optional)if(i.hasOwnProperty(o)){var d=i[o];if(f.isEmpty(d))continue;var g=y.optional[o](d);if(void 0===g)throw new v.ConfigurationError(o,d);n[o]=g}}},function(n,i,c){"use strict";function f(n,i){for(var c=0;c<i.length;c++){var f=i[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(n,f.key,f)}}var h=c(6),a=c(0)("JsSIP:WebSocketInterface"),o=c(0)("JsSIP:ERROR:WebSocketInterface");o.log=console.warn.bind(console),n.exports=function(){function n(i){!function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}(this,n),a('new() [url:"%s"]',i),this._url=i,this._sip_uri=null,this._via_transport=null,this._ws=null;var c=h.parse(i,"absoluteURI");if(-1===c)throw o("invalid WebSocket URI: ".concat(i)),new TypeError("Invalid argument: ".concat(i));if("wss"!==c.scheme&&"ws"!==c.scheme)throw o("invalid WebSocket URI scheme: ".concat(c.scheme)),new TypeError("Invalid argument: ".concat(i));this._sip_uri="sip:".concat(c.host).concat(c.port?":".concat(c.port):"",";transport=ws"),this._via_transport=c.scheme.toUpperCase()}var i,c,d;return i=n,(c=[{key:"connect",value:function(){if(a("connect()"),this.isConnected())a("WebSocket ".concat(this._url," is already connected"));else if(this.isConnecting())a("WebSocket ".concat(this._url," is connecting"));else{this._ws&&this.disconnect(),a("connecting to WebSocket ".concat(this._url));try{this._ws=new WebSocket(this._url,"sip"),this._ws.binaryType="arraybuffer",this._ws.onopen=this._onOpen.bind(this),this._ws.onclose=this._onClose.bind(this),this._ws.onmessage=this._onMessage.bind(this),this._ws.onerror=this._onError.bind(this)}catch(n){this._onError(n)}}}},{key:"disconnect",value:function(){a("disconnect()"),this._ws&&(this._ws.onopen=function(){},this._ws.onclose=function(){},this._ws.onmessage=function(){},this._ws.onerror=function(){},this._ws.close(),this._ws=null)}},{key:"send",value:function(n){return a("send()"),this.isConnected()?(this._ws.send(n),!0):(o("unable to send message, WebSocket is not open"),!1)}},{key:"isConnected",value:function(){return this._ws&&this._ws.readyState===this._ws.OPEN}},{key:"isConnecting",value:function(){return this._ws&&this._ws.readyState===this._ws.CONNECTING}},{key:"_onOpen",value:function(){a("WebSocket ".concat(this._url," connected")),this.onconnect()}},{key:"_onClose",value:function(n){var i=n.wasClean,c=n.code,f=n.reason;a("WebSocket ".concat(this._url," closed")),!1===i&&a("WebSocket abrupt disconnection");var h={socket:this,error:!i,code:c,reason:f};this.ondisconnect(h)}},{key:"_onMessage",value:function(n){var i=n.data;a("received WebSocket message"),this.ondata(i)}},{key:"_onError",value:function(n){o("WebSocket ".concat(this._url," error: ").concat(n))}},{key:"via_transport",get:function(){return this._via_transport},set:function(n){this._via_transport=n.toUpperCase()}},{key:"sip_uri",get:function(){return this._sip_uri}},{key:"url",get:function(){return this._url}}])&&f(i.prototype,c),d&&f(i,d),n}()},function(n,i,c){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var f,h=c(44);var a=new((f=h)&&f.__esModule?f:{default:f}).default("xml2json");function o(n){var i=null;if(!window.DOMParser)return null;try{i=(new DOMParser).parseFromString(n,"text/xml")}catch(n){a.error(n)}return i}i.default={xmlToJs:function(n){for(var i=["a","b","c","d","e","f","g","k","o","i","m","n","p","r","s","t","q","v","z","l","u","nm"],c=i.length,f=["cc","o","mn","i"],h={},a=0;a<f.length;a++)if(o(n).getElementsByTagName(f[a]).length){var d;d=f[a];for(var v=o(n).firstChild,y={},g=0;g<c;g++)v.getAttribute(i[g])&&(y[i[g]]=v.getAttribute(i[g]));if(h[d]=y,o(n).firstChild.childNodes.length>0)for(var b=o(n).firstChild,m=[],w=0,A=b.children.length;w<A;w++){for(var C={},T=b.children[w],E=0;E<c;E++)T.getAttribute(i[E])&&(C[i[E]]=T.getAttribute(i[E]));if(m.push(C),h[d][o(n).firstChild.children[0].tagName]=m,b.children[0].children.length>0)for(var k=[],N=0;N<b.children[0].children.length;N++){for(var R=b.children[0].children[N],x={},O=0;O<c;O++)R.getAttribute(i[O])&&(x[i[O]]=R.getAttribute(i[O]));k.push(x),h[d][o(n).firstChild.children[0].tagName][b.children[0].children[0].tagName]=k}}}return h},jsToXml:function(n,i){var c=o("<"+i+"/>").getElementsByTagName(i)[0];for(var f in n)c.setAttribute(f,n[f]);return'<?xml version="1.0" encoding="utf-8"?>'+function(n){var i=document.createElement("div");i.appendChild(n);var c=i.innerHTML;return i=n=null,c}(c)}}},function(n,i,c){"use strict";var f,h,a,o=w(c(45)),d=w(c(46)),v=(f=(0,d.default)(o.default.mark(function n(i,c,f){var h,a,d,v,b,w,C,T,E,k,N=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,R=arguments[4],x=arguments[5];return o.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,null!=i&&null!=c&&null!=f&&null!=N&&(4!=Number(N)&&5!=Number(N)||null!=R)){n.next=3;break}throw{status:50001,info:"获取信息失败,参数错误",step:"checkParam"};case 3:return h=m.default.hash(c),a=Math.random().toString().split(".")[1].substr(0,8),d=Math.random().toString().split(".")[1].substr(0,6),(v={pwd:h,clearPwd:a+c+d,switchNumber:f,callintype:N,oldCallType:N}).seatNumber=i,4==Number(N)&&(v.phoneNumber=R.startsWith("A")&&R.endsWith("Z")?R.slice(1,R.length-1):R),(b=localStorage.getItem("userData"))?localStorage.setItem("userData",JSON.stringify(Object.assign(JSON.parse(b),v))):localStorage.setItem("userData",JSON.stringify(v)),n.next=13,y(i,c,f,x);case 13:if(200==(w=n.sent).status){n.next=16;break}throw w;case 16:return C={un:i,pwd:c,eid:w.data.eid},T={callintype:N,telephone:R},C.jsonStr=JSON.stringify({data:T}),n.next=21,g("updateInfo",C);case 21:if(200==(E=n.sent).status){n.next=24;break}throw E;case 24:return k={status:200,info:"获取成功",serverInfo:w.data},n.abrupt("return",k);case 28:return n.prev=28,n.t0=n.catch(0),A.error("获取登录信息失败 "+n.t0),localStorage.removeItem("userData"),n.abrupt("return",n.t0);case 33:case"end":return n.stop()}},n,this,[[0,28]])})),function(n,i,c){return f.apply(this,arguments)}),y=(h=(0,d.default)(o.default.mark(function n(i,c,f,h){var a,d,v,y,g,b,w,T;return o.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a=new URL("http://"+h.frontIp+":"+h.port+"/Api/Client/getinfo"),d=JSON.parse(localStorage.getItem("userData"))||{},(v={un:i,pwd:d&&null!==d.pwd&&void 0!==d.pwd?d.pwd:m.default.hash(c),cFlag:1}).eid=f,a.search=C(v),A.debug("await fetch "+a),n.next=9,fetch(a);case 9:return y=n.sent,n.next=12,y.json();case 12:if(g=n.sent,0===Number(g.status)){n.next=21;break}if(4!=Number(g.status)&&7!=Number(g.status)&&8!=Number(g.status)){n.next=16;break}return n.abrupt("return",{status:50003,info:g.info,step:"getinfo"});case 16:if(3!=Number(g.status)&&6!=Number(g.status)){n.next=20;break}return n.abrupt("return",{status:50004,info:g.info,step:"getinfo"});case 20:return n.abrupt("return",{status:5e4,info:g.info,step:"getinfo"});case 21:return d.server=g.data.real_domain,d.serverIp=g.data.domain,d.eid=g.data.eid,d.sipPort=g.data.port,d.webPort=g.data.http_port,d.serverInfo=h,b=Number(g.data.eid).toString(16),w=(w="00000000"+b).substr(b.length,w.length),d.eid16=w,localStorage.setItem("userData",JSON.stringify(d)),T={domain:g.data.domain,sipPort:g.data.port,real_domain:g.data.real_domain,http_port:g.data.http_port,https_port:g.data.http_ports,epName:g.data.epName,eid:g.data.eid},A.debug("getinfo:"+JSON.stringify(T)),n.abrupt("return",{status:200,info:"获取运维信息成功",data:T});case 37:return n.prev=37,n.t0=n.catch(0),A.error("getInfo"+n.t0),n.abrupt("return",{status:5e4,info:n.t0,step:"getinfo"});case 41:case"end":return n.stop()}},n,this,[[0,37]])})),function(n,i,c,f){return h.apply(this,arguments)}),g=(a=(0,d.default)(o.default.mark(function n(i,c){var f,h,a,d,v,y,g,b,w,T,E,k,N,R,x;return o.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,f=JSON.parse(localStorage.userData),h=new URL("http://"+f.serverInfo.frontIp+":"+f.serverInfo.webPort+"/Talk/Api/"+i),c.pwd=f&&null!==f.pwd&&void 0!==f.pwd?f.pwd:m.default.hash(c.pwd),h.search=C(c),A.debug(i+" await fetch "+h),A.debug(i+" param "+JSON.stringify(c)),n.next=9,fetch(h);case 9:return a=n.sent,n.next=12,a.json();case 12:d=n.sent,v={},n.t0=i,n.next="getEpProfile"===n.t0?17:"getMemberInfo"===n.t0?25:"updateInfo"===n.t0?35:"getGroups"===n.t0?40:"searchEpMembers"===n.t0?46:"getMemberCallStates"===n.t0?52:"getCallRecordFromTalk"===n.t0?57:"getCallCenterSwitchNumbes"===n.t0?59:61;break;case 17:if(0===Number(d.status)){n.next=19;break}return n.abrupt("return",{status:50005,info:d.info,step:i});case 19:return y=d.data.epProfile,v={dialing_display_set:y.dialing_display_set,incoming_call_remind:y.incoming_call_remind,outcallenterprisenumber:y.outcallenterprisenumber,switch_number_public_set_mode:y.switch_number_public_set_mode,switch_number_default:y.switch_number_default,allow_customer_manager:y.allow_customer_manager,allow_callcenter:y.allow_callcenter,allow_auto_answer:y.allow_auto_answer,auto_answer_duration:y.auto_answer_duration,terminal_need_reg:y.terminal_need_reg,allow_hide_number:y.allow_hide_number,allow_worksheet:y.allow_worksheet,allow_monitor:y.allow_monitor,extension_end:y.extension_end,extension_start:y.extension_start,allow_record_manager:y.allow_record_manager,ai_es_config:y.ai_es_config},g={allow_auto_answer:y.allow_auto_answer,auto_answer_duration:y.auto_answer_duration,terminal_need_reg:y.terminal_need_reg,extension_end:y.extension_end,extension_start:y.extension_start,switchNumber:JSON.parse(JSON.parse(y.ai_es_config).switch_num)[0].replace(/-/,"")},f.epInfo=g,localStorage.setItem("userData",JSON.stringify(f)),n.abrupt("break",62);case 25:if(0===Number(d.status)){n.next=27;break}return n.abrupt("return",{status:50005,info:d.info,step:i});case 27:return b=d.data,w=b.inGroups.map(function(n){return{id:n.id,eid:n.eid,name:n.name}}),f.groupInfo=w,T={id:b.id,eid:b.eid,uid:b.uid,displayname:b.displayname,number:b.number,work_number:b.work_number,duty:b.duty,mobile:b.mobile,outside_callnumber:b.outside_callnumber,address:b.address,permission:b.permission,call_limit:b.call_limit,time_limit:b.time_limit,cur_limit_time:b.cur_limit_time},f.userInfo=T,localStorage.setItem("userData",JSON.stringify(f)),v={userData:T,inGroups:w},n.abrupt("break",62);case 35:if(0===Number(d.status)){n.next=37;break}return n.abrupt("return",{status:50005,info:d.info,step:i});case 37:return A.debug(i+JSON.stringify(d)),v=d,n.abrupt("break",62);case 40:if(0===Number(d.status)){n.next=42;break}return n.abrupt("return",{status:50008,info:d.info,step:i});case 42:return E=d.data,k=E.map(function(n){return{id:n.id,eid:n.eid,name:n.name}}),v=k,n.abrupt("break",62);case 46:if(0===Number(d.status)){n.next=48;break}return n.abrupt("return",{status:50009,info:d.info,step:i});case 48:return N=d.data.data,R=N.map(function(n){return{id:n.eid,eid:n.eid,uid:n.uid,displayname:n.displayname,number:n.number,mobile:n.mobile,telephone:n.telephone,pinyin:n.pinyin,outside_callnumber:n.outside_callnumber,address:n.address,gids:n.gids,gName:n.gName,service_callmode:n.service_callmode,service_control_time:n.service_control_time,service_control:n.service_control}}),v={recordsTotal:d.data.recordsTotal,recordsFiltered:d.data.recordsFiltered,data:R},n.abrupt("break",62);case 52:if(0===Number(d.status)){n.next=54;break}return n.abrupt("return",{status:50010,info:d.info,step:i});case 54:return x=d.data.filter(function(n){return n.uid==c.uid}),v=x,n.abrupt("break",62);case 57:case 59:return v=d,n.abrupt("break",62);case 61:return n.abrupt("return",{status:50007,info:"未知请求"});case 62:return A.debug(i+JSON.stringify(v)),n.abrupt("return",{status:200,info:"获取成功",returnData:v});case 66:return n.prev=66,n.t1=n.catch(0),A.error(i+n.t1),n.abrupt("return",{status:5e4,info:n.t1,step:i});case 70:case"end":return n.stop()}},n,this,[[0,66]])})),function(n,i){return a.apply(this,arguments)}),b=w(c(44)),m=w(c(149));function w(n){return n&&n.__esModule?n:{default:n}}var A=new b.default("getLoginInfo");function C(n){var i=[];for(var c in n)i.push(c+"="+n[c]);return i.join("&")}n.exports={getLoginData:v,webApiHandler:g}},function(n,i,c){n.exports=function(n){"use strict";var i=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function c(n,i){var c=n[0],f=n[1],h=n[2],a=n[3];c+=(f&h|~f&a)+i[0]-680876936|0,a+=((c=(c<<7|c>>>25)+f|0)&f|~c&h)+i[1]-389564586|0,h+=((a=(a<<12|a>>>20)+c|0)&c|~a&f)+i[2]+606105819|0,f+=((h=(h<<17|h>>>15)+a|0)&a|~h&c)+i[3]-1044525330|0,c+=((f=(f<<22|f>>>10)+h|0)&h|~f&a)+i[4]-176418897|0,a+=((c=(c<<7|c>>>25)+f|0)&f|~c&h)+i[5]+1200080426|0,h+=((a=(a<<12|a>>>20)+c|0)&c|~a&f)+i[6]-1473231341|0,f+=((h=(h<<17|h>>>15)+a|0)&a|~h&c)+i[7]-45705983|0,c+=((f=(f<<22|f>>>10)+h|0)&h|~f&a)+i[8]+1770035416|0,a+=((c=(c<<7|c>>>25)+f|0)&f|~c&h)+i[9]-1958414417|0,h+=((a=(a<<12|a>>>20)+c|0)&c|~a&f)+i[10]-42063|0,f+=((h=(h<<17|h>>>15)+a|0)&a|~h&c)+i[11]-1990404162|0,c+=((f=(f<<22|f>>>10)+h|0)&h|~f&a)+i[12]+1804603682|0,a+=((c=(c<<7|c>>>25)+f|0)&f|~c&h)+i[13]-40341101|0,h+=((a=(a<<12|a>>>20)+c|0)&c|~a&f)+i[14]-1502002290|0,f+=((h=(h<<17|h>>>15)+a|0)&a|~h&c)+i[15]+1236535329|0,c+=((f=(f<<22|f>>>10)+h|0)&a|h&~a)+i[1]-165796510|0,a+=((c=(c<<5|c>>>27)+f|0)&h|f&~h)+i[6]-1069501632|0,h+=((a=(a<<9|a>>>23)+c|0)&f|c&~f)+i[11]+643717713|0,f+=((h=(h<<14|h>>>18)+a|0)&c|a&~c)+i[0]-373897302|0,c+=((f=(f<<20|f>>>12)+h|0)&a|h&~a)+i[5]-701558691|0,a+=((c=(c<<5|c>>>27)+f|0)&h|f&~h)+i[10]+38016083|0,h+=((a=(a<<9|a>>>23)+c|0)&f|c&~f)+i[15]-660478335|0,f+=((h=(h<<14|h>>>18)+a|0)&c|a&~c)+i[4]-405537848|0,c+=((f=(f<<20|f>>>12)+h|0)&a|h&~a)+i[9]+568446438|0,a+=((c=(c<<5|c>>>27)+f|0)&h|f&~h)+i[14]-1019803690|0,h+=((a=(a<<9|a>>>23)+c|0)&f|c&~f)+i[3]-187363961|0,f+=((h=(h<<14|h>>>18)+a|0)&c|a&~c)+i[8]+1163531501|0,c+=((f=(f<<20|f>>>12)+h|0)&a|h&~a)+i[13]-1444681467|0,a+=((c=(c<<5|c>>>27)+f|0)&h|f&~h)+i[2]-51403784|0,h+=((a=(a<<9|a>>>23)+c|0)&f|c&~f)+i[7]+1735328473|0,f+=((h=(h<<14|h>>>18)+a|0)&c|a&~c)+i[12]-1926607734|0,c+=((f=(f<<20|f>>>12)+h|0)^h^a)+i[5]-378558|0,a+=((c=(c<<4|c>>>28)+f|0)^f^h)+i[8]-2022574463|0,h+=((a=(a<<11|a>>>21)+c|0)^c^f)+i[11]+1839030562|0,f+=((h=(h<<16|h>>>16)+a|0)^a^c)+i[14]-35309556|0,c+=((f=(f<<23|f>>>9)+h|0)^h^a)+i[1]-1530992060|0,a+=((c=(c<<4|c>>>28)+f|0)^f^h)+i[4]+1272893353|0,h+=((a=(a<<11|a>>>21)+c|0)^c^f)+i[7]-155497632|0,f+=((h=(h<<16|h>>>16)+a|0)^a^c)+i[10]-1094730640|0,c+=((f=(f<<23|f>>>9)+h|0)^h^a)+i[13]+681279174|0,a+=((c=(c<<4|c>>>28)+f|0)^f^h)+i[0]-358537222|0,h+=((a=(a<<11|a>>>21)+c|0)^c^f)+i[3]-722521979|0,f+=((h=(h<<16|h>>>16)+a|0)^a^c)+i[6]+76029189|0,c+=((f=(f<<23|f>>>9)+h|0)^h^a)+i[9]-640364487|0,a+=((c=(c<<4|c>>>28)+f|0)^f^h)+i[12]-421815835|0,h+=((a=(a<<11|a>>>21)+c|0)^c^f)+i[15]+530742520|0,f+=((h=(h<<16|h>>>16)+a|0)^a^c)+i[2]-995338651|0,c+=(h^((f=(f<<23|f>>>9)+h|0)|~a))+i[0]-198630844|0,a+=(f^((c=(c<<6|c>>>26)+f|0)|~h))+i[7]+1126891415|0,h+=(c^((a=(a<<10|a>>>22)+c|0)|~f))+i[14]-1416354905|0,f+=(a^((h=(h<<15|h>>>17)+a|0)|~c))+i[5]-57434055|0,c+=(h^((f=(f<<21|f>>>11)+h|0)|~a))+i[12]+1700485571|0,a+=(f^((c=(c<<6|c>>>26)+f|0)|~h))+i[3]-1894986606|0,h+=(c^((a=(a<<10|a>>>22)+c|0)|~f))+i[10]-1051523|0,f+=(a^((h=(h<<15|h>>>17)+a|0)|~c))+i[1]-2054922799|0,c+=(h^((f=(f<<21|f>>>11)+h|0)|~a))+i[8]+1873313359|0,a+=(f^((c=(c<<6|c>>>26)+f|0)|~h))+i[15]-30611744|0,h+=(c^((a=(a<<10|a>>>22)+c|0)|~f))+i[6]-1560198380|0,f+=(a^((h=(h<<15|h>>>17)+a|0)|~c))+i[13]+1309151649|0,c+=(h^((f=(f<<21|f>>>11)+h|0)|~a))+i[4]-145523070|0,a+=(f^((c=(c<<6|c>>>26)+f|0)|~h))+i[11]-1120210379|0,h+=(c^((a=(a<<10|a>>>22)+c|0)|~f))+i[2]+718787259|0,f=((f+=(a^((h=(h<<15|h>>>17)+a|0)|~c))+i[9]-343485551|0)<<21|f>>>11)+h|0,n[0]=c+n[0]|0,n[1]=f+n[1]|0,n[2]=h+n[2]|0,n[3]=a+n[3]|0}function f(n){var i,c=[];for(i=0;i<64;i+=4)c[i>>2]=n.charCodeAt(i)+(n.charCodeAt(i+1)<<8)+(n.charCodeAt(i+2)<<16)+(n.charCodeAt(i+3)<<24);return c}function h(n){var i,c=[];for(i=0;i<64;i+=4)c[i>>2]=n[i]+(n[i+1]<<8)+(n[i+2]<<16)+(n[i+3]<<24);return c}function a(n){var i,h,a,o,d,v,y=n.length,g=[1732584193,-271733879,-1732584194,271733878];for(i=64;i<=y;i+=64)c(g,f(n.substring(i-64,i)));for(n=n.substring(i-64),h=n.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=0;i<h;i+=1)a[i>>2]|=n.charCodeAt(i)<<(i%4<<3);if(a[i>>2]|=128<<(i%4<<3),i>55)for(c(g,a),i=0;i<16;i+=1)a[i]=0;return o=(o=8*y).toString(16).match(/(.*?)(.{0,8})$/),d=parseInt(o[2],16),v=parseInt(o[1],16)||0,a[14]=d,a[15]=v,c(g,a),g}function o(n){var c,f="";for(c=0;c<4;c+=1)f+=i[n>>8*c+4&15]+i[n>>8*c&15];return f}function d(n){var i;for(i=0;i<n.length;i+=1)n[i]=o(n[i]);return n.join("")}function v(n){return/[\u0080-\uFFFF]/.test(n)&&(n=unescape(encodeURIComponent(n))),n}function y(n){var i,c=[],f=n.length;for(i=0;i<f-1;i+=2)c.push(parseInt(n.substr(i,2),16));return String.fromCharCode.apply(String,c)}function g(){this.reset()}return d(a("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function i(n,i){return(n=0|n||0)<0?Math.max(n+i,0):Math.min(n,i)}ArrayBuffer.prototype.slice=function(c,f){var h,a,o,d,v=this.byteLength,y=i(c,v),g=v;return f!==n&&(g=i(f,v)),y>g?new ArrayBuffer(0):(h=g-y,a=new ArrayBuffer(h),o=new Uint8Array(a),d=new Uint8Array(this,y,h),o.set(d),a)}}(),g.prototype.append=function(n){return this.appendBinary(v(n)),this},g.prototype.appendBinary=function(n){this._buff+=n,this._length+=n.length;var i,h=this._buff.length;for(i=64;i<=h;i+=64)c(this._hash,f(this._buff.substring(i-64,i)));return this._buff=this._buff.substring(i-64),this},g.prototype.end=function(n){var i,c,f=this._buff,h=f.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<h;i+=1)a[i>>2]|=f.charCodeAt(i)<<(i%4<<3);return this._finish(a,h),c=d(this._hash),n&&(c=y(c)),this.reset(),c},g.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},g.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},g.prototype.setState=function(n){return this._buff=n.buff,this._length=n.length,this._hash=n.hash,this},g.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},g.prototype._finish=function(n,i){var f,h,a,o=i;if(n[o>>2]|=128<<(o%4<<3),o>55)for(c(this._hash,n),o=0;o<16;o+=1)n[o]=0;f=(f=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),h=parseInt(f[2],16),a=parseInt(f[1],16)||0,n[14]=h,n[15]=a,c(this._hash,n)},g.hash=function(n,i){return g.hashBinary(v(n),i)},g.hashBinary=function(n,i){var c=d(a(n));return i?y(c):c},g.ArrayBuffer=function(){this.reset()},g.ArrayBuffer.prototype.append=function(n){var i,f,a,o,d,v=(f=this._buff.buffer,a=n,o=!0,(d=new Uint8Array(f.byteLength+a.byteLength)).set(new Uint8Array(f)),d.set(new Uint8Array(a),f.byteLength),o?d:d.buffer),y=v.length;for(this._length+=n.byteLength,i=64;i<=y;i+=64)c(this._hash,h(v.subarray(i-64,i)));return this._buff=i-64<y?new Uint8Array(v.buffer.slice(i-64)):new Uint8Array(0),this},g.ArrayBuffer.prototype.end=function(n){var i,c,f=this._buff,h=f.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<h;i+=1)a[i>>2]|=f[i]<<(i%4<<3);return this._finish(a,h),c=d(this._hash),n&&(c=y(c)),this.reset(),c},g.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},g.ArrayBuffer.prototype.getState=function(){var n,i=g.prototype.getState.call(this);return i.buff=(n=i.buff,String.fromCharCode.apply(null,new Uint8Array(n))),i},g.ArrayBuffer.prototype.setState=function(n){return n.buff=function(n,i){var c,f=n.length,h=new ArrayBuffer(f),a=new Uint8Array(h);for(c=0;c<f;c+=1)a[c]=n.charCodeAt(c);return i?a:h}(n.buff,!0),g.prototype.setState.call(this,n)},g.ArrayBuffer.prototype.destroy=g.prototype.destroy,g.ArrayBuffer.prototype._finish=g.prototype._finish,g.ArrayBuffer.hash=function(n,i){var f=d(function(n){var i,f,a,o,d,v,y=n.length,g=[1732584193,-271733879,-1732584194,271733878];for(i=64;i<=y;i+=64)c(g,h(n.subarray(i-64,i)));for(n=i-64<y?n.subarray(i-64):new Uint8Array(0),f=n.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=0;i<f;i+=1)a[i>>2]|=n[i]<<(i%4<<3);if(a[i>>2]|=128<<(i%4<<3),i>55)for(c(g,a),i=0;i<16;i+=1)a[i]=0;return o=(o=8*y).toString(16).match(/(.*?)(.{0,8})$/),d=parseInt(o[2],16),v=parseInt(o[1],16)||0,a[14]=d,a[15]=v,c(g,a),g}(new Uint8Array(n)));return i?y(f):f},g}()}]);
//# sourceMappingURL=main.js.map